<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Unified documentation for toolfoundation, tooldiscovery, toolexec, toolcompose, toolops, toolprotocol, and metatools-mcp."><link href=https://jonwraymond.github.io/ai-tools-stack/latest/library-docs-from-repos/metatools-mcp/proposals/ROADMAP/ rel=canonical><link rel=icon href=../../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.5.28"><title>Metatools Architecture Roadmap - AI Tools Stack</title><link rel=stylesheet href=../../../../assets/stylesheets/main.6543a935.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Space+Grotesk:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Space Grotesk";--md-code-font:"JetBrains Mono"}</style><link rel=stylesheet href=../../../../stylesheets/extra.css><link rel=stylesheet href=../../../../stylesheets/diagram-panzoom.css><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=amber> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#metatools-architecture-roadmap class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../.. title="AI Tools Stack" class="md-header__button md-logo" aria-label="AI Tools Stack" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> AI Tools Stack </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Metatools Architecture Roadmap </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=amber aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=teal data-md-color-accent=amber aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m3.55 19.09 1.41 1.41 1.8-1.79-1.42-1.42M12 6c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6c0-3.32-2.69-6-6-6m8 7h3v-2h-3m-2.76 7.71 1.8 1.79 1.41-1.41-1.79-1.8M20.45 5l-1.41-1.4-1.8 1.79 1.42 1.42M13 1h-2v3h2M6.76 5.39 4.96 3.6 3.55 5l1.79 1.81 1.42-1.42M1 13h3v-2H1m12 9h-2v3h2"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/jonwraymond/ai-tools-stack title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> jonwraymond/ai-tools-stack </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../../architecture/overview/ class=md-tabs__link> Architecture </a> </li> <li class=md-tabs__item> <a href=../../../../components/toolfoundation/ class=md-tabs__link> Components </a> </li> <li class=md-tabs__item> <a href=../../../../operations/ci-and-versioning/ class=md-tabs__link> Operations </a> </li> <li class=md-tabs__item> <a href=../../../toolfoundation/ class=md-tabs__link> Library Docs (from repos) </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title="AI Tools Stack" class="md-nav__button md-logo" aria-label="AI Tools Stack" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> AI Tools Stack </label> <div class=md-nav__source> <a href=https://github.com/jonwraymond/ai-tools-stack title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> jonwraymond/ai-tools-stack </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Architecture </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../architecture/overview/ class=md-nav__link> <span class=md-ellipsis> Stack Overview </span> </a> </li> <li class=md-nav__item> <a href=../../../../architecture/progressive-disclosure/ class=md-nav__link> <span class=md-ellipsis> Progressive Disclosure </span> </a> </li> <li class=md-nav__item> <a href=../../../../architecture/pluggable-architecture/ class=md-nav__link> <span class=md-ellipsis> Pluggable Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../../../architecture/why-go/ class=md-nav__link> <span class=md-ellipsis> Why Go </span> </a> </li> <li class=md-nav__item> <a href=../../../../architecture/design-notes/ class=md-nav__link> <span class=md-ellipsis> Design Notes Index </span> </a> </li> <li class=md-nav__item> <a href=../../../../architecture/user-journeys/ class=md-nav__link> <span class=md-ellipsis> User Journeys Index </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Components </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Components </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../components/toolfoundation/ class=md-nav__link> <span class=md-ellipsis> toolfoundation </span> </a> </li> <li class=md-nav__item> <a href=../../../../components/tooldiscovery/ class=md-nav__link> <span class=md-ellipsis> tooldiscovery </span> </a> </li> <li class=md-nav__item> <a href=../../../../components/toolexec/ class=md-nav__link> <span class=md-ellipsis> toolexec </span> </a> </li> <li class=md-nav__item> <a href=../../../../components/toolcompose/ class=md-nav__link> <span class=md-ellipsis> toolcompose </span> </a> </li> <li class=md-nav__item> <a href=../../../../components/toolops/ class=md-nav__link> <span class=md-ellipsis> toolops </span> </a> </li> <li class=md-nav__item> <a href=../../../../components/toolprotocol/ class=md-nav__link> <span class=md-ellipsis> toolprotocol </span> </a> </li> <li class=md-nav__item> <a href=../../../../components/metatools-mcp/ class=md-nav__link> <span class=md-ellipsis> metatools-mcp </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Operations </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Operations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../operations/ci-and-versioning/ class=md-nav__link> <span class=md-ellipsis> CI and Versioning </span> </a> </li> <li class=md-nav__item> <a href=../../../../operations/migration-guide/ class=md-nav__link> <span class=md-ellipsis> Migration Guide </span> </a> </li> <li class=md-nav__item> <a href=../../../../operations/stack-changelog/ class=md-nav__link> <span class=md-ellipsis> Stack Changelog </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Library Docs (from repos) </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Library Docs (from repos) </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_1> <label class=md-nav__link for=__nav_5_1 id=__nav_5_1_label tabindex=0> <span class=md-ellipsis> toolfoundation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_1_label aria-expanded=false> <label class=md-nav__title for=__nav_5_1> <span class="md-nav__icon md-icon"></span> toolfoundation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../toolfoundation/ class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class=md-ellipsis> tooldiscovery </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> tooldiscovery </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tooldiscovery/ class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_3> <label class=md-nav__link for=__nav_5_3 id=__nav_5_3_label tabindex=0> <span class=md-ellipsis> toolexec </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_5_3> <span class="md-nav__icon md-icon"></span> toolexec </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../toolexec/ class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_4> <label class=md-nav__link for=__nav_5_4 id=__nav_5_4_label tabindex=0> <span class=md-ellipsis> toolcompose </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_4_label aria-expanded=false> <label class=md-nav__title for=__nav_5_4> <span class="md-nav__icon md-icon"></span> toolcompose </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../toolcompose/ class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_5> <label class=md-nav__link for=__nav_5_5 id=__nav_5_5_label tabindex=0> <span class=md-ellipsis> toolops </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5_5> <span class="md-nav__icon md-icon"></span> toolops </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../toolops/ class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_6> <label class=md-nav__link for=__nav_5_6 id=__nav_5_6_label tabindex=0> <span class=md-ellipsis> toolprotocol </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_6_label aria-expanded=false> <label class=md-nav__title for=__nav_5_6> <span class="md-nav__icon md-icon"></span> toolprotocol </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../toolprotocol/ class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_7> <label class=md-nav__link for=__nav_5_7 id=__nav_5_7_label tabindex=0> <span class=md-ellipsis> metatools-mcp </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_7_label aria-expanded=false> <label class=md-nav__title for=__nav_5_7> <span class="md-nav__icon md-icon"></span> metatools-mcp </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/ class=md-nav__link> <span class=md-ellipsis> Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../usage/ class=md-nav__link> <span class=md-ellipsis> Usage </span> </a> </li> <li class=md-nav__item> <a href=../../examples/ class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=../../design-notes/ class=md-nav__link> <span class=md-ellipsis> Design Notes </span> </a> </li> <li class=md-nav__item> <a href=../../user-journey/ class=md-nav__link> <span class=md-ellipsis> User Journey </span> </a> </li> <li class=md-nav__item> <a href=../../api/ class=md-nav__link> <span class=md-ellipsis> API Reference </span> </a> </li> <li class=md-nav__item> <a href=../../plan-of-record/ class=md-nav__link> <span class=md-ellipsis> Plan of Record </span> </a> </li> <li class=md-nav__item> <a href=../../changelog/ class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_7_10> <label class=md-nav__link for=__nav_5_7_10 id=__nav_5_7_10_label tabindex=0> <span class=md-ellipsis> Proposals </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_5_7_10_label aria-expanded=false> <label class=md-nav__title for=__nav_5_7_10> <span class="md-nav__icon md-icon"></span> Proposals </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../pluggable-architecture/ class=md-nav__link> <span class=md-ellipsis> Pluggable Architecture </span> </a> </li> <li class=md-nav__item> <a href=../implementation-phases/ class=md-nav__link> <span class=md-ellipsis> Implementation Phases </span> </a> </li> <li class=md-nav__item> <a href=../component-library-analysis/ class=md-nav__link> <span class=md-ellipsis> Component Library Analysis </span> </a> </li> <li class=md-nav__item> <a href=../architecture-evaluation/ class=md-nav__link> <span class=md-ellipsis> Architecture Evaluation </span> </a> </li> <li class=md-nav__item> <a href=../multi-tenancy/ class=md-nav__link> <span class=md-ellipsis> Multi-Tenancy </span> </a> </li> <li class=md-nav__item> <a href=../protocol-agnostic-tools/ class=md-nav__link> <span class=md-ellipsis> Protocol-Agnostic Tools </span> </a> </li> <li class=md-nav__item> <a href=../mcp-spec-alignment/ class=md-nav__link> <span class=md-ellipsis> MCP Spec Alignment </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#executive-summary class=md-nav__link> <span class=md-ellipsis> Executive Summary </span> </a> <nav class=md-nav aria-label="Executive Summary"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#current-state class=md-nav__link> <span class=md-ellipsis> Current State </span> </a> </li> <li class=md-nav__item> <a href=#target-state class=md-nav__link> <span class=md-ellipsis> Target State </span> </a> </li> <li class=md-nav__item> <a href=#scope-clarification class=md-nav__link> <span class=md-ellipsis> Scope Clarification </span> </a> </li> <li class=md-nav__item> <a href=#timeline-overview class=md-nav__link> <span class=md-ellipsis> Timeline Overview </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#table-of-contents class=md-nav__link> <span class=md-ellipsis> Table of Contents </span> </a> </li> <li class=md-nav__item> <a href=#1-library-inventory class=md-nav__link> <span class=md-ellipsis> 1. Library Inventory </span> </a> <nav class=md-nav aria-label="1. Library Inventory"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#existing-libraries-production class=md-nav__link> <span class=md-ellipsis> Existing Libraries (Production) </span> </a> </li> <li class=md-nav__item> <a href=#proposed-libraries-new class=md-nav__link> <span class=md-ellipsis> Proposed Libraries (New) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2-dependency-map class=md-nav__link> <span class=md-ellipsis> 2. Dependency Map </span> </a> <nav class=md-nav aria-label="2. Dependency Map"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#library-dependencies-dag class=md-nav__link> <span class=md-ellipsis> Library Dependencies (DAG) </span> </a> </li> <li class=md-nav__item> <a href=#upstreamdownstream-impact-matrix class=md-nav__link> <span class=md-ellipsis> Upstream/Downstream Impact Matrix </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3-work-streams class=md-nav__link> <span class=md-ellipsis> 3. Work Streams </span> </a> <nav class=md-nav aria-label="3. Work Streams"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#stream-a-core-exposure class=md-nav__link> <span class=md-ellipsis> Stream A: Core Exposure </span> </a> <nav class=md-nav aria-label="Stream A: Core Exposure"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#a1-cli-framework-2-weeks class=md-nav__link> <span class=md-ellipsis> A1: CLI Framework (2 weeks) </span> </a> </li> <li class=md-nav__item> <a href=#a2-configuration-1-week class=md-nav__link> <span class=md-ellipsis> A2: Configuration (1 week) </span> </a> </li> <li class=md-nav__item> <a href=#a3-transport-layer-2-weeks class=md-nav__link> <span class=md-ellipsis> A3: Transport Layer (2 weeks) </span> </a> </li> <li class=md-nav__item> <a href=#a4-provider-registry-1-week class=md-nav__link> <span class=md-ellipsis> A4: Provider Registry (1 week) </span> </a> </li> <li class=md-nav__item> <a href=#a5-backend-registry-2-weeks class=md-nav__link> <span class=md-ellipsis> A5: Backend Registry (2 weeks) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#stream-b-protocol-layer class=md-nav__link> <span class=md-ellipsis> Stream B: Protocol Layer </span> </a> <nav class=md-nav aria-label="Stream B: Protocol Layer"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#b1-tooladapter-core-2-weeks class=md-nav__link> <span class=md-ellipsis> B1: tooladapter Core (2 weeks) </span> </a> </li> <li class=md-nav__item> <a href=#b2-additional-adapters-1-week class=md-nav__link> <span class=md-ellipsis> B2: Additional Adapters (1 week) </span> </a> </li> <li class=md-nav__item> <a href=#b3-toolset-core-2-weeks class=md-nav__link> <span class=md-ellipsis> B3: toolset Core (2 weeks) </span> </a> </li> <li class=md-nav__item> <a href=#b4-multi-transport-1-week class=md-nav__link> <span class=md-ellipsis> B4: Multi-Transport (1 week) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#stream-c-cross-cutting class=md-nav__link> <span class=md-ellipsis> Stream C: Cross-Cutting </span> </a> <nav class=md-nav aria-label="Stream C: Cross-Cutting"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#c1-toolcache-2-weeks class=md-nav__link> <span class=md-ellipsis> C1: toolcache (2 weeks) </span> </a> </li> <li class=md-nav__item> <a href=#c2-toolobserve-2-weeks class=md-nav__link> <span class=md-ellipsis> C2: toolobserve (2 weeks) </span> </a> </li> <li class=md-nav__item> <a href=#c3-toolversion-2-weeks class=md-nav__link> <span class=md-ellipsis> C3: toolversion (2 weeks) </span> </a> </li> <li class=md-nav__item> <a href=#c4-toolresilience-2-weeks class=md-nav__link> <span class=md-ellipsis> C4: toolresilience (2 weeks) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#stream-d-enterprise class=md-nav__link> <span class=md-ellipsis> Stream D: Enterprise </span> </a> <nav class=md-nav aria-label="Stream D: Enterprise"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#d1-multi-tenancy-core-2-weeks class=md-nav__link> <span class=md-ellipsis> D1: Multi-Tenancy Core (2 weeks) </span> </a> </li> <li class=md-nav__item> <a href=#d4-toolsemantic-advanced-semantic-search-3-weeks class=md-nav__link> <span class=md-ellipsis> D4: toolsemantic - Advanced Semantic Search (3 weeks) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#stream-e-agent-skills class=md-nav__link> <span class=md-ellipsis> Stream E: Agent Skills </span> </a> <nav class=md-nav aria-label="Stream E: Agent Skills"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#abstraction-hierarchy class=md-nav__link> <span class=md-ellipsis> Abstraction Hierarchy </span> </a> </li> <li class=md-nav__item> <a href=#e1-skill-core-2-weeks class=md-nav__link> <span class=md-ellipsis> E1: Skill Core (2 weeks) </span> </a> </li> <li class=md-nav__item> <a href=#skillmd-standard-format-support class=md-nav__link> <span class=md-ellipsis> SKILL.md Standard Format Support </span> </a> </li> <li class=md-nav__item> <a href=#e2-skill-composition-1-week class=md-nav__link> <span class=md-ellipsis> E2: Skill Composition (1 week) </span> </a> </li> <li class=md-nav__item> <a href=#e3-skill-execution-1-week class=md-nav__link> <span class=md-ellipsis> E3: Skill Execution (1 week) </span> </a> </li> <li class=md-nav__item> <a href=#skill-tool-integration class=md-nav__link> <span class=md-ellipsis> Skill-Tool Integration </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#4-phase-breakdown class=md-nav__link> <span class=md-ellipsis> 4. Phase Breakdown </span> </a> <nav class=md-nav aria-label="4. Phase Breakdown"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#phase-1-mvp-core-weeks-1-7 class=md-nav__link> <span class=md-ellipsis> Phase 1: MVP Core (Weeks 1-7) </span> </a> </li> <li class=md-nav__item> <a href=#phase-2-protocol-layer-weeks-8-14 class=md-nav__link> <span class=md-ellipsis> Phase 2: Protocol Layer (Weeks 8-14) </span> </a> </li> <li class=md-nav__item> <a href=#phase-3-cross-cutting-weeks-8-17-parallel class=md-nav__link> <span class=md-ellipsis> Phase 3: Cross-Cutting (Weeks 8-17, parallel) </span> </a> </li> <li class=md-nav__item> <a href=#phase-4-enterprise-weeks-12-17-parallel class=md-nav__link> <span class=md-ellipsis> Phase 4: Enterprise (Weeks 12-17, parallel) </span> </a> </li> <li class=md-nav__item> <a href=#phase-5-agent-skills-weeks-18-21 class=md-nav__link> <span class=md-ellipsis> Phase 5: Agent Skills (Weeks 18-21) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#5-interface-contracts class=md-nav__link> <span class=md-ellipsis> 5. Interface Contracts </span> </a> <nav class=md-nav aria-label="5. Interface Contracts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#core-interfaces-must-be-stable class=md-nav__link> <span class=md-ellipsis> Core Interfaces (Must Be Stable) </span> </a> </li> <li class=md-nav__item> <a href=#new-interfaces-design-phase class=md-nav__link> <span class=md-ellipsis> New Interfaces (Design Phase) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#6-edge-cases-considerations class=md-nav__link> <span class=md-ellipsis> 6. Edge Cases &amp; Considerations </span> </a> <nav class=md-nav aria-label="6. Edge Cases & Considerations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#interface-evolution class=md-nav__link> <span class=md-ellipsis> Interface Evolution </span> </a> </li> <li class=md-nav__item> <a href=#error-handling class=md-nav__link> <span class=md-ellipsis> Error Handling </span> </a> </li> <li class=md-nav__item> <a href=#concurrency class=md-nav__link> <span class=md-ellipsis> Concurrency </span> </a> </li> <li class=md-nav__item> <a href=#resource-limits class=md-nav__link> <span class=md-ellipsis> Resource Limits </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#7-rollout-strategy class=md-nav__link> <span class=md-ellipsis> 7. Rollout Strategy </span> </a> <nav class=md-nav aria-label="7. Rollout Strategy"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#version-compatibility-matrix class=md-nav__link> <span class=md-ellipsis> Version Compatibility Matrix </span> </a> </li> <li class=md-nav__item> <a href=#release-cadence class=md-nav__link> <span class=md-ellipsis> Release Cadence </span> </a> </li> <li class=md-nav__item> <a href=#migration-guides class=md-nav__link> <span class=md-ellipsis> Migration Guides </span> </a> </li> <li class=md-nav__item> <a href=#feature-flags-for-rollout class=md-nav__link> <span class=md-ellipsis> Feature Flags for Rollout </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#8-multi-language-extensibility class=md-nav__link> <span class=md-ellipsis> 8. Multi-Language Extensibility </span> </a> <nav class=md-nav aria-label="8. Multi-Language Extensibility"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#why-multi-language-matters class=md-nav__link> <span class=md-ellipsis> Why Multi-Language Matters </span> </a> </li> <li class=md-nav__item> <a href=#interface-contract-technologies class=md-nav__link> <span class=md-ellipsis> Interface Contract Technologies </span> </a> <nav class=md-nav aria-label="Interface Contract Technologies"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#option-1-grpc-protocol-buffers-recommended class=md-nav__link> <span class=md-ellipsis> Option 1: gRPC + Protocol Buffers (Recommended) </span> </a> </li> <li class=md-nav__item> <a href=#option-2-webassembly-component-model-emerging class=md-nav__link> <span class=md-ellipsis> Option 2: WebAssembly Component Model (Emerging) </span> </a> </li> <li class=md-nav__item> <a href=#option-3-json-rpc-over-stdio-simple class=md-nav__link> <span class=md-ellipsis> Option 3: JSON-RPC over stdio (Simple) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#recommended-approach-by-component class=md-nav__link> <span class=md-ellipsis> Recommended Approach by Component </span> </a> </li> <li class=md-nav__item> <a href=#plugin-sdk-generation class=md-nav__link> <span class=md-ellipsis> Plugin SDK Generation </span> </a> </li> <li class=md-nav__item> <a href=#configuration-for-multi-language-plugins class=md-nav__link> <span class=md-ellipsis> Configuration for Multi-Language Plugins </span> </a> </li> <li class=md-nav__item> <a href=#research-references class=md-nav__link> <span class=md-ellipsis> Research References </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#summary-roadmap-at-a-glance class=md-nav__link> <span class=md-ellipsis> Summary: Roadmap at a Glance </span> </a> </li> <li class=md-nav__item> <a href=#appendix-document-cross-references class=md-nav__link> <span class=md-ellipsis> Appendix: Document Cross-References </span> </a> </li> <li class=md-nav__item> <a href=#changelog class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=metatools-architecture-roadmap>Metatools Architecture Roadmap<a class=headerlink href=#metatools-architecture-roadmap title="Permanent link">&para;</a></h1> <p><strong>Status:</strong> Master Plan <strong>Version:</strong> 1.0.0 <strong>Last Updated:</strong> 2026-01-28</p> <blockquote> <p><strong>Guiding Principle</strong>: Simple and elegant at the core, extensible through modular, pluggable architecture. The existing 7 libraries represent a mature, well-designed foundation. New work focuses on <strong>exposure, configuration, and enterprise capabilities</strong>—not redesign.</p> </blockquote> <hr> <h2 id=executive-summary>Executive Summary<a class=headerlink href=#executive-summary title="Permanent link">&para;</a></h2> <h3 id=current-state>Current State<a class=headerlink href=#current-state title="Permanent link">&para;</a></h3> <ul> <li><strong>7 production libraries</strong> with clean interfaces</li> <li><strong>13 extension points</strong> already implemented as Go interfaces</li> <li><strong>85% championship-level</strong> architecture</li> <li><strong>Primary gap</strong>: Exposure and configuration, not architecture</li> </ul> <h3 id=target-state>Target State<a class=headerlink href=#target-state title="Permanent link">&para;</a></h3> <ul> <li><strong>22 total libraries</strong> (7 existing + 15 new)</li> <li><strong>95%+ championship-level</strong> with full enterprise capabilities</li> <li><strong>Protocol-agnostic</strong> tool platform</li> <li><strong>Multi-tenant</strong> with pluggable isolation strategies</li> <li><strong>Agent skills</strong> for higher-level capability composition</li> </ul> <h3 id=scope-clarification>Scope Clarification<a class=headerlink href=#scope-clarification title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Milestone</th> <th>Scope</th> <th>Timeline</th> <th>Document Reference</th> </tr> </thead> <tbody> <tr> <td><strong>MVP</strong></td> <td>CLI, Config, Transport, Provider Registry</td> <td>7 weeks</td> <td>implementation-phases.md</td> </tr> <tr> <td><strong>Protocol</strong></td> <td>+ tooladapter, toolset, multi-transport</td> <td>14 weeks</td> <td>protocol-agnostic-tools.md</td> </tr> <tr> <td><strong>Enterprise</strong></td> <td>+ toolsemantic, toolgateway, multi-tenancy</td> <td>17 weeks</td> <td>multi-tenancy.md</td> </tr> <tr> <td><strong>Full</strong></td> <td>+ toolskill (Agent Skills)</td> <td>21 weeks</td> <td>This document</td> </tr> </tbody> </table> <blockquote> <p><strong>Note:</strong> implementation-phases.md covers MVP scope only (6-7 weeks). This master roadmap covers the full 21-week timeline.</p> </blockquote> <h3 id=timeline-overview>Timeline Overview<a class=headerlink href=#timeline-overview title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>                    CORE EXPOSURE          ENTERPRISE FEATURES         AGENT SKILLS
                    ─────────────          ───────────────────         ────────────
Week 1-2   ████████ CLI + Config
Week 3-4   ████████ Transport Layer
Week 5     ████████ Provider Registry
Week 6-7   ████████ Backend Registry
Week 8-9              ████████ Protocol Adapters
Week 10-11            ████████ Observability + Caching
Week 12-13            ████████ Multi-Tenancy
Week 14-15            ████████ Versioning + Resilience
Week 16-17            ████████ Semantic Search + Gateway
Week 18-19                                                    ████████ Skill Core
Week 20-21                                                    ████████ Orchestration
                    ─────────────────────────────────────────────────────────────────
                    MVP: 7 weeks | Full: 17 weeks | Skills: 21 weeks
</code></pre></div> <hr> <h2 id=table-of-contents>Table of Contents<a class=headerlink href=#table-of-contents title="Permanent link">&para;</a></h2> <ol> <li><a href=#1-library-inventory>Library Inventory</a></li> <li><a href=#2-dependency-map>Dependency Map</a></li> <li><a href=#3-work-streams>Work Streams</a></li> <li><a href=#stream-a-core-exposure>Stream A: Core Exposure</a></li> <li><a href=#stream-b-protocol-layer>Stream B: Protocol Layer</a></li> <li><a href=#stream-c-cross-cutting>Stream C: Cross-Cutting</a></li> <li><a href=#stream-d-enterprise>Stream D: Enterprise</a></li> <li><a href=#stream-e-agent-skills>Stream E: Agent Skills</a></li> <li><a href=#4-phase-breakdown>Phase Breakdown</a></li> <li><a href=#5-interface-contracts>Interface Contracts</a></li> <li><a href=#6-edge-cases--considerations>Edge Cases &amp; Considerations</a></li> <li><a href=#7-rollout-strategy>Rollout Strategy</a></li> <li><a href=#8-multi-language-extensibility>Multi-Language Extensibility</a></li> </ol> <hr> <h2 id=1-library-inventory>1. Library Inventory<a class=headerlink href=#1-library-inventory title="Permanent link">&para;</a></h2> <h3 id=existing-libraries-production>Existing Libraries (Production)<a class=headerlink href=#existing-libraries-production title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Library</th> <th>Version</th> <th>Purpose</th> <th>Extension Points</th> <th>Changes Needed</th> </tr> </thead> <tbody> <tr> <td><strong>toolmodel</strong></td> <td>v0.1.3</td> <td>Core data models, schemas</td> <td>SchemaValidator</td> <td>Add Version field</td> </tr> <tr> <td><strong>toolindex</strong></td> <td>v0.1.9</td> <td>Tool registry, discovery</td> <td>Searcher, BackendSelector</td> <td>Multi-backend events</td> </tr> <tr> <td><strong>tooldocs</strong></td> <td>v0.1.11</td> <td>Progressive disclosure docs</td> <td>Store, ToolResolver</td> <td>Bulk registration</td> </tr> <tr> <td><strong>toolsearch</strong></td> <td>v0.1.10</td> <td>BM25 search implementation</td> <td>(via Searcher)</td> <td>None</td> </tr> <tr> <td><strong>toolrun</strong></td> <td>v0.1.10</td> <td>Execution orchestration</td> <td>Runner, MCPExecutor, ProviderExecutor, LocalRegistry</td> <td>HTTP/gRPC executors</td> </tr> <tr> <td><strong>toolcode</strong></td> <td>v0.1.11</td> <td>Code execution</td> <td>Engine, Logger</td> <td>Engine registry</td> </tr> <tr> <td><strong>toolruntime</strong></td> <td>v0.1.11</td> <td>Sandbox isolation (10 backends)</td> <td>Backend, ToolGateway</td> <td>None</td> </tr> </tbody> </table> <h3 id=proposed-libraries-new>Proposed Libraries (New)<a class=headerlink href=#proposed-libraries-new title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Library</th> <th>Stream</th> <th>Purpose</th> <th>Priority</th> <th>Effort</th> <th>Dependencies</th> </tr> </thead> <tbody> <tr> <td><strong>tooladapter</strong></td> <td>Protocol</td> <td>Protocol-agnostic tool abstraction</td> <td>High</td> <td>2w</td> <td>toolmodel</td> </tr> <tr> <td><strong>toolset</strong></td> <td>Protocol</td> <td>Composable tool collections</td> <td>High</td> <td>2w</td> <td>tooladapter, toolindex</td> </tr> <tr> <td><strong>toolversion</strong></td> <td>Cross-Cut</td> <td>Semantic versioning, negotiation</td> <td>High</td> <td>2w</td> <td>toolmodel</td> </tr> <tr> <td><strong>toolcache</strong></td> <td>Cross-Cut</td> <td>Pluggable caching (Redis/Memory)</td> <td>High</td> <td>2w</td> <td>None</td> </tr> <tr> <td><strong>toolobserve</strong></td> <td>Cross-Cut</td> <td>OpenTelemetry tracing + metrics</td> <td>High</td> <td>2w</td> <td>None</td> </tr> <tr> <td><strong>toolresilience</strong></td> <td>Cross-Cut</td> <td>Circuit breaker, retry, bulkhead</td> <td>Medium</td> <td>2w</td> <td>None</td> </tr> <tr> <td><strong>toolhealth</strong></td> <td>Cross-Cut</td> <td>Health checks, readiness probes</td> <td>Medium</td> <td>1w</td> <td>None</td> </tr> <tr> <td><strong>toolsecrets</strong></td> <td>Cross-Cut</td> <td>Vault/AWS secrets management</td> <td>Medium</td> <td>2w</td> <td>None</td> </tr> <tr> <td><strong>toolflags</strong></td> <td>Cross-Cut</td> <td>Feature flags (LaunchDarkly)</td> <td>Low</td> <td>1w</td> <td>None</td> </tr> <tr> <td><strong>toolaudit</strong></td> <td>Cross-Cut</td> <td>Immutable audit logging</td> <td>Medium</td> <td>2w</td> <td>None</td> </tr> <tr> <td><strong>toolpressure</strong></td> <td>Cross-Cut</td> <td>Backpressure, load shedding</td> <td>Low</td> <td>1w</td> <td>None</td> </tr> <tr> <td><strong>toolsemantic</strong></td> <td>Enterprise</td> <td>Hybrid search (BM25+vector), GraphRAG, reranking, ColBERT</td> <td>High</td> <td>3w</td> <td>toolindex, toolsearch</td> </tr> <tr> <td><strong>toolresource</strong></td> <td>Enterprise</td> <td>MCP Resources support</td> <td>Medium</td> <td>2w</td> <td>toolindex</td> </tr> <tr> <td><strong>toolgateway</strong></td> <td>Enterprise</td> <td>Auth, rate limit, analytics proxy</td> <td>Medium</td> <td>3w</td> <td>All</td> </tr> <tr> <td><strong>toolskill</strong></td> <td>Skills</td> <td>SKILL.md-compatible agent skills, workflows</td> <td>Medium</td> <td>4w</td> <td>toolset, toolrun, toolobserve (opt), toolversion</td> </tr> </tbody> </table> <hr> <h2 id=2-dependency-map>2. Dependency Map<a class=headerlink href=#2-dependency-map title="Permanent link">&para;</a></h2> <h3 id=library-dependencies-dag>Library Dependencies (DAG)<a class=headerlink href=#library-dependencies-dag title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>                            ┌─────────────────┐
                            │    toolskill    │ (L5)
                            │  Agent Skills   │
                            └────────┬────────┘
                                     │
          ┌──────────────────────────┴──────────────────────────┐
          │                                                      │
          ▼                                                      ▼
┌─────────────────┐                                   ┌─────────────────┐
│   toolgateway   │ (L4)                              │    toolrun      │
│  Auth + Proxy   │                                   │   (execution)   │
└────────┬────────┘                                   └─────────────────┘
         │
         │
          ┌──────────────────────────┼──────────────────────────┐
          │                          │                          │
          ▼                          ▼                          ▼
┌─────────────────┐      ┌─────────────────┐      ┌─────────────────┐
│   toolobserve   │      │  toolresilience │      │    toolaudit    │ (L3)
│   OpenTelemetry │      │ Circuit Breaker │      │  Audit Logging  │
└────────┬────────┘      └────────┬────────┘      └────────┬────────┘
         │                        │                        │
         └────────────────────────┼────────────────────────┘
                                  │
          ┌───────────────────────┼───────────────────────┐
          │                       │                       │
          ▼                       ▼                       ▼
┌─────────────────┐      ┌─────────────────┐      ┌─────────────────┐
│    toolset      │      │   toolversion   │      │    toolcache    │ (L2)
│  Composable     │      │   Versioning    │      │    Caching      │
└────────┬────────┘      └────────┬────────┘      └────────┬────────┘
         │                        │                        │
         └────────────────────────┼────────────────────────┘
                                  │
                                  ▼
                        ┌─────────────────┐
                        │   tooladapter   │ (L1)
                        │ Protocol Adapt  │
                        └────────┬────────┘
                                 │
    ┌────────────────────────────┼────────────────────────────┐
    │                            │                            │
    ▼                            ▼                            ▼
┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐
│toolmodel│  │toolindex│  │tooldocs │  │ toolrun │  │toolcode │ (L0)
│  v0.1.2 │  │  v0.1.8 │  │ v0.1.10 │  │  v0.1.9 │  │ v0.1.10 │
└────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘
     │            │            │            │            │
     │            │            │            │            ▼
     │            │            │            │      ┌─────────────┐
     │            │            │            └─────►│ toolruntime │
     │            │            │                   │   v0.1.10   │
     │            │            ▼                   └─────────────┘
     │            │      ┌─────────┐
     │            └─────►│toolsearch│
     │                   │  v0.1.9  │
     └───────────────────┴──────────┘
</code></pre></div> <h3 id=upstreamdownstream-impact-matrix>Upstream/Downstream Impact Matrix<a class=headerlink href=#upstreamdownstream-impact-matrix title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Change In</th> <th>Affects Upstream</th> <th>Affects Downstream</th> </tr> </thead> <tbody> <tr> <td>toolmodel</td> <td>None</td> <td>All libraries</td> </tr> <tr> <td>toolindex</td> <td>None</td> <td>tooldocs, toolrun, toolset</td> </tr> <tr> <td>tooladapter</td> <td>toolmodel</td> <td>toolset, toolgateway</td> </tr> <tr> <td>toolversion</td> <td>toolmodel</td> <td>tooladapter, toolrun</td> </tr> <tr> <td>toolcache</td> <td>None</td> <td>toolindex, tooldocs, toolrun</td> </tr> <tr> <td>toolobserve</td> <td>None</td> <td>All libraries (optional)</td> </tr> <tr> <td>toolskill</td> <td>toolset, toolrun</td> <td>metatools (skill exposure)</td> </tr> </tbody> </table> <hr> <h2 id=3-work-streams>3. Work Streams<a class=headerlink href=#3-work-streams title="Permanent link">&para;</a></h2> <h3 id=stream-a-core-exposure>Stream A: Core Exposure<a class=headerlink href=#stream-a-core-exposure title="Permanent link">&para;</a></h3> <p><strong>Goal</strong>: Expose existing 13 extension points via configuration and CLI.</p> <table> <thead> <tr> <th>Phase</th> <th>Work Package</th> <th>Duration</th> <th>Deliverables</th> </tr> </thead> <tbody> <tr> <td>A1</td> <td>CLI Framework</td> <td>2 weeks</td> <td>Cobra CLI, subcommands</td> </tr> <tr> <td>A2</td> <td>Configuration</td> <td>1 week</td> <td>Koanf loader, YAML schema</td> </tr> <tr> <td>A3</td> <td>Transport Layer</td> <td>2 weeks</td> <td>Transport interface, stdio/SSE/HTTP</td> </tr> <tr> <td>A4</td> <td>Provider Registry</td> <td>1 week</td> <td>ToolProvider interface, registry</td> </tr> <tr> <td>A5</td> <td>Backend Registry</td> <td>2 weeks</td> <td>Backend interface, aggregator</td> </tr> </tbody> </table> <p><strong>Total: 8 weeks</strong> | <strong>MVP: Phases A1-A4 (6 weeks)</strong></p> <h4 id=a1-cli-framework-2-weeks>A1: CLI Framework (2 weeks)<a class=headerlink href=#a1-cli-framework-2-weeks title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code>Week 1:
├── Day 1-2: Cobra setup, root command
├── Day 3-4: `stdio` subcommand (existing behavior)
├── Day 5: `serve` subcommand (HTTP server)

Week 2:
├── Day 1-2: `version`, `validate` commands
├── Day 3-4: Signal handling, graceful shutdown
├── Day 5: Documentation, examples
</code></pre></div> <p><strong>Interface Contract:</strong> <div class=highlight><pre><span></span><code><span class=c1>// cmd/metatools/main.go</span>
<span class=kd>func</span><span class=w> </span><span class=nx>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>rootCmd</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=o>&amp;</span><span class=nx>cobra</span><span class=p>.</span><span class=nx>Command</span><span class=p>{</span><span class=nx>Use</span><span class=p>:</span><span class=w> </span><span class=s>&quot;metatools&quot;</span><span class=p>}</span>
<span class=w>    </span><span class=nx>rootCmd</span><span class=p>.</span><span class=nx>AddCommand</span><span class=p>(</span>
<span class=w>        </span><span class=nx>newStdioCmd</span><span class=p>(),</span><span class=w>   </span><span class=c1>// MCP over stdio (default)</span>
<span class=w>        </span><span class=nx>newServeCmd</span><span class=p>(),</span><span class=w>   </span><span class=c1>// HTTP/SSE server</span>
<span class=w>        </span><span class=nx>newVersionCmd</span><span class=p>(),</span><span class=w> </span><span class=c1>// Print version</span>
<span class=w>        </span><span class=nx>newValidateCmd</span><span class=p>(),</span><span class=w> </span><span class=c1>// Validate config</span>
<span class=w>    </span><span class=p>)</span>
<span class=w>    </span><span class=nx>rootCmd</span><span class=p>.</span><span class=nx>Execute</span><span class=p>()</span>
<span class=p>}</span>
</code></pre></div></p> <p><strong>Edge Cases:</strong> - [ ] Backward compatibility: <code>metatools</code> alone = <code>metatools stdio</code> - [ ] Environment variables override YAML config - [ ] Invalid config: fail fast with clear error messages - [ ] Missing optional config: sensible defaults</p> <h4 id=a2-configuration-1-week>A2: Configuration (1 week)<a class=headerlink href=#a2-configuration-1-week title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code>Week 3:
├── Day 1-2: Koanf setup, YAML parser
├── Day 3: Environment variable binding
├── Day 4: Config validation schema
├── Day 5: Default values, documentation
</code></pre></div> <p><strong>Interface Contract:</strong> <div class=highlight><pre><span></span><code><span class=c1>// internal/config/config.go</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Config</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Server</span><span class=w>     </span><span class=nx>ServerConfig</span><span class=w>     </span><span class=s>`koanf:&quot;server&quot;`</span>
<span class=w>    </span><span class=nx>Transport</span><span class=w>  </span><span class=nx>TransportConfig</span><span class=w>  </span><span class=s>`koanf:&quot;transport&quot;`</span>
<span class=w>    </span><span class=nx>Search</span><span class=w>     </span><span class=nx>SearchConfig</span><span class=w>     </span><span class=s>`koanf:&quot;search&quot;`</span>
<span class=w>    </span><span class=nx>Execution</span><span class=w>  </span><span class=nx>ExecutionConfig</span><span class=w>  </span><span class=s>`koanf:&quot;execution&quot;`</span>
<span class=w>    </span><span class=nx>Backends</span><span class=w>   </span><span class=nx>BackendsConfig</span><span class=w>   </span><span class=s>`koanf:&quot;backends&quot;`</span>
<span class=w>    </span><span class=nx>Middleware</span><span class=w> </span><span class=nx>MiddlewareConfig</span><span class=w> </span><span class=s>`koanf:&quot;middleware&quot;`</span>
<span class=p>}</span>

<span class=kd>func</span><span class=w> </span><span class=nx>Load</span><span class=p>(</span><span class=nx>path</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>Config</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=kd>func</span><span class=w> </span><span class=nx>LoadWithEnv</span><span class=p>(</span><span class=nx>path</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>prefix</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>Config</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
</code></pre></div></p> <p><strong>Edge Cases:</strong> - [ ] Config file not found: use defaults - [ ] Partial config: merge with defaults - [ ] Invalid values: return typed validation errors - [ ] Hot reload: optional, via <code>toolconfig</code> watcher</p> <h4 id=a3-transport-layer-2-weeks>A3: Transport Layer (2 weeks)<a class=headerlink href=#a3-transport-layer-2-weeks title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code>Week 4:
├── Day 1-2: Transport interface definition
├── Day 3-4: Stdio transport (wrap existing)
├── Day 5: Transport registry

Week 5:
├── Day 1-2: SSE transport implementation
├── Day 3-4: HTTP transport implementation
├── Day 5: TLS support, health endpoints
</code></pre></div> <p><strong>Interface Contract:</strong> <div class=highlight><pre><span></span><code><span class=c1>// internal/transport/transport.go</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Transport</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Name</span><span class=p>()</span><span class=w> </span><span class=kt>string</span><span class=w>  </span><span class=c1>// Transport identifier (e.g., &quot;stdio&quot;, &quot;sse&quot;, &quot;http&quot;)</span>
<span class=w>    </span><span class=nx>Serve</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>handler</span><span class=w> </span><span class=nx>RequestHandler</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>
<span class=w>    </span><span class=nx>Close</span><span class=p>()</span><span class=w> </span><span class=kt>error</span>
<span class=w>    </span><span class=nx>Info</span><span class=p>()</span><span class=w> </span><span class=nx>TransportInfo</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>TransportInfo</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Name</span><span class=w>     </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Protocol</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=c1>// &quot;stdio&quot;, &quot;http&quot;, &quot;sse&quot;, &quot;grpc&quot;</span>
<span class=w>    </span><span class=nx>Address</span><span class=w>  </span><span class=kt>string</span><span class=w> </span><span class=c1>// &quot;&quot; for stdio, &quot;localhost:8080&quot; for HTTP</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>TransportRegistry</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Register</span><span class=p>(</span><span class=nx>name</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>factory</span><span class=w> </span><span class=nx>TransportFactory</span><span class=p>)</span>
<span class=w>    </span><span class=nx>Get</span><span class=p>(</span><span class=nx>name</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=nx>Transport</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=w>    </span><span class=nx>List</span><span class=p>()</span><span class=w> </span><span class=p>[]</span><span class=kt>string</span>
<span class=p>}</span>
</code></pre></div></p> <p><strong>Edge Cases:</strong> - [ ] Stdio: handle broken pipe gracefully - [ ] HTTP: CORS headers for browser clients - [ ] SSE: reconnection with event ID - [ ] TLS: certificate rotation without restart - [ ] Health: <code>/health</code> (liveness), <code>/ready</code> (readiness)</p> <h4 id=a4-provider-registry-1-week>A4: Provider Registry (1 week)<a class=headerlink href=#a4-provider-registry-1-week title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code>Week 6:
├── Day 1-2: ToolProvider interface
├── Day 3: Provider registry
├── Day 4: Refactor existing tools as providers
├── Day 5: Custom provider registration docs
</code></pre></div> <p><strong>Interface Contract:</strong> <div class=highlight><pre><span></span><code><span class=c1>// internal/provider/provider.go</span>
<span class=kd>type</span><span class=w> </span><span class=nx>ToolProvider</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Name</span><span class=p>()</span><span class=w> </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Tool</span><span class=p>()</span><span class=w> </span><span class=o>*</span><span class=nx>mcp</span><span class=p>.</span><span class=nx>Tool</span>
<span class=w>    </span><span class=nx>Handle</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>input</span><span class=w> </span><span class=nx>json</span><span class=p>.</span><span class=nx>RawMessage</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=kt>any</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>ProviderRegistry</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Register</span><span class=p>(</span><span class=nx>provider</span><span class=w> </span><span class=nx>ToolProvider</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>
<span class=w>    </span><span class=nx>Get</span><span class=p>(</span><span class=nx>name</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=nx>ToolProvider</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=w>    </span><span class=nx>List</span><span class=p>()</span><span class=w> </span><span class=p>[]</span><span class=nx>ToolProvider</span>
<span class=w>    </span><span class=nx>Unregister</span><span class=p>(</span><span class=nx>name</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>
<span class=p>}</span>
</code></pre></div></p> <p><strong>Edge Cases:</strong> - [ ] Duplicate registration: return error, don't overwrite - [ ] Dynamic registration: emit events for discovery - [ ] Provider panic: recover, log, return error - [ ] Slow provider: context deadline enforced</p> <h4 id=a5-backend-registry-2-weeks>A5: Backend Registry (2 weeks)<a class=headerlink href=#a5-backend-registry-2-weeks title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code>Week 7:
├── Day 1-2: Backend interface definition
├── Day 3-4: Local backend (existing behavior)
├── Day 5: Backend registry

Week 8:
├── Day 1-2: MCP backend (connect to MCP servers)
├── Day 3-4: HTTP backend (REST API tools)
├── Day 5: Aggregator (merge tools from all backends)
</code></pre></div> <p><strong>Interface Contract:</strong> <div class=highlight><pre><span></span><code><span class=c1>// internal/backend/backend.go</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Backend</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Kind</span><span class=p>()</span><span class=w> </span><span class=kt>string</span><span class=w>              </span><span class=c1>// &quot;local&quot;, &quot;mcp&quot;, &quot;http&quot;</span>
<span class=w>    </span><span class=nx>Name</span><span class=p>()</span><span class=w> </span><span class=kt>string</span><span class=w>              </span><span class=c1>// Instance name</span>
<span class=w>    </span><span class=nx>Start</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>
<span class=w>    </span><span class=nx>Stop</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>
<span class=w>    </span><span class=nx>ListTools</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=o>*</span><span class=nx>toolmodel</span><span class=p>.</span><span class=nx>Tool</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=w>    </span><span class=nx>Execute</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>tool</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>input</span><span class=w> </span><span class=kt>any</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=kt>any</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=w>    </span><span class=nx>Health</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span><span class=w> </span><span class=nx>HealthStatus</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>BackendRegistry</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Register</span><span class=p>(</span><span class=nx>backend</span><span class=w> </span><span class=nx>Backend</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>
<span class=w>    </span><span class=nx>Get</span><span class=p>(</span><span class=nx>name</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=nx>Backend</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=w>    </span><span class=nx>ListByKind</span><span class=p>(</span><span class=nx>kind</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>[]</span><span class=nx>Backend</span>
<span class=w>    </span><span class=nx>Aggregate</span><span class=p>()</span><span class=w> </span><span class=nx>AggregatedBackend</span>
<span class=p>}</span>
</code></pre></div></p> <p><strong>Edge Cases:</strong> - [ ] Backend offline: mark unhealthy, exclude from routing - [ ] Tool name collision: namespace with backend name - [ ] Slow backend: per-backend timeout - [ ] Backend restart: re-register tools, emit events</p> <hr> <h3 id=stream-b-protocol-layer>Stream B: Protocol Layer<a class=headerlink href=#stream-b-protocol-layer title="Permanent link">&para;</a></h3> <p><strong>Goal</strong>: Protocol-agnostic tool exposure with composable toolsets.</p> <table> <thead> <tr> <th>Phase</th> <th>Work Package</th> <th>Duration</th> <th>Deliverables</th> </tr> </thead> <tbody> <tr> <td>B1</td> <td>tooladapter Core</td> <td>2 weeks</td> <td>Adapter interface, MCP adapter</td> </tr> <tr> <td>B2</td> <td>Additional Adapters</td> <td>1 week</td> <td>OpenAI, Anthropic, LangChain</td> </tr> <tr> <td>B3</td> <td>toolset Core</td> <td>2 weeks</td> <td>Toolset builder, filtering</td> </tr> <tr> <td>B4</td> <td>Multi-Transport</td> <td>1 week</td> <td>Expose via MCP, REST, direct</td> </tr> </tbody> </table> <p><strong>Total: 6 weeks</strong></p> <h4 id=b1-tooladapter-core-2-weeks>B1: tooladapter Core (2 weeks)<a class=headerlink href=#b1-tooladapter-core-2-weeks title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code>Week 9:
├── Day 1-2: CanonicalTool type definition
├── Day 3-4: Adapter interface
├── Day 5: MCP adapter (bidirectional)

Week 10:
├── Day 1-2: Schema conversion utilities
├── Day 3-4: Adapter registry
├── Day 5: Unit tests, documentation
</code></pre></div> <p><strong>Interface Contract:</strong> <div class=highlight><pre><span></span><code><span class=c1>// tooladapter/canonical.go</span>
<span class=kd>type</span><span class=w> </span><span class=nx>CanonicalTool</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>          </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Namespace</span><span class=w>   </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Name</span><span class=w>        </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Version</span><span class=w>     </span><span class=nx>semver</span><span class=p>.</span><span class=nx>Version</span>
<span class=w>    </span><span class=nx>Description</span><span class=w> </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>InputSchema</span><span class=w> </span><span class=o>*</span><span class=nx>JSONSchema</span>
<span class=w>    </span><span class=nx>OutputSchema</span><span class=w> </span><span class=o>*</span><span class=nx>JSONSchema</span>
<span class=w>    </span><span class=nx>Handler</span><span class=w>     </span><span class=nx>ToolHandler</span>
<span class=w>    </span><span class=nx>SourceFormat</span><span class=w> </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>SourceMeta</span><span class=w>   </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span>
<span class=p>}</span>

<span class=c1>// tooladapter/adapter.go</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Adapter</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Name</span><span class=p>()</span><span class=w> </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>ToCanonical</span><span class=p>(</span><span class=nx>raw</span><span class=w> </span><span class=kt>any</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>CanonicalTool</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=w>    </span><span class=nx>FromCanonical</span><span class=p>(</span><span class=nx>tool</span><span class=w> </span><span class=o>*</span><span class=nx>CanonicalTool</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=kt>any</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=w>    </span><span class=nx>SupportsFeature</span><span class=p>(</span><span class=nx>feature</span><span class=w> </span><span class=nx>SchemaFeature</span><span class=p>)</span><span class=w> </span><span class=kt>bool</span>
<span class=p>}</span>
</code></pre></div></p> <p><strong>Edge Cases:</strong> - [ ] Schema feature not supported: strip with warning - [ ] Conversion loss: preserve original in SourceMeta - [ ] Bidirectional round-trip: verify no data loss - [ ] Nil handling: optional fields default to nil/zero</p> <h4 id=b2-additional-adapters-1-week>B2: Additional Adapters (1 week)<a class=headerlink href=#b2-additional-adapters-1-week title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code>Week 11:
├── Day 1-2: OpenAI adapter (strict mode support)
├── Day 3: Anthropic adapter
├── Day 4: LangChain adapter
├── Day 5: OpenAPI adapter (import only)
</code></pre></div> <p><strong>Edge Cases:</strong> - [ ] OpenAI strict mode: reject unsupported features - [ ] Anthropic input_schema vs inputSchema naming - [ ] LangChain Zod schemas: convert to JSON Schema - [ ] OpenAPI discriminators: flatten to anyOf</p> <h4 id=b3-toolset-core-2-weeks>B3: toolset Core (2 weeks)<a class=headerlink href=#b3-toolset-core-2-weeks title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code>Week 12:
├── Day 1-2: Toolset type definition
├── Day 3-4: Builder pattern with fluent API
├── Day 5: Filter predicates

Week 13:
├── Day 1-2: Access control policies
├── Day 3-4: Integration with toolindex
├── Day 5: Integration with toolrun
</code></pre></div> <p><strong>Interface Contract:</strong> <div class=highlight><pre><span></span><code><span class=c1>// toolset/builder.go</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Builder</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=o>...</span><span class=w> </span><span class=p>}</span>

<span class=kd>func</span><span class=w> </span><span class=nx>NewBuilder</span><span class=p>(</span><span class=nx>name</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=p>)</span><span class=w> </span><span class=nx>FromRegistry</span><span class=p>(</span><span class=nx>reg</span><span class=w> </span><span class=o>*</span><span class=nx>Registry</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=p>)</span><span class=w> </span><span class=nx>WithNamespace</span><span class=p>(</span><span class=nx>ns</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=p>)</span><span class=w> </span><span class=nx>WithTags</span><span class=p>(</span><span class=nx>tags</span><span class=w> </span><span class=o>...</span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=p>)</span><span class=w> </span><span class=nx>WithTools</span><span class=p>(</span><span class=nx>ids</span><span class=w> </span><span class=o>...</span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=p>)</span><span class=w> </span><span class=nx>ExcludeTools</span><span class=p>(</span><span class=nx>ids</span><span class=w> </span><span class=o>...</span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=p>)</span><span class=w> </span><span class=nx>WithPolicy</span><span class=p>(</span><span class=nx>p</span><span class=w> </span><span class=o>*</span><span class=nx>AccessPolicy</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=p>)</span><span class=w> </span><span class=nx>Build</span><span class=p>()</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>Toolset</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
</code></pre></div></p> <p><strong>Edge Cases:</strong> - [ ] Empty toolset: valid, return empty list - [ ] Conflicting filters: AND logic (all must match) - [ ] Tool removed after build: refresh on demand - [ ] Circular exclude: no-op, tool already excluded</p> <h4 id=b4-multi-transport-1-week>B4: Multi-Transport (1 week)<a class=headerlink href=#b4-multi-transport-1-week title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code>Week 14:
├── Day 1-2: MCP exposure (enhanced)
├── Day 3: REST API exposure
├── Day 4: Direct Go client
├── Day 5: Documentation, examples
</code></pre></div> <p><strong>Edge Cases:</strong> - [ ] MCP version mismatch: negotiate or reject - [ ] REST pagination: cursor-based for large toolsets - [ ] Go client: context cancellation propagation</p> <hr> <h3 id=stream-c-cross-cutting>Stream C: Cross-Cutting<a class=headerlink href=#stream-c-cross-cutting title="Permanent link">&para;</a></h3> <p><strong>Goal</strong>: Production-ready cross-cutting concerns.</p> <table> <thead> <tr> <th>Phase</th> <th>Work Package</th> <th>Duration</th> <th>Deliverables</th> </tr> </thead> <tbody> <tr> <td>C1</td> <td>toolcache</td> <td>2 weeks</td> <td>Cache interface, Redis/Memory</td> </tr> <tr> <td>C2</td> <td>toolobserve</td> <td>2 weeks</td> <td>OpenTelemetry integration</td> </tr> <tr> <td>C3</td> <td>toolversion</td> <td>2 weeks</td> <td>Semantic versioning, negotiation</td> </tr> <tr> <td>C4</td> <td>toolresilience</td> <td>2 weeks</td> <td>Circuit breaker, retry</td> </tr> <tr> <td>C5</td> <td>toolhealth</td> <td>1 week</td> <td>Health checks</td> </tr> <tr> <td>C6</td> <td>toolaudit</td> <td>2 weeks</td> <td>Audit logging</td> </tr> <tr> <td>C7</td> <td>toolsecrets</td> <td>2 weeks</td> <td>Secrets management</td> </tr> <tr> <td>C8</td> <td>toolflags + toolpressure</td> <td>2 weeks</td> <td>Feature flags, backpressure</td> </tr> </tbody> </table> <p><strong>Total: 15 weeks</strong> (can parallelize C1-C3 and C4-C8)</p> <h4 id=c1-toolcache-2-weeks>C1: toolcache (2 weeks)<a class=headerlink href=#c1-toolcache-2-weeks title="Permanent link">&para;</a></h4> <p><strong>Interface Contract:</strong> <div class=highlight><pre><span></span><code><span class=c1>// toolcache/cache.go</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Cache</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Get</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>key</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span><span class=w> </span><span class=kt>bool</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=w>    </span><span class=nx>Set</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>key</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>value</span><span class=w> </span><span class=p>[]</span><span class=kt>byte</span><span class=p>,</span><span class=w> </span><span class=nx>ttl</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nx>Duration</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>
<span class=w>    </span><span class=nx>Delete</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>key</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>
<span class=w>    </span><span class=nx>Clear</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>pattern</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>
<span class=w>    </span><span class=nx>Stats</span><span class=p>()</span><span class=w> </span><span class=nx>CacheStats</span>
<span class=w>    </span><span class=nx>Close</span><span class=p>()</span><span class=w> </span><span class=kt>error</span>
<span class=p>}</span>
</code></pre></div></p> <p><strong>Implementations:</strong> - <code>MemoryCache</code> - LRU eviction, process-local - <code>RedisCache</code> - Distributed, TTL-based - <code>LayeredCache</code> - L1 memory + L2 Redis</p> <p><strong>Integration Points:</strong> - <code>toolindex</code>: Cache tool lookups (<code>index:tool:{id}</code>) - <code>tooldocs</code>: Cache documentation (<code>docs:{id}:{level}</code>) - <code>toolsearch</code>: Cache search results (<code>search:{hash}</code>) - <code>tooladapter</code>: Cache schema conversions (<code>schema:{format}:{id}</code>)</p> <h4 id=c2-toolobserve-2-weeks>C2: toolobserve (2 weeks)<a class=headerlink href=#c2-toolobserve-2-weeks title="Permanent link">&para;</a></h4> <p><strong>Interface Contract:</strong> <div class=highlight><pre><span></span><code><span class=c1>// toolobserve/observe.go</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Observer</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>StartSpan</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>name</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>Span</span><span class=p>)</span>
<span class=w>    </span><span class=nx>RecordMetric</span><span class=p>(</span><span class=nx>name</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>value</span><span class=w> </span><span class=kt>float64</span><span class=p>,</span><span class=w> </span><span class=nx>labels</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span><span class=p>)</span>
<span class=w>    </span><span class=nx>RecordError</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>Span</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>SetAttribute</span><span class=p>(</span><span class=nx>key</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>value</span><span class=w> </span><span class=kt>any</span><span class=p>)</span>
<span class=w>    </span><span class=nx>AddEvent</span><span class=p>(</span><span class=nx>name</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>attrs</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span><span class=p>)</span>
<span class=w>    </span><span class=nx>RecordError</span><span class=p>(</span><span class=nx>err</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=w>    </span><span class=nx>End</span><span class=p>()</span>
<span class=p>}</span>
</code></pre></div></p> <p><strong>Integration Points:</strong> - Middleware: auto-instrument all tool calls - Per-backend: trace backend latency - Per-tool: trace individual tool execution</p> <h4 id=c3-toolversion-2-weeks>C3: toolversion (2 weeks)<a class=headerlink href=#c3-toolversion-2-weeks title="Permanent link">&para;</a></h4> <p><strong>Interface Contract:</strong> <div class=highlight><pre><span></span><code><span class=c1>// toolversion/registry.go</span>
<span class=kd>type</span><span class=w> </span><span class=nx>VersionedToolRegistry</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Register</span><span class=p>(</span><span class=nx>tool</span><span class=w> </span><span class=o>*</span><span class=nx>VersionedTool</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>
<span class=w>    </span><span class=nx>Resolve</span><span class=p>(</span><span class=nx>name</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>constraint</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>VersionedTool</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=w>    </span><span class=nx>ListVersions</span><span class=p>(</span><span class=nx>name</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>[]</span><span class=nx>VersionInfo</span>
<span class=w>    </span><span class=nx>Deprecate</span><span class=p>(</span><span class=nx>name</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>version</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>message</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>sunset</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nx>Time</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>
<span class=p>}</span>
</code></pre></div></p> <p><strong>Edge Cases:</strong> - [ ] No matching version: return ErrNoCompatibleVersion - [ ] Deprecated tool used: log warning, emit metric - [ ] Sunset reached: remove from registry - [ ] Version constraint invalid: return parse error</p> <h4 id=c4-toolresilience-2-weeks>C4: toolresilience (2 weeks)<a class=headerlink href=#c4-toolresilience-2-weeks title="Permanent link">&para;</a></h4> <p><strong>Interface Contract:</strong> <div class=highlight><pre><span></span><code><span class=c1>// toolresilience/resilience.go</span>
<span class=kd>type</span><span class=w> </span><span class=nx>CircuitBreaker</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Execute</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>fn</span><span class=w> </span><span class=kd>func</span><span class=p>()</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>
<span class=w>    </span><span class=nx>State</span><span class=p>()</span><span class=w> </span><span class=nx>CircuitState</span>
<span class=w>    </span><span class=nx>Reset</span><span class=p>()</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>RetryPolicy</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Execute</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>fn</span><span class=w> </span><span class=kd>func</span><span class=p>()</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>
<span class=w>    </span><span class=nx>ShouldRetry</span><span class=p>(</span><span class=nx>err</span><span class=w> </span><span class=kt>error</span><span class=p>,</span><span class=w> </span><span class=nx>attempt</span><span class=w> </span><span class=kt>int</span><span class=p>)</span><span class=w> </span><span class=kt>bool</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>Bulkhead</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Acquire</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>
<span class=w>    </span><span class=nx>Release</span><span class=p>()</span>
<span class=w>    </span><span class=nx>Available</span><span class=p>()</span><span class=w> </span><span class=kt>int</span>
<span class=p>}</span>
</code></pre></div></p> <p><strong>Edge Cases:</strong> - [ ] Circuit open: fail fast without calling backend - [ ] Retry on non-idempotent: disabled by default - [ ] Bulkhead full: reject with 503 - [ ] Jitter calculation: prevent thundering herd</p> <hr> <h3 id=stream-d-enterprise>Stream D: Enterprise<a class=headerlink href=#stream-d-enterprise title="Permanent link">&para;</a></h3> <p><strong>Goal</strong>: Enterprise-grade features for production deployments.</p> <table> <thead> <tr> <th>Phase</th> <th>Work Package</th> <th>Duration</th> <th>Deliverables</th> </tr> </thead> <tbody> <tr> <td>D1</td> <td>Multi-Tenancy Core</td> <td>2 weeks</td> <td>Tenant model, resolvers</td> </tr> <tr> <td>D2</td> <td>Tenant Middleware</td> <td>1 week</td> <td>Rate limit, filtering, audit</td> </tr> <tr> <td>D3</td> <td>Tenant Storage</td> <td>1 week</td> <td>Redis/Postgres store</td> </tr> <tr> <td>D4</td> <td>toolsemantic</td> <td>3 weeks</td> <td>Vector search, hybrid</td> </tr> <tr> <td>D5</td> <td>toolresource</td> <td>2 weeks</td> <td>MCP Resources support</td> </tr> <tr> <td>D6</td> <td>toolgateway</td> <td>3 weeks</td> <td>Auth proxy, analytics</td> </tr> </tbody> </table> <p><strong>Total: 12 weeks</strong> (can parallelize D1-D3 and D4-D6)</p> <h4 id=d1-multi-tenancy-core-2-weeks>D1: Multi-Tenancy Core (2 weeks)<a class=headerlink href=#d1-multi-tenancy-core-2-weeks title="Permanent link">&para;</a></h4> <p><strong>Interface Contract:</strong> <div class=highlight><pre><span></span><code><span class=c1>// multi-tenancy</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Tenant</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>       </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Name</span><span class=w>     </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Tier</span><span class=w>     </span><span class=nx>TenantTier</span><span class=w> </span><span class=c1>// free, pro, enterprise</span>
<span class=w>    </span><span class=nx>Metadata</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>TenantResolver</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Resolve</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>req</span><span class=w> </span><span class=o>*</span><span class=nx>Request</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>TenantContext</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>TenantContext</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Tenant</span><span class=w>      </span><span class=o>*</span><span class=nx>Tenant</span>
<span class=w>    </span><span class=nx>Permissions</span><span class=w> </span><span class=p>[]</span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Config</span><span class=w>      </span><span class=o>*</span><span class=nx>TenantConfig</span>
<span class=w>    </span><span class=nx>Quotas</span><span class=w>      </span><span class=o>*</span><span class=nx>TenantQuotas</span>
<span class=p>}</span>
</code></pre></div></p> <p><strong>Isolation Strategies:</strong> 1. <strong>Shared</strong>: Logical isolation via middleware (default) 2. <strong>Namespace</strong>: Tool namespace per tenant 3. <strong>Process</strong>: Dedicated process per tenant</p> <p><strong>Edge Cases:</strong> - [ ] No tenant header: use default tenant or reject - [ ] Tenant not found: return 401/403 - [ ] Quota exceeded: return 429 with retry-after - [ ] Tenant config change: propagate to active sessions</p> <h4 id=d4-toolsemantic-advanced-semantic-search-3-weeks>D4: toolsemantic - Advanced Semantic Search (3 weeks)<a class=headerlink href=#d4-toolsemantic-advanced-semantic-search-3-weeks title="Permanent link">&para;</a></h4> <blockquote> <p><strong>Research-Driven Design</strong>: This specification is based on 2025 industry best practices for production RAG systems, including hybrid search, knowledge graphs, hierarchical chunking, agentic retrieval, and late interaction models.</p> </blockquote> <div class=highlight><pre><span></span><code>Week 16:
├── Day 1-2: Core embedding and vector interfaces
├── Day 3-4: Hybrid search (BM25 + vector fusion)
├── Day 5: Reranker integration

Week 17:
├── Day 1-2: GraphRAG knowledge graph layer
├── Day 3-4: Hierarchical/tree chunking
├── Day 5: Context tree traversal

Week 18:
├── Day 1-2: Agentic RAG (query expansion, multi-query)
├── Day 3-4: ColBERT/late interaction support
├── Day 5: Integration tests, benchmarks
</code></pre></div> <p><strong>Architecture Overview:</strong></p> <div class=highlight><pre><span></span><code>┌────────────────────────────────────────────────────────────────────────────┐
│                          AGENTIC RAG LAYER                                  │
│  Query Expansion → Multi-Query → Self-Reasoning → Adaptive Retrieval       │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│                           HYBRID SEARCH                                     │
│                                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                     │
│  │  BM25/TF-IDF│    │   Vector    │    │   GraphRAG  │                     │
│  │  (toolsearch)│   │  (Dense)    │    │ (Knowledge) │                     │
│  └──────┬──────┘    └──────┬──────┘    └──────┬──────┘                     │
│         │                  │                  │                             │
│         └──────────────────┼──────────────────┘                             │
│                            │                                                │
│                   ┌────────▼────────┐                                       │
│                   │  Rank Fusion    │                                       │
│                   │ (RRF / Weighted)│                                       │
│                   └────────┬────────┘                                       │
│                            │                                                │
│                   ┌────────▼────────┐                                       │
│                   │   Reranker      │                                       │
│                   │ (Cross-Encoder) │                                       │
│                   └─────────────────┘                                       │
└────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌────────────────────────────────────────────────────────────────────────────┐
│                        INDEX LAYER                                          │
│                                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐  │
│  │  BM25 Index │    │ HNSW/IVF    │    │  Knowledge  │    │ Hierarchical│  │
│  │(toolsearch) │    │Vector Index │    │   Graph     │    │    Tree     │  │
│  └─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘  │
└────────────────────────────────────────────────────────────────────────────┘
</code></pre></div> <p><strong>Core Interface Contracts:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>// toolsemantic/embedding.go</span>

<span class=c1>// Embedder generates vector embeddings from text</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Embedder</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Embed generates embedding for a single text</span>
<span class=w>    </span><span class=nx>Embed</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>text</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=kt>float32</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>

<span class=w>    </span><span class=c1>// EmbedBatch generates embeddings for multiple texts (more efficient)</span>
<span class=w>    </span><span class=nx>EmbedBatch</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>texts</span><span class=w> </span><span class=p>[]</span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>([][]</span><span class=kt>float32</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>

<span class=w>    </span><span class=c1>// Dimensions returns the embedding vector size</span>
<span class=w>    </span><span class=nx>Dimensions</span><span class=p>()</span><span class=w> </span><span class=kt>int</span>

<span class=w>    </span><span class=c1>// Model returns the model identifier</span>
<span class=w>    </span><span class=nx>Model</span><span class=p>()</span><span class=w> </span><span class=kt>string</span>
<span class=p>}</span>

<span class=c1>// EmbedderFactory creates embedders from configuration</span>
<span class=kd>type</span><span class=w> </span><span class=nx>EmbedderFactory</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Create</span><span class=p>(</span><span class=nx>config</span><span class=w> </span><span class=nx>EmbedderConfig</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=nx>Embedder</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=p>}</span>

<span class=c1>// EmbedderConfig configures an embedding provider</span>
<span class=kd>type</span><span class=w> </span><span class=nx>EmbedderConfig</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Provider</span><span class=w>   </span><span class=kt>string</span><span class=w>            </span><span class=c1>// &quot;openai&quot;, &quot;cohere&quot;, &quot;local&quot;, &quot;ollama&quot;</span>
<span class=w>    </span><span class=nx>Model</span><span class=w>      </span><span class=kt>string</span><span class=w>            </span><span class=c1>// &quot;text-embedding-3-small&quot;, &quot;embed-english-v3.0&quot;</span>
<span class=w>    </span><span class=nx>Dimensions</span><span class=w> </span><span class=kt>int</span><span class=w>               </span><span class=c1>// Override dimensions (for some models)</span>
<span class=w>    </span><span class=nx>Options</span><span class=w>    </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span><span class=w>    </span><span class=c1>// Provider-specific options</span>
<span class=p>}</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=c1>// toolsemantic/vector.go</span>

<span class=c1>// VectorIndex provides vector similarity search</span>
<span class=kd>type</span><span class=w> </span><span class=nx>VectorIndex</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Index adds vectors to the index</span>
<span class=w>    </span><span class=nx>Index</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>docs</span><span class=w> </span><span class=p>[]</span><span class=nx>VectorDocument</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>

<span class=w>    </span><span class=c1>// Search finds similar vectors</span>
<span class=w>    </span><span class=nx>Search</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>query</span><span class=w> </span><span class=p>[]</span><span class=kt>float32</span><span class=p>,</span><span class=w> </span><span class=nx>opts</span><span class=w> </span><span class=nx>SearchOptions</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=nx>VectorResult</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>

<span class=w>    </span><span class=c1>// Delete removes documents from index</span>
<span class=w>    </span><span class=nx>Delete</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>ids</span><span class=w> </span><span class=p>[]</span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>

<span class=w>    </span><span class=c1>// Stats returns index statistics</span>
<span class=w>    </span><span class=nx>Stats</span><span class=p>()</span><span class=w> </span><span class=nx>IndexStats</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>VectorDocument</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>        </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Vector</span><span class=w>    </span><span class=p>[]</span><span class=kt>float32</span>
<span class=w>    </span><span class=nx>Metadata</span><span class=w>  </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span>
<span class=w>    </span><span class=nx>Content</span><span class=w>   </span><span class=kt>string</span><span class=w>  </span><span class=c1>// Optional, for hybrid storage</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>VectorResult</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>       </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Score</span><span class=w>    </span><span class=kt>float32</span><span class=w>  </span><span class=c1>// Similarity score (higher = more similar)</span>
<span class=w>    </span><span class=nx>Distance</span><span class=w> </span><span class=kt>float32</span><span class=w>  </span><span class=c1>// Distance (lower = more similar)</span>
<span class=w>    </span><span class=nx>Metadata</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span>
<span class=w>    </span><span class=nx>Content</span><span class=w>  </span><span class=kt>string</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>SearchOptions</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>TopK</span><span class=w>     </span><span class=kt>int</span><span class=w>               </span><span class=c1>// Number of results</span>
<span class=w>    </span><span class=nx>MinScore</span><span class=w> </span><span class=kt>float32</span><span class=w>           </span><span class=c1>// Minimum similarity threshold</span>
<span class=w>    </span><span class=nx>Filter</span><span class=w>   </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span><span class=w>    </span><span class=c1>// Metadata filters</span>
<span class=p>}</span>

<span class=c1>// VectorIndexFactory creates vector indices</span>
<span class=kd>type</span><span class=w> </span><span class=nx>VectorIndexFactory</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Create</span><span class=p>(</span><span class=nx>config</span><span class=w> </span><span class=nx>VectorIndexConfig</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=nx>VectorIndex</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>VectorIndexConfig</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Backend</span><span class=w>     </span><span class=kt>string</span><span class=w>  </span><span class=c1>// &quot;memory&quot;, &quot;faiss&quot;, &quot;qdrant&quot;, &quot;pinecone&quot;, &quot;chromadb&quot;</span>
<span class=w>    </span><span class=nx>Dimensions</span><span class=w>  </span><span class=kt>int</span>
<span class=w>    </span><span class=nx>Metric</span><span class=w>      </span><span class=kt>string</span><span class=w>  </span><span class=c1>// &quot;cosine&quot;, &quot;euclidean&quot;, &quot;dot&quot;</span>
<span class=w>    </span><span class=nx>IndexType</span><span class=w>   </span><span class=kt>string</span><span class=w>  </span><span class=c1>// &quot;flat&quot;, &quot;hnsw&quot;, &quot;ivf&quot;</span>

<span class=w>    </span><span class=c1>// HNSW-specific</span>
<span class=w>    </span><span class=nx>M</span><span class=w>               </span><span class=kt>int</span><span class=w>  </span><span class=c1>// Max connections per layer</span>
<span class=w>    </span><span class=nx>EfConstruction</span><span class=w>  </span><span class=kt>int</span><span class=w>  </span><span class=c1>// Construction time quality/speed tradeoff</span>
<span class=w>    </span><span class=nx>EfSearch</span><span class=w>        </span><span class=kt>int</span><span class=w>  </span><span class=c1>// Search time quality/speed tradeoff</span>
<span class=p>}</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=c1>// toolsemantic/hybrid.go</span>

<span class=c1>// HybridSearcher combines multiple retrieval methods</span>
<span class=kd>type</span><span class=w> </span><span class=nx>HybridSearcher</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Search performs hybrid search across all configured retrievers</span>
<span class=w>    </span><span class=nx>Search</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>query</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>opts</span><span class=w> </span><span class=nx>HybridOptions</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=nx>SearchResult</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>

<span class=w>    </span><span class=c1>// Explain returns detailed scoring breakdown</span>
<span class=w>    </span><span class=nx>Explain</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>query</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>docID</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>ScoreExplanation</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>HybridOptions</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>TopK</span><span class=w>            </span><span class=kt>int</span>

<span class=w>    </span><span class=c1>// Retrieval weights (must sum to 1.0)</span>
<span class=w>    </span><span class=nx>BM25Weight</span><span class=w>      </span><span class=kt>float32</span><span class=w>  </span><span class=c1>// Weight for BM25/keyword results</span>
<span class=w>    </span><span class=nx>VectorWeight</span><span class=w>    </span><span class=kt>float32</span><span class=w>  </span><span class=c1>// Weight for vector similarity results</span>
<span class=w>    </span><span class=nx>GraphWeight</span><span class=w>     </span><span class=kt>float32</span><span class=w>  </span><span class=c1>// Weight for knowledge graph results</span>

<span class=w>    </span><span class=c1>// Fusion strategy</span>
<span class=w>    </span><span class=nx>FusionMethod</span><span class=w>    </span><span class=nx>FusionMethod</span><span class=w>  </span><span class=c1>// RRF, WeightedSum, Borda</span>

<span class=w>    </span><span class=c1>// Reranking</span>
<span class=w>    </span><span class=nx>EnableReranker</span><span class=w>  </span><span class=kt>bool</span>
<span class=w>    </span><span class=nx>RerankerTopK</span><span class=w>    </span><span class=kt>int</span><span class=w>  </span><span class=c1>// Rerank top N results</span>

<span class=w>    </span><span class=c1>// Filters</span>
<span class=w>    </span><span class=nx>Namespaces</span><span class=w>      </span><span class=p>[]</span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Tags</span><span class=w>            </span><span class=p>[]</span><span class=kt>string</span>
<span class=w>    </span><span class=nx>MetadataFilters</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>FusionMethod</span><span class=w> </span><span class=kt>string</span>

<span class=kd>const</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=nx>FusionRRF</span><span class=w>         </span><span class=nx>FusionMethod</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&quot;rrf&quot;</span><span class=w>          </span><span class=c1>// Reciprocal Rank Fusion</span>
<span class=w>    </span><span class=nx>FusionWeightedSum</span><span class=w> </span><span class=nx>FusionMethod</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&quot;weighted_sum&quot;</span><span class=w> </span><span class=c1>// Weighted score combination</span>
<span class=w>    </span><span class=nx>FusionBorda</span><span class=w>       </span><span class=nx>FusionMethod</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&quot;borda&quot;</span><span class=w>        </span><span class=c1>// Borda count ranking</span>
<span class=p>)</span>

<span class=kd>type</span><span class=w> </span><span class=nx>SearchResult</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>          </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Score</span><span class=w>       </span><span class=kt>float32</span>
<span class=w>    </span><span class=nx>Content</span><span class=w>     </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Metadata</span><span class=w>    </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span>

<span class=w>    </span><span class=c1>// Detailed scores</span>
<span class=w>    </span><span class=nx>BM25Score</span><span class=w>   </span><span class=kt>float32</span>
<span class=w>    </span><span class=nx>VectorScore</span><span class=w> </span><span class=kt>float32</span>
<span class=w>    </span><span class=nx>GraphScore</span><span class=w>  </span><span class=kt>float32</span>
<span class=w>    </span><span class=nx>RerankerScore</span><span class=w> </span><span class=kt>float32</span>

<span class=w>    </span><span class=c1>// Source tracking</span>
<span class=w>    </span><span class=nx>Sources</span><span class=w>     </span><span class=p>[]</span><span class=kt>string</span><span class=w>  </span><span class=c1>// Which retrievers contributed</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>ScoreExplanation</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>FinalScore</span><span class=w>    </span><span class=kt>float32</span>
<span class=w>    </span><span class=nx>FusionMethod</span><span class=w>  </span><span class=nx>FusionMethod</span>
<span class=w>    </span><span class=nx>Components</span><span class=w>    </span><span class=p>[]</span><span class=nx>ScoreComponent</span>
<span class=w>    </span><span class=nx>RerankerBoost</span><span class=w> </span><span class=kt>float32</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>ScoreComponent</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Source</span><span class=w>      </span><span class=kt>string</span><span class=w>   </span><span class=c1>// &quot;bm25&quot;, &quot;vector&quot;, &quot;graph&quot;</span>
<span class=w>    </span><span class=nx>RawScore</span><span class=w>    </span><span class=kt>float32</span>
<span class=w>    </span><span class=nx>Weight</span><span class=w>      </span><span class=kt>float32</span>
<span class=w>    </span><span class=nx>WeightedScore</span><span class=w> </span><span class=kt>float32</span>
<span class=w>    </span><span class=nx>Rank</span><span class=w>        </span><span class=kt>int</span>
<span class=p>}</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=c1>// toolsemantic/reranker.go</span>

<span class=c1>// Reranker performs cross-encoder reranking on retrieved results</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Reranker</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Rerank scores query-document pairs using cross-encoder</span>
<span class=w>    </span><span class=nx>Rerank</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>query</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>docs</span><span class=w> </span><span class=p>[]</span><span class=nx>RerankerInput</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=nx>RerankerResult</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>

<span class=w>    </span><span class=c1>// Model returns the reranker model identifier</span>
<span class=w>    </span><span class=nx>Model</span><span class=p>()</span><span class=w> </span><span class=kt>string</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>RerankerInput</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>      </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Content</span><span class=w> </span><span class=kt>string</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>RerankerResult</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>    </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Score</span><span class=w> </span><span class=kt>float32</span><span class=w>  </span><span class=c1>// Cross-encoder relevance score</span>
<span class=p>}</span>

<span class=c1>// RerankerConfig configures a reranker</span>
<span class=kd>type</span><span class=w> </span><span class=nx>RerankerConfig</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Provider</span><span class=w>  </span><span class=kt>string</span><span class=w>  </span><span class=c1>// &quot;cohere&quot;, &quot;jina&quot;, &quot;local&quot;, &quot;colbert&quot;</span>
<span class=w>    </span><span class=nx>Model</span><span class=w>     </span><span class=kt>string</span><span class=w>  </span><span class=c1>// &quot;rerank-english-v3.0&quot;, &quot;ms-marco-MiniLM&quot;</span>
<span class=w>    </span><span class=nx>MaxTokens</span><span class=w> </span><span class=kt>int</span><span class=w>     </span><span class=c1>// Max input tokens</span>
<span class=w>    </span><span class=nx>BatchSize</span><span class=w> </span><span class=kt>int</span><span class=w>     </span><span class=c1>// Batch size for efficiency</span>
<span class=p>}</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=c1>// toolsemantic/graph.go</span>

<span class=c1>// KnowledgeGraph provides graph-based retrieval (GraphRAG)</span>
<span class=kd>type</span><span class=w> </span><span class=nx>KnowledgeGraph</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Build extracts entities and relationships from documents</span>
<span class=w>    </span><span class=nx>Build</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>docs</span><span class=w> </span><span class=p>[]</span><span class=nx>GraphDocument</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>

<span class=w>    </span><span class=c1>// Query retrieves relevant subgraph for a query</span>
<span class=w>    </span><span class=nx>Query</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>query</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>opts</span><span class=w> </span><span class=nx>GraphQueryOptions</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>GraphResult</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>

<span class=w>    </span><span class=c1>// GetEntity retrieves a specific entity</span>
<span class=w>    </span><span class=nx>GetEntity</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>id</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>Entity</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>

<span class=w>    </span><span class=c1>// TraverseRelations walks relationships from an entity</span>
<span class=w>    </span><span class=nx>TraverseRelations</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>entityID</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>depth</span><span class=w> </span><span class=kt>int</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=nx>Relationship</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>GraphDocument</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>      </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Content</span><span class=w> </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Metadata</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>GraphQueryOptions</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>MaxEntities</span><span class=w>     </span><span class=kt>int</span>
<span class=w>    </span><span class=nx>MaxRelationships</span><span class=w> </span><span class=kt>int</span>
<span class=w>    </span><span class=nx>TraversalDepth</span><span class=w>  </span><span class=kt>int</span>
<span class=w>    </span><span class=nx>IncludeCommunities</span><span class=w> </span><span class=kt>bool</span><span class=w>  </span><span class=c1>// Include community summaries</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>GraphResult</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Entities</span><span class=w>      </span><span class=p>[]</span><span class=nx>Entity</span>
<span class=w>    </span><span class=nx>Relationships</span><span class=w> </span><span class=p>[]</span><span class=nx>Relationship</span>
<span class=w>    </span><span class=nx>Communities</span><span class=w>   </span><span class=p>[]</span><span class=nx>Community</span><span class=w>     </span><span class=c1>// High-level community summaries</span>
<span class=w>    </span><span class=nx>Summary</span><span class=w>       </span><span class=kt>string</span><span class=w>          </span><span class=c1>// Graph-generated summary</span>
<span class=w>    </span><span class=nx>Score</span><span class=w>         </span><span class=kt>float32</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>Entity</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>          </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Name</span><span class=w>        </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Type</span><span class=w>        </span><span class=kt>string</span><span class=w>            </span><span class=c1>// &quot;tool&quot;, &quot;namespace&quot;, &quot;concept&quot;</span>
<span class=w>    </span><span class=nx>Description</span><span class=w> </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Attributes</span><span class=w>  </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span>
<span class=w>    </span><span class=nx>Embedding</span><span class=w>   </span><span class=p>[]</span><span class=kt>float32</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>Relationship</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>       </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Source</span><span class=w>   </span><span class=kt>string</span><span class=w>  </span><span class=c1>// Entity ID</span>
<span class=w>    </span><span class=nx>Target</span><span class=w>   </span><span class=kt>string</span><span class=w>  </span><span class=c1>// Entity ID</span>
<span class=w>    </span><span class=nx>Type</span><span class=w>     </span><span class=kt>string</span><span class=w>  </span><span class=c1>// &quot;uses&quot;, &quot;depends_on&quot;, &quot;similar_to&quot;</span>
<span class=w>    </span><span class=nx>Weight</span><span class=w>   </span><span class=kt>float32</span>
<span class=w>    </span><span class=nx>Metadata</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>Community</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>       </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Name</span><span class=w>     </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Summary</span><span class=w>  </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Entities</span><span class=w> </span><span class=p>[]</span><span class=kt>string</span><span class=w>  </span><span class=c1>// Entity IDs in this community</span>
<span class=w>    </span><span class=nx>Level</span><span class=w>    </span><span class=kt>int</span><span class=w>       </span><span class=c1>// Hierarchy level (0 = most granular)</span>
<span class=p>}</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=c1>// toolsemantic/hierarchical.go</span>

<span class=c1>// HierarchicalChunker implements tree-structured document chunking</span>
<span class=kd>type</span><span class=w> </span><span class=nx>HierarchicalChunker</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Chunk splits document into hierarchical tree structure</span>
<span class=w>    </span><span class=nx>Chunk</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>doc</span><span class=w> </span><span class=o>*</span><span class=nx>Document</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>ChunkTree</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>

<span class=w>    </span><span class=c1>// Retrieve navigates tree to find relevant chunks</span>
<span class=w>    </span><span class=nx>Retrieve</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>tree</span><span class=w> </span><span class=o>*</span><span class=nx>ChunkTree</span><span class=p>,</span><span class=w> </span><span class=nx>query</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>opts</span><span class=w> </span><span class=nx>TreeOptions</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=nx>Chunk</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>Document</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>       </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Content</span><span class=w>  </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Metadata</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>ChunkTree</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Root</span><span class=w>     </span><span class=o>*</span><span class=nx>ChunkNode</span>
<span class=w>    </span><span class=nx>Depth</span><span class=w>    </span><span class=kt>int</span>
<span class=w>    </span><span class=nx>NumNodes</span><span class=w> </span><span class=kt>int</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>ChunkNode</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>        </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Level</span><span class=w>     </span><span class=kt>int</span><span class=w>           </span><span class=c1>// 0 = leaf, higher = more abstract</span>
<span class=w>    </span><span class=nx>Content</span><span class=w>   </span><span class=kt>string</span><span class=w>        </span><span class=c1>// Text content or summary</span>
<span class=w>    </span><span class=nx>Embedding</span><span class=w> </span><span class=p>[]</span><span class=kt>float32</span>
<span class=w>    </span><span class=nx>Children</span><span class=w>  </span><span class=p>[]</span><span class=o>*</span><span class=nx>ChunkNode</span>
<span class=w>    </span><span class=nx>Parent</span><span class=w>    </span><span class=o>*</span><span class=nx>ChunkNode</span>

<span class=w>    </span><span class=c1>// For RAPTOR-style summarization</span>
<span class=w>    </span><span class=nx>Summary</span><span class=w>   </span><span class=kt>string</span><span class=w>        </span><span class=c1>// LLM-generated summary at this level</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>Chunk</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>        </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Content</span><span class=w>   </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Level</span><span class=w>     </span><span class=kt>int</span>
<span class=w>    </span><span class=nx>Score</span><span class=w>     </span><span class=kt>float32</span>
<span class=w>    </span><span class=nx>Path</span><span class=w>      </span><span class=p>[]</span><span class=kt>string</span><span class=w>  </span><span class=c1>// Path from root to this chunk</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>TreeOptions</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>MaxChunks</span><span class=w>     </span><span class=kt>int</span>
<span class=w>    </span><span class=nx>MinLevel</span><span class=w>      </span><span class=kt>int</span><span class=w>  </span><span class=c1>// Minimum abstraction level to consider</span>
<span class=w>    </span><span class=nx>MaxLevel</span><span class=w>      </span><span class=kt>int</span><span class=w>  </span><span class=c1>// Maximum abstraction level</span>

<span class=w>    </span><span class=c1>// Traversal strategy</span>
<span class=w>    </span><span class=nx>Strategy</span><span class=w>      </span><span class=nx>TraversalStrategy</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>TraversalStrategy</span><span class=w> </span><span class=kt>string</span>

<span class=kd>const</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=nx>TraversalTopDown</span><span class=w>    </span><span class=nx>TraversalStrategy</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&quot;top_down&quot;</span><span class=w>    </span><span class=c1>// Start from summaries</span>
<span class=w>    </span><span class=nx>TraversalBottomUp</span><span class=w>   </span><span class=nx>TraversalStrategy</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&quot;bottom_up&quot;</span><span class=w>   </span><span class=c1>// Start from leaves</span>
<span class=w>    </span><span class=nx>TraversalCollapsed</span><span class=w>  </span><span class=nx>TraversalStrategy</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&quot;collapsed&quot;</span><span class=w>   </span><span class=c1>// RAPTOR-style collapsed tree</span>
<span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=c1>// toolsemantic/agentic.go</span>

<span class=c1>// AgenticRetriever implements LLM-enhanced retrieval strategies</span>
<span class=kd>type</span><span class=w> </span><span class=nx>AgenticRetriever</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Retrieve performs agentic retrieval with optional query expansion</span>
<span class=w>    </span><span class=nx>Retrieve</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>query</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>opts</span><span class=w> </span><span class=nx>AgenticOptions</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>AgenticResult</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>AgenticOptions</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Query expansion</span>
<span class=w>    </span><span class=nx>EnableQueryExpansion</span><span class=w>  </span><span class=kt>bool</span>
<span class=w>    </span><span class=nx>MaxExpandedQueries</span><span class=w>    </span><span class=kt>int</span>

<span class=w>    </span><span class=c1>// Multi-query</span>
<span class=w>    </span><span class=nx>EnableMultiQuery</span><span class=w>      </span><span class=kt>bool</span>
<span class=w>    </span><span class=nx>QueryVariations</span><span class=w>       </span><span class=kt>int</span>

<span class=w>    </span><span class=c1>// Self-reasoning (Step-Back, Chain-of-Thought)</span>
<span class=w>    </span><span class=nx>EnableSelfReasoning</span><span class=w>   </span><span class=kt>bool</span>
<span class=w>    </span><span class=nx>ReasoningDepth</span><span class=w>        </span><span class=kt>int</span>

<span class=w>    </span><span class=c1>// Iterative retrieval</span>
<span class=w>    </span><span class=nx>EnableIterative</span><span class=w>       </span><span class=kt>bool</span>
<span class=w>    </span><span class=nx>MaxIterations</span><span class=w>         </span><span class=kt>int</span>
<span class=w>    </span><span class=nx>StopCondition</span><span class=w>         </span><span class=kd>func</span><span class=p>(</span><span class=nx>results</span><span class=w> </span><span class=p>[]</span><span class=nx>SearchResult</span><span class=p>)</span><span class=w> </span><span class=kt>bool</span>

<span class=w>    </span><span class=c1>// Base retriever to use</span>
<span class=w>    </span><span class=nx>BaseRetriever</span><span class=w>         </span><span class=nx>HybridSearcher</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>AgenticResult</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Results</span><span class=w>          </span><span class=p>[]</span><span class=nx>SearchResult</span>

<span class=w>    </span><span class=c1>// Agentic metadata</span>
<span class=w>    </span><span class=nx>ExpandedQueries</span><span class=w>  </span><span class=p>[]</span><span class=kt>string</span>
<span class=w>    </span><span class=nx>ReasoningChain</span><span class=w>   </span><span class=p>[]</span><span class=nx>ReasoningStep</span>
<span class=w>    </span><span class=nx>Iterations</span><span class=w>       </span><span class=kt>int</span>

<span class=w>    </span><span class=c1>// Quality signals</span>
<span class=w>    </span><span class=nx>Confidence</span><span class=w>       </span><span class=kt>float32</span>
<span class=w>    </span><span class=nx>CoverageScore</span><span class=w>    </span><span class=kt>float32</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>ReasoningStep</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Step</span><span class=w>        </span><span class=kt>int</span>
<span class=w>    </span><span class=nx>Query</span><span class=w>       </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Reasoning</span><span class=w>   </span><span class=kt>string</span><span class=w>   </span><span class=c1>// LLM explanation</span>
<span class=w>    </span><span class=nx>ResultCount</span><span class=w> </span><span class=kt>int</span>
<span class=w>    </span><span class=nx>TopScore</span><span class=w>    </span><span class=kt>float32</span>
<span class=p>}</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=c1>// toolsemantic/colbert.go</span>

<span class=c1>// ColBERTIndex implements late interaction retrieval</span>
<span class=kd>type</span><span class=w> </span><span class=nx>ColBERTIndex</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Index adds documents with token-level embeddings</span>
<span class=w>    </span><span class=nx>Index</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>docs</span><span class=w> </span><span class=p>[]</span><span class=nx>ColBERTDocument</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>

<span class=w>    </span><span class=c1>// Search performs MaxSim-based late interaction search</span>
<span class=w>    </span><span class=nx>Search</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>query</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>opts</span><span class=w> </span><span class=nx>ColBERTOptions</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=nx>ColBERTResult</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>ColBERTDocument</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>           </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Content</span><span class=w>      </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>TokenEmbeddings</span><span class=w> </span><span class=p>[][]</span><span class=kt>float32</span><span class=w>  </span><span class=c1>// Per-token embeddings</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>ColBERTOptions</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>TopK</span><span class=w>         </span><span class=kt>int</span>
<span class=w>    </span><span class=nx>NCells</span><span class=w>       </span><span class=kt>int</span><span class=w>   </span><span class=c1>// For PLAID centroid-based search</span>
<span class=w>    </span><span class=nx>NDocs</span><span class=w>        </span><span class=kt>int</span><span class=w>   </span><span class=c1>// Candidate docs before rescoring</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>ColBERTResult</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>           </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Score</span><span class=w>        </span><span class=kt>float32</span><span class=w>  </span><span class=c1>// MaxSim score</span>
<span class=w>    </span><span class=nx>TokenScores</span><span class=w>  </span><span class=p>[]</span><span class=nx>TokenMatch</span><span class=w>  </span><span class=c1>// Token-level matching details</span>
<span class=p>}</span>

<span class=kd>type</span><span class=w> </span><span class=nx>TokenMatch</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>QueryToken</span><span class=w>  </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>DocToken</span><span class=w>    </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Score</span><span class=w>       </span><span class=kt>float32</span>
<span class=p>}</span>
</code></pre></div> <p><strong>Integration with Existing Libraries:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>// toolsemantic/integration.go</span>

<span class=c1>// SemanticSearcher wraps toolsearch.Searcher with semantic capabilities</span>
<span class=kd>type</span><span class=w> </span><span class=nx>SemanticSearcher</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Existing BM25 searcher</span>
<span class=w>    </span><span class=nx>bm25</span><span class=w>     </span><span class=nx>toolsearch</span><span class=p>.</span><span class=nx>Searcher</span>

<span class=w>    </span><span class=c1>// New semantic components</span>
<span class=w>    </span><span class=nx>embedder</span><span class=w>     </span><span class=nx>Embedder</span>
<span class=w>    </span><span class=nx>vectorIndex</span><span class=w>  </span><span class=nx>VectorIndex</span>
<span class=w>    </span><span class=nx>reranker</span><span class=w>     </span><span class=nx>Reranker</span>
<span class=w>    </span><span class=nx>graph</span><span class=w>        </span><span class=nx>KnowledgeGraph</span>

<span class=w>    </span><span class=c1>// Configuration</span>
<span class=w>    </span><span class=nx>config</span><span class=w>       </span><span class=nx>SemanticConfig</span>
<span class=p>}</span>

<span class=c1>// Search implements toolindex.Searcher interface</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>s</span><span class=w> </span><span class=o>*</span><span class=nx>SemanticSearcher</span><span class=p>)</span><span class=w> </span><span class=nx>Search</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>query</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>opts</span><span class=w> </span><span class=nx>toolsearch</span><span class=p>.</span><span class=nx>Options</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=nx>toolsearch</span><span class=p>.</span><span class=nx>Result</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Perform hybrid search internally</span>
<span class=w>    </span><span class=nx>hybridResults</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>hybridSearch</span><span class=p>(</span><span class=nx>ctx</span><span class=p>,</span><span class=w> </span><span class=nx>query</span><span class=p>,</span><span class=w> </span><span class=nx>HybridOptions</span><span class=p>{</span>
<span class=w>        </span><span class=nx>TopK</span><span class=p>:</span><span class=w>         </span><span class=nx>opts</span><span class=p>.</span><span class=nx>Limit</span><span class=p>,</span>
<span class=w>        </span><span class=nx>BM25Weight</span><span class=p>:</span><span class=w>   </span><span class=nx>s</span><span class=p>.</span><span class=nx>config</span><span class=p>.</span><span class=nx>BM25Weight</span><span class=p>,</span>
<span class=w>        </span><span class=nx>VectorWeight</span><span class=p>:</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>config</span><span class=p>.</span><span class=nx>VectorWeight</span><span class=p>,</span>
<span class=w>        </span><span class=nx>GraphWeight</span><span class=p>:</span><span class=w>  </span><span class=nx>s</span><span class=p>.</span><span class=nx>config</span><span class=p>.</span><span class=nx>GraphWeight</span><span class=p>,</span>
<span class=w>        </span><span class=nx>EnableReranker</span><span class=p>:</span><span class=w> </span><span class=nx>s</span><span class=p>.</span><span class=nx>config</span><span class=p>.</span><span class=nx>EnableReranker</span><span class=p>,</span>
<span class=w>    </span><span class=p>})</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=p>,</span><span class=w> </span><span class=nx>err</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=c1>// Convert to toolsearch.Result format</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>convertResults</span><span class=p>(</span><span class=nx>hybridResults</span><span class=p>),</span><span class=w> </span><span class=kc>nil</span>
<span class=p>}</span>

<span class=c1>// NewSemanticSearcher creates a semantic searcher that wraps BM25</span>
<span class=kd>func</span><span class=w> </span><span class=nx>NewSemanticSearcher</span><span class=p>(</span><span class=nx>bm25</span><span class=w> </span><span class=nx>toolsearch</span><span class=p>.</span><span class=nx>Searcher</span><span class=p>,</span><span class=w> </span><span class=nx>opts</span><span class=w> </span><span class=o>...</span><span class=nx>SemanticOption</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>SemanticSearcher</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// ...</span>
<span class=p>}</span>
</code></pre></div> <p><strong>Configuration Example:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># metatools.yaml</span>
<span class=nt>semantic</span><span class=p>:</span>
<span class=w>  </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class=w>  </span><span class=nt>embedder</span><span class=p>:</span>
<span class=w>    </span><span class=nt>provider</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">openai</span>
<span class=w>    </span><span class=nt>model</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">text-embedding-3-small</span>
<span class=w>    </span><span class=nt>dimensions</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1536</span>

<span class=w>  </span><span class=nt>vector_index</span><span class=p>:</span>
<span class=w>    </span><span class=nt>backend</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">memory</span><span class=w>  </span><span class=c1># memory, faiss, qdrant, chromadb</span>
<span class=w>    </span><span class=nt>metric</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cosine</span>
<span class=w>    </span><span class=nt>index_type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">hnsw</span>
<span class=w>    </span><span class=nt>hnsw</span><span class=p>:</span>
<span class=w>      </span><span class=nt>m</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">16</span>
<span class=w>      </span><span class=nt>ef_construction</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">200</span>
<span class=w>      </span><span class=nt>ef_search</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">100</span>

<span class=w>  </span><span class=nt>hybrid</span><span class=p>:</span>
<span class=w>    </span><span class=nt>bm25_weight</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0.4</span>
<span class=w>    </span><span class=nt>vector_weight</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0.5</span>
<span class=w>    </span><span class=nt>graph_weight</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0.1</span>
<span class=w>    </span><span class=nt>fusion_method</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rrf</span>

<span class=w>  </span><span class=nt>reranker</span><span class=p>:</span>
<span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class=w>    </span><span class=nt>provider</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cohere</span>
<span class=w>    </span><span class=nt>model</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">rerank-english-v3.0</span>
<span class=w>    </span><span class=nt>top_k</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">20</span>

<span class=w>  </span><span class=nt>graph</span><span class=p>:</span>
<span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class=w>  </span><span class=c1># Experimental</span>
<span class=w>    </span><span class=nt>entity_types</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">[</span><span class=s>&quot;tool&quot;</span><span class="p p-Indicator">,</span><span class=w> </span><span class=s>&quot;namespace&quot;</span><span class="p p-Indicator">,</span><span class=w> </span><span class=s>&quot;concept&quot;</span><span class="p p-Indicator">]</span>

<span class=w>  </span><span class=nt>agentic</span><span class=p>:</span>
<span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class=w>  </span><span class=c1># Experimental</span>
<span class=w>    </span><span class=nt>query_expansion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class=w>    </span><span class=nt>max_iterations</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
</code></pre></div> <p><strong>Performance Characteristics:</strong></p> <table> <thead> <tr> <th>Component</th> <th>Latency</th> <th>Memory</th> <th>Accuracy Impact</th> </tr> </thead> <tbody> <tr> <td>BM25 (baseline)</td> <td>~8ms</td> <td>Low</td> <td>Baseline (78%)</td> </tr> <tr> <td>Vector (HNSW)</td> <td>~12ms</td> <td>Medium</td> <td>+8% (86%)</td> </tr> <tr> <td>Hybrid (BM25+Vector)</td> <td>~25ms</td> <td>Medium</td> <td>+16% (94%)</td> </tr> <tr> <td>+ Reranker</td> <td>+50-100ms</td> <td>Low</td> <td>+3% (97%)</td> </tr> <tr> <td>+ GraphRAG</td> <td>+100-200ms</td> <td>High</td> <td>+2% (context)</td> </tr> <tr> <td>+ Agentic</td> <td>+500-2000ms</td> <td>Low</td> <td>Variable</td> </tr> </tbody> </table> <p><strong>Research-Based Accuracy Benchmarks (Tool Discovery):</strong></p> <table> <thead> <tr> <th>Method</th> <th>Accuracy @ 50 tools</th> <th>@ 200 tools</th> <th>@ 500 tools</th> </tr> </thead> <tbody> <tr> <td>BM25 only</td> <td>78%</td> <td>71%</td> <td>63%</td> </tr> <tr> <td>Vector only</td> <td>82%</td> <td>76%</td> <td>69%</td> </tr> <tr> <td>Hybrid (BM25+Vector)</td> <td>94%</td> <td>89%</td> <td>84%</td> </tr> <tr> <td>Hybrid + Reranker</td> <td>97%</td> <td>94%</td> <td>91%</td> </tr> <tr> <td>Hybrid + Reranker + Graph</td> <td>98%</td> <td>96%</td> <td>93%</td> </tr> </tbody> </table> <p><strong>Edge Cases:</strong></p> <ul> <li>[ ] Empty embedding: reject with ErrEmptyInput</li> <li>[ ] Dimension mismatch: validate at index time</li> <li>[ ] Reranker timeout: fall back to hybrid-only results</li> <li>[ ] Graph disconnected: handle isolated entities</li> <li>[ ] Query expansion loop: max iteration limit</li> <li>[ ] OOM on large indices: streaming/pagination support</li> </ul> <hr> <h3 id=stream-e-agent-skills>Stream E: Agent Skills<a class=headerlink href=#stream-e-agent-skills title="Permanent link">&para;</a></h3> <p><strong>Goal</strong>: Higher-level agent capabilities that compose tools into reusable workflows and behaviors.</p> <blockquote> <p><strong>Design Insight</strong>: Skills sit above tools in the abstraction hierarchy. While tools are atomic operations (search, execute, describe), skills are reusable agent behaviors that orchestrate multiple tools (research-and-summarize, debug-and-fix, deploy-with-validation).</p> </blockquote> <table> <thead> <tr> <th>Phase</th> <th>Work Package</th> <th>Duration</th> <th>Deliverables</th> </tr> </thead> <tbody> <tr> <td>E1</td> <td>Skill Core</td> <td>2 weeks</td> <td>Skill interface, registry, manifest</td> </tr> <tr> <td>E2</td> <td>Skill Composition</td> <td>1 week</td> <td>Workflow DSL, step orchestration</td> </tr> <tr> <td>E3</td> <td>Skill Execution</td> <td>1 week</td> <td>Runtime, context propagation, rollback</td> </tr> </tbody> </table> <p><strong>Total: 4 weeks</strong> (can start after Stream B Protocol Layer)</p> <h4 id=abstraction-hierarchy>Abstraction Hierarchy<a class=headerlink href=#abstraction-hierarchy title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code>┌─────────────────────────────────────────────────────────────┐
│                        AGENTS                                │
│  (Autonomous decision makers: Claude, GPT, custom agents)   │
└────────────────────────────┬────────────────────────────────┘
                             │ use
                             ▼
┌─────────────────────────────────────────────────────────────┐
│                        SKILLS (NEW)                          │
│  Higher-level behaviors: research, debug, deploy, review    │
│  Composed from multiple tools with workflow logic           │
└────────────────────────────┬────────────────────────────────┘
                             │ orchestrate
                             ▼
┌─────────────────────────────────────────────────────────────┐
│                        TOOLSETS                              │
│  Curated tool collections: dev-tools, search-tools          │
│  Filtered by namespace, tags, access policy                 │
└────────────────────────────┬────────────────────────────────┘
                             │ contain
                             ▼
┌─────────────────────────────────────────────────────────────┐
│                         TOOLS                                │
│  Atomic operations: search_tools, run_tool, describe_tool   │
│  Single-purpose, composable primitives                      │
└─────────────────────────────────────────────────────────────┘
</code></pre></div> <h4 id=e1-skill-core-2-weeks>E1: Skill Core (2 weeks)<a class=headerlink href=#e1-skill-core-2-weeks title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code>Week 18:
├── Day 1-2: Skill interface definition
├── Day 3-4: SkillManifest type (A2A-aligned)
├── Day 5: SkillRegistry implementation

Week 19:
├── Day 1-2: Skill discovery and advertisement
├── Day 3-4: Skill versioning integration
├── Day 5: Unit tests, documentation
</code></pre></div> <p><strong>Interface Contract:</strong> <div class=highlight><pre><span></span><code><span class=c1>// toolskill/skill.go</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Skill</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Identity</span>
<span class=w>    </span><span class=nx>ID</span><span class=p>()</span><span class=w> </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Name</span><span class=p>()</span><span class=w> </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Version</span><span class=p>()</span><span class=w> </span><span class=nx>semver</span><span class=p>.</span><span class=nx>Version</span>

<span class=w>    </span><span class=c1>// Manifest for discovery/advertisement</span>
<span class=w>    </span><span class=nx>Manifest</span><span class=p>()</span><span class=w> </span><span class=o>*</span><span class=nx>SkillManifest</span>

<span class=w>    </span><span class=c1>// Execution</span>
<span class=w>    </span><span class=nx>Execute</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>input</span><span class=w> </span><span class=nx>SkillInput</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>SkillOutput</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>

<span class=w>    </span><span class=c1>// Introspection</span>
<span class=w>    </span><span class=nx>RequiredTools</span><span class=p>()</span><span class=w> </span><span class=p>[]</span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Steps</span><span class=p>()</span><span class=w> </span><span class=p>[]</span><span class=nx>StepDefinition</span>
<span class=p>}</span>

<span class=c1>// SkillManifest describes skill capabilities (A2A-aligned)</span>
<span class=kd>type</span><span class=w> </span><span class=nx>SkillManifest</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>          </span><span class=kt>string</span><span class=w>            </span><span class=s>`json:&quot;id&quot;`</span>
<span class=w>    </span><span class=nx>Name</span><span class=w>        </span><span class=kt>string</span><span class=w>            </span><span class=s>`json:&quot;name&quot;`</span>
<span class=w>    </span><span class=nx>Version</span><span class=w>     </span><span class=kt>string</span><span class=w>            </span><span class=s>`json:&quot;version&quot;`</span>
<span class=w>    </span><span class=nx>Description</span><span class=w> </span><span class=kt>string</span><span class=w>            </span><span class=s>`json:&quot;description&quot;`</span>
<span class=w>    </span><span class=nx>InputSchema</span><span class=w> </span><span class=o>*</span><span class=nx>jsonschema</span><span class=p>.</span><span class=nx>Schema</span><span class=w> </span><span class=s>`json:&quot;inputSchema&quot;`</span>
<span class=w>    </span><span class=nx>OutputSchema</span><span class=w> </span><span class=o>*</span><span class=nx>jsonschema</span><span class=p>.</span><span class=nx>Schema</span><span class=w> </span><span class=s>`json:&quot;outputSchema,omitempty&quot;`</span>
<span class=w>    </span><span class=nx>Tags</span><span class=w>        </span><span class=p>[]</span><span class=kt>string</span><span class=w>          </span><span class=s>`json:&quot;tags&quot;`</span>

<span class=w>    </span><span class=c1>// Dependencies</span>
<span class=w>    </span><span class=nx>RequiredTools</span><span class=w> </span><span class=p>[]</span><span class=kt>string</span><span class=w>        </span><span class=s>`json:&quot;requiredTools&quot;`</span>
<span class=w>    </span><span class=nx>RequiredSkills</span><span class=w> </span><span class=p>[]</span><span class=kt>string</span><span class=w>       </span><span class=s>`json:&quot;requiredSkills,omitempty&quot;`</span>

<span class=w>    </span><span class=c1>// Execution hints</span>
<span class=w>    </span><span class=nx>EstimatedSteps</span><span class=w> </span><span class=kt>int</span><span class=w>            </span><span class=s>`json:&quot;estimatedSteps&quot;`</span>
<span class=w>    </span><span class=nx>Idempotent</span><span class=w>     </span><span class=kt>bool</span><span class=w>           </span><span class=s>`json:&quot;idempotent&quot;`</span>
<span class=w>    </span><span class=nx>SupportsPause</span><span class=w>  </span><span class=kt>bool</span><span class=w>           </span><span class=s>`json:&quot;supportsPause&quot;`</span>
<span class=p>}</span>

<span class=c1>// SkillRegistry manages skill discovery and lookup</span>
<span class=kd>type</span><span class=w> </span><span class=nx>SkillRegistry</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Register</span><span class=p>(</span><span class=nx>skill</span><span class=w> </span><span class=nx>Skill</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>
<span class=w>    </span><span class=nx>Get</span><span class=p>(</span><span class=nx>id</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=nx>Skill</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=w>    </span><span class=nx>GetByName</span><span class=p>(</span><span class=nx>name</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>versionConstraint</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=nx>Skill</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=w>    </span><span class=nx>List</span><span class=p>()</span><span class=w> </span><span class=p>[]</span><span class=nx>SkillManifest</span>
<span class=w>    </span><span class=nx>ListByTag</span><span class=p>(</span><span class=nx>tag</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>[]</span><span class=nx>SkillManifest</span>
<span class=w>    </span><span class=nx>Unregister</span><span class=p>(</span><span class=nx>id</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>

<span class=w>    </span><span class=c1>// Discovery for A2A</span>
<span class=w>    </span><span class=nx>Advertise</span><span class=p>()</span><span class=w> </span><span class=p>[]</span><span class=nx>SkillManifest</span>
<span class=p>}</span>
</code></pre></div></p> <p><strong>Design Patterns from Research:</strong></p> <table> <thead> <tr> <th>Framework</th> <th>Pattern</th> <th>Adaptation for toolskill</th> </tr> </thead> <tbody> <tr> <td>LangChain</td> <td>Chains (sequential)</td> <td><code>SequentialSkill</code> with steps</td> </tr> <tr> <td>LangChain</td> <td>Agents (decision)</td> <td><code>AdaptiveSkill</code> with branching</td> </tr> <tr> <td>CrewAI</td> <td>Crews (role-based)</td> <td><code>CompositeSkill</code> with sub-skills</td> </tr> <tr> <td>CrewAI</td> <td>Flows (control)</td> <td><code>WorkflowSkill</code> with explicit flow</td> </tr> <tr> <td>AutoGen</td> <td>Conversation</td> <td><code>ConversationalSkill</code> with memory</td> </tr> </tbody> </table> <h4 id=skillmd-standard-format-support>SKILL.md Standard Format Support<a class=headerlink href=#skillmd-standard-format-support title="Permanent link">&para;</a></h4> <p>The toolskill library will implement the <strong>Agent Skills Open Standard</strong> (adopted by Claude Code, OpenAI Codex CLI, ChatGPT, and Google Antigravity) to ensure cross-platform compatibility.</p> <p><strong>Standard SKILL.md Structure:</strong> <div class=highlight><pre><span></span><code>---
name: skill-name-with-hyphens
description: Use when [specific triggering conditions and symptoms]
metadata:
  author: optional-author
  version: &quot;1.0.0&quot;
<span class=gu>  argument-hint: optional-hint</span>
<span class=gu>---</span>

<span class=gh># Skill Name</span>

<span class=gu>## Overview</span>
What is this? Core principle in 1-2 sentences.

<span class=gu>## When to Use</span>
Symptoms and use cases.

<span class=gu>## How It Works</span>
Step-by-step process.

[Additional sections as needed]
</code></pre></div></p> <p><strong>Standard Directory Structure:</strong> <div class=highlight><pre><span></span><code>skills/
  skill-name/
    SKILL.md              # Main entry point (required)
    references/           # Optional supporting files
      summary.md
      files.md
    scripts/              # Optional executable tools
      validate.sh
</code></pre></div></p> <p><strong>Discovery Locations (Claude Code compatible):</strong> - User settings: <code>~/.claude/skills/</code> or <code>~/.config/claude/skills/</code> - Project settings: <code>.claude/skills/</code> - Plugin-provided: <code>plugins/*/skills/</code> - Nested directories: Automatic discovery in subdirectories</p> <p><strong>Interface Contract for SKILL.md Parsing:</strong> <div class=highlight><pre><span></span><code><span class=c1>// toolskill/skillmd/parser.go</span>

<span class=c1>// SkillMD represents a parsed SKILL.md file</span>
<span class=kd>type</span><span class=w> </span><span class=nx>SkillMD</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// YAML Frontmatter</span>
<span class=w>    </span><span class=nx>Name</span><span class=w>        </span><span class=kt>string</span><span class=w>            </span><span class=s>`yaml:&quot;name&quot;`</span>
<span class=w>    </span><span class=nx>Description</span><span class=w> </span><span class=kt>string</span><span class=w>            </span><span class=s>`yaml:&quot;description&quot;`</span>
<span class=w>    </span><span class=nx>License</span><span class=w>     </span><span class=kt>string</span><span class=w>            </span><span class=s>`yaml:&quot;license,omitempty&quot;`</span>
<span class=w>    </span><span class=nx>Metadata</span><span class=w>    </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span><span class=w>    </span><span class=s>`yaml:&quot;metadata,omitempty&quot;`</span>

<span class=w>    </span><span class=c1>// Parsed Content</span>
<span class=w>    </span><span class=nx>Content</span><span class=w>     </span><span class=kt>string</span><span class=w>            </span><span class=c1>// Raw markdown content</span>
<span class=w>    </span><span class=nx>Overview</span><span class=w>    </span><span class=kt>string</span><span class=w>            </span><span class=c1>// Extracted ## Overview section</span>
<span class=w>    </span><span class=nx>WhenToUse</span><span class=w>   </span><span class=kt>string</span><span class=w>            </span><span class=c1>// Extracted ## When to Use section</span>
<span class=w>    </span><span class=nx>HowItWorks</span><span class=w>  </span><span class=kt>string</span><span class=w>            </span><span class=c1>// Extracted ## How It Works section</span>
<span class=w>    </span><span class=nx>Sections</span><span class=w>    </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span><span class=w> </span><span class=c1>// All other sections</span>
<span class=p>}</span>

<span class=c1>// Parser reads and parses SKILL.md files</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Parser</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Parse</span><span class=p>(</span><span class=nx>path</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>SkillMD</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=w>    </span><span class=nx>ParseBytes</span><span class=p>(</span><span class=nx>data</span><span class=w> </span><span class=p>[]</span><span class=kt>byte</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>SkillMD</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=w>    </span><span class=nx>Validate</span><span class=p>(</span><span class=nx>skill</span><span class=w> </span><span class=o>*</span><span class=nx>SkillMD</span><span class=p>)</span><span class=w> </span><span class=p>[]</span><span class=nx>ValidationError</span>
<span class=p>}</span>

<span class=c1>// Generator creates SKILL.md files from skills</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Generator</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Generate</span><span class=p>(</span><span class=nx>skill</span><span class=w> </span><span class=nx>Skill</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=w>    </span><span class=nx>GenerateWithTemplate</span><span class=p>(</span><span class=nx>skill</span><span class=w> </span><span class=nx>Skill</span><span class=p>,</span><span class=w> </span><span class=nx>template</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=p>}</span>

<span class=c1>// Discovery finds skills in standard locations</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Discovery</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Scan standard locations for skills</span>
<span class=w>    </span><span class=nx>ScanUserSkills</span><span class=p>()</span><span class=w> </span><span class=p>([]</span><span class=nx>SkillMD</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w>           </span><span class=c1>// ~/.claude/skills/</span>
<span class=w>    </span><span class=nx>ScanProjectSkills</span><span class=p>(</span><span class=nx>root</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=nx>SkillMD</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=c1>// .claude/skills/</span>
<span class=w>    </span><span class=nx>ScanPluginSkills</span><span class=p>(</span><span class=nx>pluginDir</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=nx>SkillMD</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>

<span class=w>    </span><span class=c1>// Watch for changes</span>
<span class=w>    </span><span class=nx>Watch</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>locations</span><span class=w> </span><span class=p>[]</span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>&lt;-</span><span class=kd>chan</span><span class=w> </span><span class=nx>SkillEvent</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div></p> <p><strong>Cross-Platform Export:</strong> <div class=highlight><pre><span></span><code><span class=c1>// toolskill/export/exporter.go</span>

<span class=kd>type</span><span class=w> </span><span class=nx>Exporter</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Export to standard SKILL.md format (Claude, Codex, ChatGPT)</span>
<span class=w>    </span><span class=nx>ToSkillMD</span><span class=p>(</span><span class=nx>skill</span><span class=w> </span><span class=nx>Skill</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>SkillMD</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>

<span class=w>    </span><span class=c1>// Export to platform-specific formats</span>
<span class=w>    </span><span class=nx>ToZIP</span><span class=p>(</span><span class=nx>skill</span><span class=w> </span><span class=nx>Skill</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w>          </span><span class=c1>// Claude/OpenAI upload</span>
<span class=w>    </span><span class=nx>ToTarGz</span><span class=p>(</span><span class=nx>skill</span><span class=w> </span><span class=nx>Skill</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=kt>byte</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w>        </span><span class=c1>// Gemini upload</span>

<span class=w>    </span><span class=c1>// Batch export</span>
<span class=w>    </span><span class=nx>ExportDirectory</span><span class=p>(</span><span class=nx>skills</span><span class=w> </span><span class=p>[]</span><span class=nx>Skill</span><span class=p>,</span><span class=w> </span><span class=nx>path</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>
<span class=p>}</span>

<span class=c1>// Import from SKILL.md files</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Importer</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Import single skill</span>
<span class=w>    </span><span class=nx>FromSkillMD</span><span class=p>(</span><span class=nx>md</span><span class=w> </span><span class=o>*</span><span class=nx>SkillMD</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=nx>Skill</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>

<span class=w>    </span><span class=c1>// Batch import from directory</span>
<span class=w>    </span><span class=nx>FromDirectory</span><span class=p>(</span><span class=nx>path</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=nx>Skill</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>

<span class=w>    </span><span class=c1>// Import from skill repository URL</span>
<span class=w>    </span><span class=nx>FromRepository</span><span class=p>(</span><span class=nx>url</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=nx>Skill</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div></p> <p><strong>Key Design Decisions:</strong></p> <ol> <li> <p><strong>Frontmatter Limited to name + description</strong>: Per standard, only these fields are guaranteed. Additional metadata is optional.</p> </li> <li> <p><strong>Description Format</strong>: Must start with "Use when..." to optimize for Claude's skill discovery algorithm.</p> </li> <li> <p><strong>Progressive Disclosure</strong>: Skills loaded on-demand based on description matching, not pre-loaded (reduces context window usage).</p> </li> <li> <p><strong>Flat Namespace</strong>: All skills in searchable namespace for discovery. No nested hierarchies.</p> </li> <li> <p><strong>Token Efficiency</strong>: Frequently-loaded skills should be &lt;200 words. Reference material in separate files.</p> </li> </ol> <h4 id=e2-skill-composition-1-week>E2: Skill Composition (1 week)<a class=headerlink href=#e2-skill-composition-1-week title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code>Week 20:
├── Day 1-2: Step definition DSL
├── Day 3: Sequential composition
├── Day 4: Parallel composition
├── Day 5: Conditional branching
</code></pre></div> <p><strong>Interface Contract:</strong> <div class=highlight><pre><span></span><code><span class=c1>// toolskill/step.go</span>
<span class=kd>type</span><span class=w> </span><span class=nx>StepDefinition</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>          </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Name</span><span class=w>        </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Tool</span><span class=w>        </span><span class=kt>string</span><span class=w>              </span><span class=c1>// Tool to execute</span>
<span class=w>    </span><span class=nx>InputMapper</span><span class=w> </span><span class=kd>func</span><span class=p>(</span><span class=nx>SkillContext</span><span class=p>)</span><span class=w> </span><span class=kt>any</span><span class=w>  </span><span class=c1>// Map skill input to tool input</span>
<span class=w>    </span><span class=nx>OutputMapper</span><span class=w> </span><span class=kd>func</span><span class=p>(</span><span class=kt>any</span><span class=p>)</span><span class=w> </span><span class=kt>any</span><span class=w>      </span><span class=c1>// Transform tool output</span>
<span class=w>    </span><span class=nx>Condition</span><span class=w>   </span><span class=kd>func</span><span class=p>(</span><span class=nx>SkillContext</span><span class=p>)</span><span class=w> </span><span class=kt>bool</span><span class=w> </span><span class=c1>// Skip if returns false</span>
<span class=w>    </span><span class=nx>OnError</span><span class=w>     </span><span class=nx>ErrorHandler</span>
<span class=p>}</span>

<span class=c1>// toolskill/builder.go</span>
<span class=kd>type</span><span class=w> </span><span class=nx>SkillBuilder</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=o>...</span><span class=w> </span><span class=p>}</span>

<span class=kd>func</span><span class=w> </span><span class=nx>NewSkillBuilder</span><span class=p>(</span><span class=nx>name</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>SkillBuilder</span>

<span class=c1>// Sequential steps</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=o>*</span><span class=nx>SkillBuilder</span><span class=p>)</span><span class=w> </span><span class=nx>Step</span><span class=p>(</span><span class=nx>name</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>tool</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>StepBuilder</span>

<span class=c1>// Parallel execution</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=o>*</span><span class=nx>SkillBuilder</span><span class=p>)</span><span class=w> </span><span class=nx>Parallel</span><span class=p>(</span><span class=nx>steps</span><span class=w> </span><span class=o>...*</span><span class=nx>StepBuilder</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>SkillBuilder</span>

<span class=c1>// Conditional branching</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=o>*</span><span class=nx>SkillBuilder</span><span class=p>)</span><span class=w> </span><span class=nx>Branch</span><span class=p>(</span><span class=nx>condition</span><span class=w> </span><span class=kd>func</span><span class=p>(</span><span class=nx>SkillContext</span><span class=p>)</span><span class=w> </span><span class=kt>bool</span><span class=p>,</span>
<span class=w>                              </span><span class=nx>ifTrue</span><span class=w> </span><span class=o>*</span><span class=nx>SkillBuilder</span><span class=p>,</span>
<span class=w>                              </span><span class=nx>ifFalse</span><span class=w> </span><span class=o>*</span><span class=nx>SkillBuilder</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>SkillBuilder</span>

<span class=c1>// Sub-skill composition</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=o>*</span><span class=nx>SkillBuilder</span><span class=p>)</span><span class=w> </span><span class=nx>UseSkill</span><span class=p>(</span><span class=nx>skillID</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>SkillBuilder</span>

<span class=c1>// Build final skill</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=o>*</span><span class=nx>SkillBuilder</span><span class=p>)</span><span class=w> </span><span class=nx>Build</span><span class=p>()</span><span class=w> </span><span class=p>(</span><span class=nx>Skill</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
</code></pre></div></p> <p><strong>Example: Research-and-Summarize Skill</strong> <div class=highlight><pre><span></span><code><span class=nx>researchSkill</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>NewSkillBuilder</span><span class=p>(</span><span class=s>&quot;research-and-summarize&quot;</span><span class=p>).</span>
<span class=w>    </span><span class=nx>WithDescription</span><span class=p>(</span><span class=s>&quot;Research a topic and provide a summary&quot;</span><span class=p>).</span>
<span class=w>    </span><span class=nx>WithInputSchema</span><span class=p>(</span><span class=nx>researchInputSchema</span><span class=p>).</span>

<span class=w>    </span><span class=c1>// Step 1: Search for relevant tools</span>
<span class=w>    </span><span class=nx>Step</span><span class=p>(</span><span class=s>&quot;discover&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;search_tools&quot;</span><span class=p>).</span>
<span class=w>        </span><span class=nx>WithInput</span><span class=p>(</span><span class=kd>func</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>SkillContext</span><span class=p>)</span><span class=w> </span><span class=kt>any</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=k>return</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span><span class=p>{</span><span class=s>&quot;query&quot;</span><span class=p>:</span><span class=w> </span><span class=nx>ctx</span><span class=p>.</span><span class=nx>Input</span><span class=p>[</span><span class=s>&quot;topic&quot;</span><span class=p>]}</span>
<span class=w>        </span><span class=p>}).</span>

<span class=w>    </span><span class=c1>// Step 2: Get documentation for top results</span>
<span class=w>    </span><span class=nx>Parallel</span><span class=p>(</span>
<span class=w>        </span><span class=nx>Step</span><span class=p>(</span><span class=s>&quot;docs-1&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;describe_tool&quot;</span><span class=p>).</span><span class=nx>WithInput</span><span class=p>(</span><span class=nx>fromResult</span><span class=p>(</span><span class=mi>0</span><span class=p>)),</span>
<span class=w>        </span><span class=nx>Step</span><span class=p>(</span><span class=s>&quot;docs-2&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;describe_tool&quot;</span><span class=p>).</span><span class=nx>WithInput</span><span class=p>(</span><span class=nx>fromResult</span><span class=p>(</span><span class=mi>1</span><span class=p>)),</span>
<span class=w>        </span><span class=nx>Step</span><span class=p>(</span><span class=s>&quot;docs-3&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;describe_tool&quot;</span><span class=p>).</span><span class=nx>WithInput</span><span class=p>(</span><span class=nx>fromResult</span><span class=p>(</span><span class=mi>2</span><span class=p>)),</span>
<span class=w>    </span><span class=p>).</span>

<span class=w>    </span><span class=c1>// Step 3: Synthesize findings</span>
<span class=w>    </span><span class=nx>Step</span><span class=p>(</span><span class=s>&quot;synthesize&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;run_tool&quot;</span><span class=p>).</span>
<span class=w>        </span><span class=nx>WithInput</span><span class=p>(</span><span class=kd>func</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>SkillContext</span><span class=p>)</span><span class=w> </span><span class=kt>any</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=k>return</span><span class=w> </span><span class=nx>synthesizeInputs</span><span class=p>(</span><span class=nx>ctx</span><span class=p>)</span>
<span class=w>        </span><span class=p>}).</span>

<span class=w>    </span><span class=nx>Build</span><span class=p>()</span>
</code></pre></div></p> <h4 id=e3-skill-execution-1-week>E3: Skill Execution (1 week)<a class=headerlink href=#e3-skill-execution-1-week title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code>Week 21:
├── Day 1-2: Skill runtime with context
├── Day 3: Progress tracking, checkpoints
├── Day 4: Rollback on failure
├── Day 5: Integration with toolobserve
</code></pre></div> <p><strong>Interface Contract:</strong> <div class=highlight><pre><span></span><code><span class=c1>// toolskill/runtime.go</span>
<span class=kd>type</span><span class=w> </span><span class=nx>SkillRuntime</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Execute</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>skill</span><span class=w> </span><span class=nx>Skill</span><span class=p>,</span><span class=w> </span><span class=nx>input</span><span class=w> </span><span class=nx>SkillInput</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>SkillOutput</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=w>    </span><span class=nx>ExecuteAsync</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>skill</span><span class=w> </span><span class=nx>Skill</span><span class=p>,</span><span class=w> </span><span class=nx>input</span><span class=w> </span><span class=nx>SkillInput</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=nx>ExecutionID</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>

<span class=w>    </span><span class=c1>// Progress and control</span>
<span class=w>    </span><span class=nx>GetStatus</span><span class=p>(</span><span class=nx>execID</span><span class=w> </span><span class=nx>ExecutionID</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>ExecutionStatus</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=w>    </span><span class=nx>Pause</span><span class=p>(</span><span class=nx>execID</span><span class=w> </span><span class=nx>ExecutionID</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>
<span class=w>    </span><span class=nx>Resume</span><span class=p>(</span><span class=nx>execID</span><span class=w> </span><span class=nx>ExecutionID</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>
<span class=w>    </span><span class=nx>Cancel</span><span class=p>(</span><span class=nx>execID</span><span class=w> </span><span class=nx>ExecutionID</span><span class=p>)</span><span class=w> </span><span class=kt>error</span>

<span class=w>    </span><span class=c1>// Checkpoints for long-running skills</span>
<span class=w>    </span><span class=nx>Checkpoint</span><span class=p>(</span><span class=nx>execID</span><span class=w> </span><span class=nx>ExecutionID</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>Checkpoint</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=w>    </span><span class=nx>RestoreFromCheckpoint</span><span class=p>(</span><span class=nx>checkpoint</span><span class=w> </span><span class=o>*</span><span class=nx>Checkpoint</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=nx>ExecutionID</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
<span class=p>}</span>

<span class=c1>// SkillContext provides execution context to steps</span>
<span class=kd>type</span><span class=w> </span><span class=nx>SkillContext</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Input</span><span class=w>      </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span><span class=w>      </span><span class=c1>// Original skill input</span>
<span class=w>    </span><span class=nx>Results</span><span class=w>    </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span><span class=w>      </span><span class=c1>// Results from previous steps</span>
<span class=w>    </span><span class=nx>Metadata</span><span class=w>   </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span><span class=w>      </span><span class=c1>// Execution metadata</span>
<span class=w>    </span><span class=nx>Toolset</span><span class=w>    </span><span class=o>*</span><span class=nx>toolset</span><span class=p>.</span><span class=nx>Toolset</span><span class=w>    </span><span class=c1>// Available tools</span>
<span class=w>    </span><span class=nx>Logger</span><span class=w>     </span><span class=nx>Logger</span><span class=w>              </span><span class=c1>// Structured logging</span>
<span class=w>    </span><span class=nx>Tracer</span><span class=w>     </span><span class=nx>trace</span><span class=p>.</span><span class=nx>Tracer</span><span class=w>        </span><span class=c1>// OpenTelemetry tracing</span>
<span class=p>}</span>

<span class=c1>// ExecutionStatus tracks skill progress</span>
<span class=kd>type</span><span class=w> </span><span class=nx>ExecutionStatus</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>            </span><span class=nx>ExecutionID</span>
<span class=w>    </span><span class=nx>SkillID</span><span class=w>       </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>State</span><span class=w>         </span><span class=nx>ExecutionState</span><span class=w>  </span><span class=c1>// pending, running, paused, completed, failed</span>
<span class=w>    </span><span class=nx>CurrentStep</span><span class=w>   </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>CompletedSteps</span><span class=w> </span><span class=p>[]</span><span class=kt>string</span>
<span class=w>    </span><span class=nx>Progress</span><span class=w>      </span><span class=kt>float64</span><span class=w>         </span><span class=c1>// 0.0 to 1.0</span>
<span class=w>    </span><span class=nx>StartedAt</span><span class=w>     </span><span class=nx>time</span><span class=p>.</span><span class=nx>Time</span>
<span class=w>    </span><span class=nx>Error</span><span class=w>         </span><span class=kt>error</span>
<span class=p>}</span>
</code></pre></div></p> <p><strong>Edge Cases:</strong> - [ ] Step timeout: configurable per-step, fail or skip - [ ] Tool not found: fail skill with ErrMissingTool - [ ] Parallel step failure: configurable (fail-fast or continue) - [ ] Checkpoint restore: validate skill version compatibility - [ ] Circular skill dependencies: detect and reject at registration</p> <h4 id=skill-tool-integration>Skill-Tool Integration<a class=headerlink href=#skill-tool-integration title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><span class=c1>// Expose skills via MCP as special tools</span>
<span class=kd>type</span><span class=w> </span><span class=nx>SkillToolProvider</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>registry</span><span class=w> </span><span class=nx>SkillRegistry</span>
<span class=w>    </span><span class=nx>runtime</span><span class=w>  </span><span class=nx>SkillRuntime</span>
<span class=p>}</span>

<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>p</span><span class=w> </span><span class=o>*</span><span class=nx>SkillToolProvider</span><span class=p>)</span><span class=w> </span><span class=nx>Tools</span><span class=p>()</span><span class=w> </span><span class=p>[]</span><span class=o>*</span><span class=nx>mcp</span><span class=p>.</span><span class=nx>Tool</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>var</span><span class=w> </span><span class=nx>tools</span><span class=w> </span><span class=p>[]</span><span class=o>*</span><span class=nx>mcp</span><span class=p>.</span><span class=nx>Tool</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>manifest</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>range</span><span class=w> </span><span class=nx>p</span><span class=p>.</span><span class=nx>registry</span><span class=p>.</span><span class=nx>List</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>tools</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nb>append</span><span class=p>(</span><span class=nx>tools</span><span class=p>,</span><span class=w> </span><span class=o>&amp;</span><span class=nx>mcp</span><span class=p>.</span><span class=nx>Tool</span><span class=p>{</span>
<span class=w>            </span><span class=nx>Name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;skill:&quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>manifest</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span>
<span class=w>            </span><span class=nx>Description</span><span class=p>:</span><span class=w> </span><span class=s>&quot;[SKILL] &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nx>manifest</span><span class=p>.</span><span class=nx>Description</span><span class=p>,</span>
<span class=w>            </span><span class=nx>InputSchema</span><span class=p>:</span><span class=w> </span><span class=nx>manifest</span><span class=p>.</span><span class=nx>InputSchema</span><span class=p>,</span>
<span class=w>        </span><span class=p>})</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>tools</span>
<span class=p>}</span>
</code></pre></div> <p><strong>MCP Tool Naming Convention:</strong> - Regular tools: <code>search_tools</code>, <code>run_tool</code> - Skills: <code>skill:research</code>, <code>skill:debug</code>, <code>skill:deploy</code></p> <hr> <h2 id=4-phase-breakdown>4. Phase Breakdown<a class=headerlink href=#4-phase-breakdown title="Permanent link">&para;</a></h2> <h3 id=phase-1-mvp-core-weeks-1-7>Phase 1: MVP Core (Weeks 1-7)<a class=headerlink href=#phase-1-mvp-core-weeks-1-7 title="Permanent link">&para;</a></h3> <p><strong>Deliverables:</strong> - [x] Cobra CLI framework - [x] Koanf configuration - [x] Transport abstraction (stdio, SSE, HTTP) - [x] Provider registry - [x] Basic backend registry</p> <p><strong>Success Criteria:</strong> - <code>metatools serve --config config.yaml</code> starts HTTP server - All 13 extension points configurable via YAML - Backward compatible with existing <code>metatools</code> usage</p> <h3 id=phase-2-protocol-layer-weeks-8-14>Phase 2: Protocol Layer (Weeks 8-14)<a class=headerlink href=#phase-2-protocol-layer-weeks-8-14 title="Permanent link">&para;</a></h3> <p><strong>Deliverables:</strong> - [ ] tooladapter library - [ ] toolset library - [ ] Multi-transport exposure</p> <p><strong>Success Criteria:</strong> - Tools convertible between MCP ↔ OpenAI ↔ Anthropic - Composable toolsets via builder pattern - Same tools exposed via MCP and REST</p> <h3 id=phase-3-cross-cutting-weeks-8-17-parallel>Phase 3: Cross-Cutting (Weeks 8-17, parallel)<a class=headerlink href=#phase-3-cross-cutting-weeks-8-17-parallel title="Permanent link">&para;</a></h3> <p><strong>Deliverables:</strong> - [ ] toolcache (memory, Redis, layered) - [ ] toolobserve (OpenTelemetry) - [ ] toolversion (semantic versioning) - [ ] toolresilience (circuit breaker, retry) - [ ] toolhealth, toolaudit, toolsecrets</p> <p><strong>Success Criteria:</strong> - All tool calls traced via OpenTelemetry - Circuit breaker protects against cascade failures - Comprehensive audit log for compliance</p> <h3 id=phase-4-enterprise-weeks-12-17-parallel>Phase 4: Enterprise (Weeks 12-17, parallel)<a class=headerlink href=#phase-4-enterprise-weeks-12-17-parallel title="Permanent link">&para;</a></h3> <p><strong>Deliverables:</strong> - [ ] Multi-tenancy (resolvers, middleware, storage) - [ ] toolsemantic (vector search) - [ ] toolresource (MCP Resources) - [ ] toolgateway (auth proxy)</p> <p><strong>Success Criteria:</strong> - Multiple tenants isolated by configuration - Semantic search improves tool discovery accuracy - OAuth 2.1 authentication via gateway</p> <h3 id=phase-5-agent-skills-weeks-18-21>Phase 5: Agent Skills (Weeks 18-21)<a class=headerlink href=#phase-5-agent-skills-weeks-18-21 title="Permanent link">&para;</a></h3> <p><strong>Deliverables:</strong> - [ ] toolskill library (skill interface, registry, manifest) - [ ] Skill composition DSL (sequential, parallel, branching) - [ ] Skill runtime (execution, checkpoints, rollback) - [ ] A2A skill advertisement integration</p> <p><strong>Success Criteria:</strong> - Skills discoverable via SkillRegistry.Advertise() - Multi-step skills execute with progress tracking - Skills exposed as MCP tools with <code>skill:</code> prefix - Checkpoint/restore enables long-running skill recovery</p> <p><strong>Dependencies:</strong> - Requires Stream B completion (toolset for tool access) - Benefits from Stream C (toolobserve for tracing)</p> <hr> <h2 id=5-interface-contracts>5. Interface Contracts<a class=headerlink href=#5-interface-contracts title="Permanent link">&para;</a></h2> <h3 id=core-interfaces-must-be-stable>Core Interfaces (Must Be Stable)<a class=headerlink href=#core-interfaces-must-be-stable title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Interface</th> <th>Library</th> <th>Breaking Change Policy</th> </tr> </thead> <tbody> <tr> <td><code>Tool</code></td> <td>toolmodel</td> <td>MAJOR version bump</td> </tr> <tr> <td><code>Index</code></td> <td>toolindex</td> <td>MAJOR version bump</td> </tr> <tr> <td><code>Searcher</code></td> <td>toolindex</td> <td>MINOR (additive only)</td> </tr> <tr> <td><code>Store</code></td> <td>tooldocs</td> <td>MINOR (additive only)</td> </tr> <tr> <td><code>Runner</code></td> <td>toolrun</td> <td>MAJOR version bump</td> </tr> <tr> <td><code>Backend</code></td> <td>toolruntime</td> <td>MINOR (additive only)</td> </tr> </tbody> </table> <h3 id=new-interfaces-design-phase>New Interfaces (Design Phase)<a class=headerlink href=#new-interfaces-design-phase title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Interface</th> <th>Library</th> <th>Status</th> <th>Review Required</th> </tr> </thead> <tbody> <tr> <td><code>Transport</code></td> <td>metatools</td> <td>Draft</td> <td>Architecture</td> </tr> <tr> <td><code>ToolProvider</code></td> <td>metatools</td> <td>Draft</td> <td>Architecture</td> </tr> <tr> <td><code>BackendRegistry</code></td> <td>metatools</td> <td>Draft</td> <td>Architecture</td> </tr> <tr> <td><code>Adapter</code></td> <td>tooladapter</td> <td>Draft</td> <td>Protocol Team</td> </tr> <tr> <td><code>Cache</code></td> <td>toolcache</td> <td>Draft</td> <td>Infrastructure</td> </tr> <tr> <td><code>Observer</code></td> <td>toolobserve</td> <td>Draft</td> <td>SRE Team</td> </tr> <tr> <td><code>Skill</code></td> <td>toolskill</td> <td>Draft</td> <td>Agent Team</td> </tr> <tr> <td><code>SkillRegistry</code></td> <td>toolskill</td> <td>Draft</td> <td>Agent Team</td> </tr> <tr> <td><code>SkillRuntime</code></td> <td>toolskill</td> <td>Draft</td> <td>Agent Team</td> </tr> <tr> <td><code>Embedder</code></td> <td>toolsemantic</td> <td>Draft</td> <td>ML/Search Team</td> </tr> <tr> <td><code>VectorIndex</code></td> <td>toolsemantic</td> <td>Draft</td> <td>ML/Search Team</td> </tr> <tr> <td><code>HybridSearcher</code></td> <td>toolsemantic</td> <td>Draft</td> <td>ML/Search Team</td> </tr> <tr> <td><code>Reranker</code></td> <td>toolsemantic</td> <td>Draft</td> <td>ML/Search Team</td> </tr> <tr> <td><code>KnowledgeGraph</code></td> <td>toolsemantic</td> <td>Draft</td> <td>ML/Search Team</td> </tr> <tr> <td><code>AgenticRetriever</code></td> <td>toolsemantic</td> <td>Draft</td> <td>ML/Search Team</td> </tr> </tbody> </table> <hr> <h2 id=6-edge-cases-considerations>6. Edge Cases &amp; Considerations<a class=headerlink href=#6-edge-cases-considerations title="Permanent link">&para;</a></h2> <h3 id=interface-evolution>Interface Evolution<a class=headerlink href=#interface-evolution title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Scenario</th> <th>Strategy</th> </tr> </thead> <tbody> <tr> <td>Add optional field</td> <td>MINOR bump, backward compatible</td> </tr> <tr> <td>Add required field</td> <td>MAJOR bump, migration guide</td> </tr> <tr> <td>Remove field</td> <td>Deprecate → 2 releases → remove</td> </tr> <tr> <td>Change field type</td> <td>Never (create new field)</td> </tr> </tbody> </table> <h3 id=error-handling>Error Handling<a class=headerlink href=#error-handling title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Error Type</th> <th>HTTP Code</th> <th>MCP Error Code</th> <th>Retry?</th> </tr> </thead> <tbody> <tr> <td>Tool not found</td> <td>404</td> <td>-32601</td> <td>No</td> </tr> <tr> <td>Invalid input</td> <td>400</td> <td>-32602</td> <td>No</td> </tr> <tr> <td>Backend timeout</td> <td>504</td> <td>-32603</td> <td>Yes</td> </tr> <tr> <td>Rate limited</td> <td>429</td> <td>-32603</td> <td>Yes (with backoff)</td> </tr> <tr> <td>Circuit open</td> <td>503</td> <td>-32603</td> <td>Yes (after reset)</td> </tr> <tr> <td>Internal error</td> <td>500</td> <td>-32603</td> <td>Maybe</td> </tr> </tbody> </table> <h3 id=concurrency>Concurrency<a class=headerlink href=#concurrency title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Component</th> <th>Concurrency Model</th> <th>Lock Granularity</th> </tr> </thead> <tbody> <tr> <td>Provider Registry</td> <td>RWMutex</td> <td>Per-registry</td> </tr> <tr> <td>Backend Registry</td> <td>RWMutex</td> <td>Per-registry</td> </tr> <tr> <td>Cache</td> <td>Per-key locking</td> <td>Key-level</td> </tr> <tr> <td>Circuit Breaker</td> <td>Atomic counters</td> <td>Per-breaker</td> </tr> <tr> <td>Tenant Store</td> <td>RWMutex</td> <td>Per-tenant</td> </tr> <tr> <td>Skill Registry</td> <td>RWMutex</td> <td>Per-registry</td> </tr> <tr> <td>Skill Runtime</td> <td>Per-execution</td> <td>Execution-level</td> </tr> </tbody> </table> <h3 id=resource-limits>Resource Limits<a class=headerlink href=#resource-limits title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Resource</th> <th>Default</th> <th>Configurable</th> <th>Enforcement</th> </tr> </thead> <tbody> <tr> <td>Max tools per backend</td> <td>1000</td> <td>Yes</td> <td>Registration fails</td> </tr> <tr> <td>Max concurrent requests</td> <td>100</td> <td>Yes</td> <td>503 response</td> </tr> <tr> <td>Max request size</td> <td>10MB</td> <td>Yes</td> <td>413 response</td> </tr> <tr> <td>Tool execution timeout</td> <td>30s</td> <td>Per-tool</td> <td>Context cancellation</td> </tr> <tr> <td>Cache entry size</td> <td>1MB</td> <td>Yes</td> <td>Reject large entries</td> </tr> </tbody> </table> <hr> <h2 id=7-rollout-strategy>7. Rollout Strategy<a class=headerlink href=#7-rollout-strategy title="Permanent link">&para;</a></h2> <h3 id=version-compatibility-matrix>Version Compatibility Matrix<a class=headerlink href=#version-compatibility-matrix title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>metatools</th> <th>toolmodel</th> <th>toolindex</th> <th>toolrun</th> <th>tooladapter</th> <th>toolskill</th> </tr> </thead> <tbody> <tr> <td>v0.2.x</td> <td>v0.1.2+</td> <td>v0.1.8+</td> <td>v0.1.9+</td> <td>-</td> <td>-</td> </tr> <tr> <td>v0.3.x</td> <td>v0.2.0+</td> <td>v0.2.0+</td> <td>v0.2.0+</td> <td>v1.0.0+</td> <td>-</td> </tr> <tr> <td>v1.0.x</td> <td>v0.2.0+</td> <td>v0.2.0+</td> <td>v0.2.0+</td> <td>v1.0.0+</td> <td>-</td> </tr> <tr> <td>v1.1.x</td> <td>v0.2.0+</td> <td>v0.2.0+</td> <td>v0.2.0+</td> <td>v1.0.0+</td> <td>v1.0.0+</td> </tr> </tbody> </table> <h3 id=release-cadence>Release Cadence<a class=headerlink href=#release-cadence title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Track</th> <th>Frequency</th> <th>Stability</th> <th>Use Case</th> </tr> </thead> <tbody> <tr> <td><strong>stable</strong></td> <td>Monthly</td> <td>Production</td> <td>Enterprise</td> </tr> <tr> <td><strong>beta</strong></td> <td>Bi-weekly</td> <td>Testing</td> <td>Early adopters</td> </tr> <tr> <td><strong>nightly</strong></td> <td>Daily</td> <td>Development</td> <td>Contributors</td> </tr> </tbody> </table> <h3 id=migration-guides>Migration Guides<a class=headerlink href=#migration-guides title="Permanent link">&para;</a></h3> <p>Each MAJOR version bump requires: 1. <strong>Migration guide</strong> with step-by-step instructions 2. <strong>Codemods</strong> where possible (automated refactoring) 3. <strong>Deprecation period</strong> (minimum 2 minor versions) 4. <strong>Backward compatibility layer</strong> (optional, time-limited)</p> <h3 id=feature-flags-for-rollout>Feature Flags for Rollout<a class=headerlink href=#feature-flags-for-rollout title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=nt>feature_flags</span><span class=p>:</span>
<span class=w>  </span><span class=nt>new_transport_layer</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class=w>      </span><span class=c1># Phase 2</span>
<span class=w>  </span><span class=nt>protocol_adapters</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class=w>       </span><span class=c1># Phase 3 (beta)</span>
<span class=w>  </span><span class=nt>semantic_search</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class=w>         </span><span class=c1># Phase 4 (alpha)</span>
<span class=w>  </span><span class=nt>multi_tenancy</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class=w>           </span><span class=c1># Phase 4 (alpha)</span>
<span class=w>  </span><span class=nt>agent_skills</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class=w>            </span><span class=c1># Phase 5 (alpha)</span>
</code></pre></div> <hr> <h2 id=8-multi-language-extensibility>8. Multi-Language Extensibility<a class=headerlink href=#8-multi-language-extensibility title="Permanent link">&para;</a></h2> <blockquote> <p><strong>Design Principle</strong>: The pluggable architecture is not limited to Go implementations. Any component can be replaced by implementations written in <strong>any programming language</strong> through standardized interface contracts.</p> </blockquote> <h3 id=why-multi-language-matters>Why Multi-Language Matters<a class=headerlink href=#why-multi-language-matters title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Use Case</th> <th>Language</th> <th>Rationale</th> </tr> </thead> <tbody> <tr> <td>ML/Embedding Models</td> <td><strong>Python</strong></td> <td>Rich ML ecosystem (PyTorch, transformers, sentence-transformers)</td> </tr> <tr> <td>High-Performance Retrieval</td> <td><strong>Rust</strong></td> <td>Memory safety + near-C performance for vector operations</td> </tr> <tr> <td>Enterprise Integrations</td> <td><strong>Java</strong></td> <td>Existing corporate libraries, Spring ecosystem</td> </tr> <tr> <td>Rapid Prototyping</td> <td><strong>TypeScript</strong></td> <td>Fast iteration, existing MCP server implementations</td> </tr> <tr> <td>Edge Deployment</td> <td><strong>WASM</strong></td> <td>Sandboxed, portable, language-agnostic runtime</td> </tr> </tbody> </table> <h3 id=interface-contract-technologies>Interface Contract Technologies<a class=headerlink href=#interface-contract-technologies title="Permanent link">&para;</a></h3> <p>The architecture supports <strong>three proven approaches</strong> for multi-language interoperability:</p> <h4 id=option-1-grpc-protocol-buffers-recommended>Option 1: gRPC + Protocol Buffers (Recommended)<a class=headerlink href=#option-1-grpc-protocol-buffers-recommended title="Permanent link">&para;</a></h4> <p><strong>Battle-tested approach used by HashiCorp (Terraform, Vault, Consul, Packer).</strong></p> <div class=highlight><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────────────────┐
│                            METATOOLS CORE (Go)                                   │
│                                                                                  │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │                     Plugin Host (go-plugin style)                        │   │
│   │   - Launches plugins as subprocesses                                     │   │
│   │   - Communicates via gRPC over local socket                             │   │
│   │   - Health monitoring and automatic restart                              │   │
│   │   - Graceful shutdown and resource cleanup                               │   │
│   └───────────────────────────────┬─────────────────────────────────────────┘   │
│                                   │                                              │
└───────────────────────────────────┼──────────────────────────────────────────────┘
                                    │ gRPC (protobuf)
        ┌───────────────────────────┼───────────────────────────┐
        │                           │                           │
        ▼                           ▼                           ▼
┌───────────────────┐   ┌───────────────────┐   ┌───────────────────┐
│ Python Embedder   │   │ Rust Vector Index │   │ TypeScript Adapter│
│ (sentence-bert)   │   │ (HNSW + SIMD)     │   │ (OpenAI format)   │
│                   │   │                   │   │                   │
│ pip install       │   │ cargo build       │   │ npm run build     │
│ metatools-embed   │   │ --release         │   │                   │
└───────────────────┘   └───────────────────┘   └───────────────────┘
</code></pre></div> <p><strong>Protocol Buffer Interface Definitions:</strong></p> <div class=highlight><pre><span></span><code><span class=c1>// api/proto/embedder.proto</span>
<span class=k>syntax</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;proto3&quot;</span><span class=p>;</span>
<span class=kn>package</span><span class=w> </span><span class=nn>metatools</span><span class=o>.</span><span class=n>v1</span><span class=p>;</span>

<span class=kd>service</span><span class=w> </span><span class=n>Embedder</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>rpc</span><span class=w> </span><span class=n>Embed</span><span class=p>(</span><span class=n>EmbedRequest</span><span class=p>)</span><span class=w> </span><span class=k>returns</span><span class=w> </span><span class=p>(</span><span class=n>EmbedResponse</span><span class=p>);</span>
<span class=w>  </span><span class=k>rpc</span><span class=w> </span><span class=n>EmbedBatch</span><span class=p>(</span><span class=n>EmbedBatchRequest</span><span class=p>)</span><span class=w> </span><span class=k>returns</span><span class=w> </span><span class=p>(</span><span class=n>EmbedBatchResponse</span><span class=p>);</span>
<span class=w>  </span><span class=k>rpc</span><span class=w> </span><span class=n>Info</span><span class=p>(</span><span class=n>InfoRequest</span><span class=p>)</span><span class=w> </span><span class=k>returns</span><span class=w> </span><span class=p>(</span><span class=n>EmbedderInfo</span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>message</span><span class=w> </span><span class=nc>EmbedRequest</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>string</span><span class=w> </span><span class=na>text</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=p>}</span>

<span class=kd>message</span><span class=w> </span><span class=nc>EmbedResponse</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>repeated</span><span class=w> </span><span class=kt>float</span><span class=w> </span><span class=na>embedding</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=p>}</span>

<span class=kd>message</span><span class=w> </span><span class=nc>EmbedderInfo</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>string</span><span class=w> </span><span class=na>model</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>  </span><span class=kt>int32</span><span class=w> </span><span class=na>dimensions</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=c1>// api/proto/searcher.proto</span>
<span class=k>syntax</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;proto3&quot;</span><span class=p>;</span>
<span class=kn>package</span><span class=w> </span><span class=nn>metatools</span><span class=o>.</span><span class=n>v1</span><span class=p>;</span>

<span class=kd>service</span><span class=w> </span><span class=n>Searcher</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=k>rpc</span><span class=w> </span><span class=n>Search</span><span class=p>(</span><span class=n>SearchRequest</span><span class=p>)</span><span class=w> </span><span class=k>returns</span><span class=w> </span><span class=p>(</span><span class=n>SearchResponse</span><span class=p>);</span>
<span class=w>  </span><span class=k>rpc</span><span class=w> </span><span class=n>Index</span><span class=p>(</span><span class=n>IndexRequest</span><span class=p>)</span><span class=w> </span><span class=k>returns</span><span class=w> </span><span class=p>(</span><span class=n>IndexResponse</span><span class=p>);</span>
<span class=w>  </span><span class=k>rpc</span><span class=w> </span><span class=n>Delete</span><span class=p>(</span><span class=n>DeleteRequest</span><span class=p>)</span><span class=w> </span><span class=k>returns</span><span class=w> </span><span class=p>(</span><span class=n>DeleteResponse</span><span class=p>);</span>
<span class=p>}</span>

<span class=kd>message</span><span class=w> </span><span class=nc>SearchRequest</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>string</span><span class=w> </span><span class=na>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>  </span><span class=kt>int32</span><span class=w> </span><span class=na>top_k</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
<span class=w>  </span><span class=n>map</span><span class=p>&lt;</span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=p>&gt;</span><span class=w> </span><span class=na>filters</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>3</span><span class=p>;</span>
<span class=p>}</span>

<span class=kd>message</span><span class=w> </span><span class=nc>SearchResult</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kt>string</span><span class=w> </span><span class=na>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
<span class=w>  </span><span class=kt>float</span><span class=w> </span><span class=na>score</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
<span class=w>  </span><span class=kt>string</span><span class=w> </span><span class=na>content</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>3</span><span class=p>;</span>
<span class=w>  </span><span class=n>map</span><span class=p>&lt;</span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=p>&gt;</span><span class=w> </span><span class=na>metadata</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>4</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div> <p><strong>Benefits:</strong> - Language-agnostic: Generate client/server stubs for 10+ languages via <code>protoc</code> - Schema evolution: Add fields without breaking backward compatibility - High performance: Binary serialization, HTTP/2 multiplexing - Proven at scale: Used by Kubernetes, gRPC-web, many microservices</p> <p><strong>Real-World Example (HashiCorp go-plugin):</strong> <div class=highlight><pre><span></span><code><span class=c1>// Go host code (metatools)</span>
<span class=kd>type</span><span class=w> </span><span class=nx>EmbedderPlugin</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>plugin</span><span class=p>.</span><span class=nx>Plugin</span>
<span class=w>    </span><span class=nx>Impl</span><span class=w> </span><span class=nx>Embedder</span>
<span class=p>}</span>

<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>p</span><span class=w> </span><span class=o>*</span><span class=nx>EmbedderPlugin</span><span class=p>)</span><span class=w> </span><span class=nx>GRPCServer</span><span class=p>(</span><span class=nx>broker</span><span class=w> </span><span class=o>*</span><span class=nx>plugin</span><span class=p>.</span><span class=nx>GRPCBroker</span><span class=p>,</span><span class=w> </span><span class=nx>s</span><span class=w> </span><span class=o>*</span><span class=nx>grpc</span><span class=p>.</span><span class=nx>Server</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>RegisterEmbedderServer</span><span class=p>(</span><span class=nx>s</span><span class=p>,</span><span class=w> </span><span class=o>&amp;</span><span class=nx>GRPCServer</span><span class=p>{</span><span class=nx>Impl</span><span class=p>:</span><span class=w> </span><span class=nx>p</span><span class=p>.</span><span class=nx>Impl</span><span class=p>})</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span>
<span class=p>}</span>

<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>p</span><span class=w> </span><span class=o>*</span><span class=nx>EmbedderPlugin</span><span class=p>)</span><span class=w> </span><span class=nx>GRPCClient</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>broker</span><span class=w> </span><span class=o>*</span><span class=nx>plugin</span><span class=p>.</span><span class=nx>GRPCBroker</span><span class=p>,</span><span class=w> </span><span class=nx>c</span><span class=w> </span><span class=o>*</span><span class=nx>grpc</span><span class=p>.</span><span class=nx>ClientConn</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=kd>interface</span><span class=p>{},</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&amp;</span><span class=nx>GRPCClient</span><span class=p>{</span><span class=nx>client</span><span class=p>:</span><span class=w> </span><span class=nx>NewEmbedderClient</span><span class=p>(</span><span class=nx>c</span><span class=p>)},</span><span class=w> </span><span class=kc>nil</span>
<span class=p>}</span>
</code></pre></div></p> <div class=highlight><pre><span></span><code><span class=c1># Python plugin implementation</span>
<span class=k>class</span><span class=w> </span><span class=nc>PythonEmbedder</span><span class=p>(</span><span class=n>metatools_pb2_grpc</span><span class=o>.</span><span class=n>EmbedderServicer</span><span class=p>):</span>
    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>model</span> <span class=o>=</span> <span class=n>SentenceTransformer</span><span class=p>(</span><span class=s1>&#39;all-MiniLM-L6-v2&#39;</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>Embed</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>context</span><span class=p>):</span>
        <span class=n>embedding</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>model</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>metatools_pb2</span><span class=o>.</span><span class=n>EmbedResponse</span><span class=p>(</span><span class=n>embedding</span><span class=o>=</span><span class=n>embedding</span><span class=o>.</span><span class=n>tolist</span><span class=p>())</span>

    <span class=k>def</span><span class=w> </span><span class=nf>Info</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>context</span><span class=p>):</span>
        <span class=k>return</span> <span class=n>metatools_pb2</span><span class=o>.</span><span class=n>EmbedderInfo</span><span class=p>(</span>
            <span class=n>model</span><span class=o>=</span><span class=s1>&#39;all-MiniLM-L6-v2&#39;</span><span class=p>,</span>
            <span class=n>dimensions</span><span class=o>=</span><span class=mi>384</span>
        <span class=p>)</span>
</code></pre></div> <h4 id=option-2-webassembly-component-model-emerging>Option 2: WebAssembly Component Model (Emerging)<a class=headerlink href=#option-2-webassembly-component-model-emerging title="Permanent link">&para;</a></h4> <p><strong>Sandboxed, portable, no network overhead.</strong></p> <div class=highlight><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────────────────┐
│                            METATOOLS CORE (Go)                                   │
│                                                                                  │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │                     WASM Runtime (wasmtime/wasmer)                       │   │
│   │   - Load .wasm modules as plugins                                        │   │
│   │   - WebAssembly Interface Types (WIT) for type-safe boundaries          │   │
│   │   - WASI for system access (filesystem, network)                         │   │
│   │   - Strong sandbox: memory isolation, capability-based security          │   │
│   └───────────────────────────────┬─────────────────────────────────────────┘   │
│                                   │                                              │
└───────────────────────────────────┼──────────────────────────────────────────────┘
                                    │ WebAssembly Interface Types (WIT)
        ┌───────────────────────────┼───────────────────────────┐
        │                           │                           │
        ▼                           ▼                           ▼
┌───────────────────┐   ┌───────────────────┐   ┌───────────────────┐
│ Rust → WASM       │   │ Go → WASM         │   │ Python → WASM     │
│ (vector_index.wasm│   │ (adapter.wasm)    │   │ (embedder.wasm)   │
│  via wasm32-wasi) │   │  via TinyGo       │   │  via Pyodide      │
└───────────────────┘   └───────────────────┘   └───────────────────┘
</code></pre></div> <p><strong>WebAssembly Interface Types (WIT) Definition:</strong></p> <div class=highlight><pre><span></span><code>// api/wit/embedder.wit
package metatools:embedder@1.0.0;

interface embedder {
    record embed-request {
        text: string,
    }

    record embed-response {
        embedding: list&lt;f32&gt;,
    }

    record embedder-info {
        model: string,
        dimensions: u32,
    }

    embed: func(request: embed-request) -&gt; result&lt;embed-response, string&gt;;
    info: func() -&gt; embedder-info;
}

world embedder-plugin {
    export embedder;
}
</code></pre></div> <p><strong>Benefits:</strong> - <strong>Sandboxed</strong>: Strong isolation, no access beyond granted capabilities - <strong>Portable</strong>: Same .wasm binary runs on any platform - <strong>No network overhead</strong>: Direct function calls, not RPC - <strong>Multi-language</strong>: Rust, Go (TinyGo), C/C++, AssemblyScript compile to WASM</p> <p><strong>Limitations:</strong> - Ecosystem still maturing (WASI Preview 2 released 2024) - Some languages have limited WASM support - Performance overhead for complex data marshaling</p> <h4 id=option-3-json-rpc-over-stdio-simple>Option 3: JSON-RPC over stdio (Simple)<a class=headerlink href=#option-3-json-rpc-over-stdio-simple title="Permanent link">&para;</a></h4> <p><strong>Lightweight approach for simple plugins.</strong></p> <div class=highlight><pre><span></span><code>┌─────────────────────────────────────────────────────────────────────────────────┐
│                            METATOOLS CORE (Go)                                   │
│                                                                                  │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │                     JSON-RPC Dispatcher                                  │   │
│   │   - Spawn plugin process                                                 │   │
│   │   - Send JSON-RPC requests via stdin                                     │   │
│   │   - Receive JSON-RPC responses via stdout                                │   │
│   └───────────────────────────────┬─────────────────────────────────────────┘   │
│                                   │                                              │
└───────────────────────────────────┼──────────────────────────────────────────────┘
                                    │ JSON-RPC 2.0 over stdin/stdout
        ┌───────────────────────────┼───────────────────────────┐
        │                           │                           │
        ▼                           ▼                           ▼
┌───────────────────┐   ┌───────────────────┐   ┌───────────────────┐
│ Any executable    │   │ Shell script      │   │ Node.js script    │
│ (simple wrapper)  │   │ (bash/zsh)        │   │ (quick prototype) │
└───────────────────┘   └───────────────────┘   └───────────────────┘
</code></pre></div> <p><strong>Benefits:</strong> - <strong>Trivial to implement</strong>: Any language that reads stdin and writes stdout - <strong>No dependencies</strong>: No gRPC libraries, no WASM runtime - <strong>Debugging friendly</strong>: Human-readable JSON messages</p> <p><strong>Limitations:</strong> - Performance: Text serialization slower than binary - No streaming: Request-response only - Less type safety: JSON schema validation required</p> <h3 id=recommended-approach-by-component>Recommended Approach by Component<a class=headerlink href=#recommended-approach-by-component title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Component</th> <th>Recommended</th> <th>Rationale</th> </tr> </thead> <tbody> <tr> <td><strong>Embedder</strong></td> <td>gRPC (Python)</td> <td>ML ecosystem, batch processing, GPU support</td> </tr> <tr> <td><strong>VectorIndex</strong></td> <td>gRPC (Rust) or WASM</td> <td>Performance-critical, SIMD optimization</td> </tr> <tr> <td><strong>Reranker</strong></td> <td>gRPC (Python)</td> <td>Hugging Face transformers, cross-encoders</td> </tr> <tr> <td><strong>KnowledgeGraph</strong></td> <td>gRPC (Python/Java)</td> <td>Neo4j, NetworkX, JanusGraph bindings</td> </tr> <tr> <td><strong>Adapter</strong></td> <td>Go native or WASM</td> <td>Simple logic, low latency</td> </tr> <tr> <td><strong>Cache</strong></td> <td>Go native</td> <td>Redis/memory clients well-supported in Go</td> </tr> </tbody> </table> <h3 id=plugin-sdk-generation>Plugin SDK Generation<a class=headerlink href=#plugin-sdk-generation title="Permanent link">&para;</a></h3> <p>The architecture supports <strong>automatic SDK generation</strong> from Protocol Buffer definitions:</p> <div class=highlight><pre><span></span><code><span class=c1># Generate SDKs for all supported languages</span>
make<span class=w> </span>generate-sdks

<span class=c1># Outputs:</span>
<span class=c1># - sdk/go/       (native Go interfaces)</span>
<span class=c1># - sdk/python/   (gRPC stubs + helper classes)</span>
<span class=c1># - sdk/rust/     (gRPC stubs + traits)</span>
<span class=c1># - sdk/typescript/ (gRPC-web stubs)</span>
</code></pre></div> <p><strong>Python SDK Example:</strong></p> <div class=highlight><pre><span></span><code><span class=c1># sdk/python/metatools/embedder.py</span>
<span class=kn>from</span><span class=w> </span><span class=nn>abc</span><span class=w> </span><span class=kn>import</span> <span class=n>ABC</span><span class=p>,</span> <span class=n>abstractmethod</span>
<span class=kn>from</span><span class=w> </span><span class=nn>metatools.proto</span><span class=w> </span><span class=kn>import</span> <span class=n>embedder_pb2</span><span class=p>,</span> <span class=n>embedder_pb2_grpc</span>

<span class=k>class</span><span class=w> </span><span class=nc>BaseEmbedder</span><span class=p>(</span><span class=n>embedder_pb2_grpc</span><span class=o>.</span><span class=n>EmbedderServicer</span><span class=p>,</span> <span class=n>ABC</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Base class for implementing Embedder plugins in Python.&quot;&quot;&quot;</span>

    <span class=nd>@abstractmethod</span>
    <span class=k>def</span><span class=w> </span><span class=nf>embed</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>text</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=nb>float</span><span class=p>]:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Generate embedding for text.&quot;&quot;&quot;</span>
        <span class=k>pass</span>

    <span class=nd>@abstractmethod</span>
    <span class=k>def</span><span class=w> </span><span class=nf>dimensions</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Return embedding dimensions.&quot;&quot;&quot;</span>
        <span class=k>pass</span>

    <span class=nd>@abstractmethod</span>
    <span class=k>def</span><span class=w> </span><span class=nf>model_name</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Return model identifier.&quot;&quot;&quot;</span>
        <span class=k>pass</span>

    <span class=c1># gRPC method implementations</span>
    <span class=k>def</span><span class=w> </span><span class=nf>Embed</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>context</span><span class=p>):</span>
        <span class=n>embedding</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>embed</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>embedder_pb2</span><span class=o>.</span><span class=n>EmbedResponse</span><span class=p>(</span><span class=n>embedding</span><span class=o>=</span><span class=n>embedding</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>Info</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>context</span><span class=p>):</span>
        <span class=k>return</span> <span class=n>embedder_pb2</span><span class=o>.</span><span class=n>EmbedderInfo</span><span class=p>(</span>
            <span class=n>model</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>model_name</span><span class=p>(),</span>
            <span class=n>dimensions</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>dimensions</span><span class=p>()</span>
        <span class=p>)</span>

<span class=k>def</span><span class=w> </span><span class=nf>serve</span><span class=p>(</span><span class=n>embedder</span><span class=p>:</span> <span class=n>BaseEmbedder</span><span class=p>,</span> <span class=n>port</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>50051</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Start the gRPC server for the embedder plugin.&quot;&quot;&quot;</span>
    <span class=n>server</span> <span class=o>=</span> <span class=n>grpc</span><span class=o>.</span><span class=n>server</span><span class=p>(</span><span class=n>futures</span><span class=o>.</span><span class=n>ThreadPoolExecutor</span><span class=p>(</span><span class=n>max_workers</span><span class=o>=</span><span class=mi>10</span><span class=p>))</span>
    <span class=n>embedder_pb2_grpc</span><span class=o>.</span><span class=n>add_EmbedderServicer_to_server</span><span class=p>(</span><span class=n>embedder</span><span class=p>,</span> <span class=n>server</span><span class=p>)</span>
    <span class=n>server</span><span class=o>.</span><span class=n>add_insecure_port</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;[::]:</span><span class=si>{</span><span class=n>port</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
    <span class=n>server</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
    <span class=n>server</span><span class=o>.</span><span class=n>wait_for_termination</span><span class=p>()</span>
</code></pre></div> <h3 id=configuration-for-multi-language-plugins>Configuration for Multi-Language Plugins<a class=headerlink href=#configuration-for-multi-language-plugins title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=c1># metatools.yaml</span>
<span class=nt>plugins</span><span class=p>:</span>
<span class=w>  </span><span class=c1># gRPC plugin (Python embedder)</span>
<span class=w>  </span><span class=nt>embedder</span><span class=p>:</span>
<span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">grpc</span>
<span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=s>&quot;python</span><span class=nv> </span><span class=s>-m</span><span class=nv> </span><span class=s>metatools_embedder&quot;</span>
<span class=w>    </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=s>&quot;localhost:50051&quot;</span>
<span class=w>    </span><span class=nt>health_check_interval</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">10s</span>
<span class=w>    </span><span class=nt>restart_on_failure</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class=w>  </span><span class=c1># WASM plugin (Rust vector index)</span>
<span class=w>  </span><span class=nt>vector_index</span><span class=p>:</span>
<span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">wasm</span>
<span class=w>    </span><span class=nt>module</span><span class=p>:</span><span class=w> </span><span class=s>&quot;plugins/vector_index.wasm&quot;</span>
<span class=w>    </span><span class=nt>memory_limit</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">256MB</span>
<span class=w>    </span><span class=nt>capabilities</span><span class=p>:</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">filesystem:read:/data/indices</span>

<span class=w>  </span><span class=c1># JSON-RPC plugin (quick prototype)</span>
<span class=w>  </span><span class=nt>custom_adapter</span><span class=p>:</span>
<span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">jsonrpc</span>
<span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=s>&quot;node</span><span class=nv> </span><span class=s>plugins/adapter.js&quot;</span>
<span class=w>    </span><span class=nt>timeout</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">5s</span>
</code></pre></div> <h3 id=research-references>Research References<a class=headerlink href=#research-references title="Permanent link">&para;</a></h3> <p>This multi-language architecture is informed by:</p> <ol> <li><strong>HashiCorp go-plugin</strong>: Battle-tested gRPC plugin system used by Terraform, Vault, Consul, and Packer for 10+ years</li> <li><strong>gRPC + Protocol Buffers</strong>: Industry standard for polyglot microservices, supports 10+ languages</li> <li><strong>WebAssembly Component Model (WCM)</strong>: Emerging standard for sandboxed, portable plugin systems</li> <li><strong>WASI Preview 2</strong>: Standardized system interfaces for WASM (filesystem, network, clocks)</li> <li><strong>Interface Definition Languages (IDL)</strong>: Contract-first development enabling language-agnostic interoperability</li> </ol> <hr> <h2 id=summary-roadmap-at-a-glance>Summary: Roadmap at a Glance<a class=headerlink href=#summary-roadmap-at-a-glance title="Permanent link">&para;</a></h2> <div class=highlight><pre><span></span><code>┌───────────────────────────────────────────────────────────────────────────────────┐
│                           METATOOLS ROADMAP 2026                                   │
├───────────────────────────────────────────────────────────────────────────────────┤
│                                                                                    │
│  EXISTING (7 libs)        NEW CORE (2 libs)       CROSS-CUTTING (7 libs)          │
│  ═══════════════════      ═════════════════       ══════════════════════          │
│  ✅ toolmodel             🔲 tooladapter          🔲 toolcache                     │
│  ✅ toolindex             🔲 toolset              🔲 toolobserve                   │
│  ✅ tooldocs                                      🔲 toolversion                   │
│  ✅ toolsearch            ENTERPRISE (5 libs)     🔲 toolresilience                │
│  ✅ toolrun               ═══════════════════     🔲 toolhealth                    │
│  ✅ toolcode              🔲 toolsemantic         🔲 toolaudit                     │
│  ✅ toolruntime           🔲 toolresource         🔲 toolsecrets                   │
│                           🔲 toolgateway          🔲 toolflags                     │
│                           🔲 toola2a (future)     🔲 toolpressure                  │
│                           🔲 toolprompt (future)                                   │
│                                                                                    │
│  AGENT SKILLS (1 lib)                                                             │
│  ════════════════════                                                             │
│  🔲 toolskill             Skill composition, workflows, A2A advertisement         │
│                                                                                    │
│  ──────────────────────────────────────────────────────────────────────────────── │
│                                                                                    │
│  TIMELINE                                                                         │
│  ═════════                                                                        │
│                                                                                    │
│  Weeks 1-7   [████████████████████████████░░░░░░░░░░░░░░░░░░░░░░░░░] MVP Core     │
│  Weeks 8-14  [░░░░░░░░░░░░░░░░░░░░████████████████████████░░░░░░░░░] Protocol     │
│  Weeks 8-17  [░░░░░░░░░░░░░░░░░░░░████████████████████████████░░░░░] Cross-Cut    │
│  Weeks 12-17 [░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░████████████████░░░░░] Enterprise   │
│  Weeks 18-21 [░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░████] Agent Skills │
│                                                                                    │
│  ──────────────────────────────────────────────────────────────────────────────── │
│                                                                                    │
│  MILESTONES                                                                       │
│  ══════════                                                                       │
│                                                                                    │
│  Week 7:  MVP Release (v0.2.0) - CLI, Config, Transport, Providers               │
│  Week 14: Protocol Release (v0.3.0) - Adapters, Toolsets, Multi-Transport        │
│  Week 17: Enterprise Release (v1.0.0) - Full feature set                         │
│  Week 21: Agent Skills Release (v1.1.0) - Skills, Workflows, A2A                 │
│                                                                                    │
└───────────────────────────────────────────────────────────────────────────────────┘
</code></pre></div> <hr> <h2 id=appendix-document-cross-references>Appendix: Document Cross-References<a class=headerlink href=#appendix-document-cross-references title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>Document</th> <th>Purpose</th> <th>Status</th> </tr> </thead> <tbody> <tr> <td><a href=../pluggable-architecture/ >pluggable-architecture.md</a></td> <td>Core architecture design</td> <td>Active</td> </tr> <tr> <td><a href=../implementation-phases/ >implementation-phases.md</a></td> <td>Phase details</td> <td>Active</td> </tr> <tr> <td><a href=../component-library-analysis/ >component-library-analysis.md</a></td> <td>Library analysis</td> <td>Complete</td> </tr> <tr> <td><a href=../architecture-evaluation/ >architecture-evaluation.md</a></td> <td>Championship comparison</td> <td>Complete</td> </tr> <tr> <td><a href=../protocol-agnostic-tools/ >protocol-agnostic-tools.md</a></td> <td>Protocol layer design</td> <td>Active</td> </tr> <tr> <td><a href=../multi-tenancy/ >multi-tenancy.md</a></td> <td>Multi-tenant design</td> <td>Active</td> </tr> <tr> <td><strong>ROADMAP.md</strong> (this document)</td> <td>Master roadmap</td> <td>Active</td> </tr> </tbody> </table> <hr> <h2 id=changelog>Changelog<a class=headerlink href=#changelog title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>Date</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td>2026-01-28</td> <td>Architecture Review: Added scope clarification table, fixed Transport interface (added Name()), updated toolskill dependencies</td> </tr> <tr> <td>2026-01-28</td> <td>Added Section 8: Multi-Language Extensibility - gRPC, WASM, JSON-RPC plugin architectures with SDK generation</td> </tr> <tr> <td>2026-01-28</td> <td>Added comprehensive D4 toolsemantic specification: hybrid search, GraphRAG, hierarchical chunking, agentic RAG, ColBERT, cross-encoder reranking</td> </tr> <tr> <td>2026-01-28</td> <td>Added SKILL.md Open Standard support to toolskill (Claude Code, Codex, ChatGPT compatible)</td> </tr> <tr> <td>2026-01-28</td> <td>Added Stream E: Agent Skills with toolskill library proposal</td> </tr> <tr> <td>2026-01-28</td> <td>Initial roadmap created from all proposal documents</td> </tr> </tbody> </table> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy", "content.tabs.link", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../../../assets/javascripts/bundle.fe8b6f2b.min.js></script> <script src=https://unpkg.com/mermaid@10.6.1/dist/mermaid.min.js></script> <script src=../../../../js/mermaid-init.js></script> <script src=../../../../js/diagram-panzoom.js></script> </body> </html>