<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Unified documentation for toolmodel, toolindex, tooldocs, toolrun, toolcode, toolruntime, toolsearch, and metatools-mcp."><link href=https://jonwraymond.github.io/ai-tools-stack/latest/library-docs-from-repos/metatools-mcp/proposals/protocol-agnostic-tools/ rel=canonical><link rel=icon href=../../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.5.28"><title>Protocol-Agnostic Tools and Composable Toolsets - AI Tools Stack</title><link rel=stylesheet href=../../../../assets/stylesheets/main.6543a935.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent=teal> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#protocol-agnostic-tools-and-composable-toolsets class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../.. title="AI Tools Stack" class="md-header__button md-logo" aria-label="AI Tools Stack" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> AI Tools Stack </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Protocol-Agnostic Tools and Composable Toolsets </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent=teal aria-hidden=true type=radio name=__palette id=__palette_0> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=blue data-md-color-accent=teal aria-hidden=true type=radio name=__palette id=__palette_1> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/jonwraymond/ai-tools-stack title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> jonwraymond/ai-tools-stack </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title="AI Tools Stack" class="md-nav__button md-logo" aria-label="AI Tools Stack" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> AI Tools Stack </label> <div class=md-nav__source> <a href=https://github.com/jonwraymond/ai-tools-stack title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> jonwraymond/ai-tools-stack </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Architecture </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../architecture/overview/ class=md-nav__link> <span class=md-ellipsis> Stack Overview </span> </a> </li> <li class=md-nav__item> <a href=../../../../architecture/progressive-disclosure/ class=md-nav__link> <span class=md-ellipsis> Progressive Disclosure </span> </a> </li> <li class=md-nav__item> <a href=../../../../architecture/pluggable-architecture/ class=md-nav__link> <span class=md-ellipsis> Pluggable Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../../../architecture/why-go/ class=md-nav__link> <span class=md-ellipsis> Why Go </span> </a> </li> <li class=md-nav__item> <a href=../../../../architecture/design-notes/ class=md-nav__link> <span class=md-ellipsis> Design Notes Index </span> </a> </li> <li class=md-nav__item> <a href=../../../../architecture/user-journeys/ class=md-nav__link> <span class=md-ellipsis> User Journeys Index </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Components </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Components </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../components/toolmodel/ class=md-nav__link> <span class=md-ellipsis> toolmodel </span> </a> </li> <li class=md-nav__item> <a href=../../../../components/toolindex/ class=md-nav__link> <span class=md-ellipsis> toolindex </span> </a> </li> <li class=md-nav__item> <a href=../../../../components/tooldocs/ class=md-nav__link> <span class=md-ellipsis> tooldocs </span> </a> </li> <li class=md-nav__item> <a href=../../../../components/toolrun/ class=md-nav__link> <span class=md-ellipsis> toolrun </span> </a> </li> <li class=md-nav__item> <a href=../../../../components/toolcode/ class=md-nav__link> <span class=md-ellipsis> toolcode </span> </a> </li> <li class=md-nav__item> <a href=../../../../components/toolruntime/ class=md-nav__link> <span class=md-ellipsis> toolruntime </span> </a> </li> <li class=md-nav__item> <a href=../../../../components/toolsearch/ class=md-nav__link> <span class=md-ellipsis> toolsearch </span> </a> </li> <li class=md-nav__item> <a href=../../../../components/metatools-mcp/ class=md-nav__link> <span class=md-ellipsis> metatools-mcp </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Operations </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Operations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../operations/ci-and-versioning/ class=md-nav__link> <span class=md-ellipsis> CI and Versioning </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex> <span class=md-ellipsis> Library Docs (from repos) </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Library Docs (from repos) </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_1> <label class=md-nav__link for=__nav_5_1 id=__nav_5_1_label tabindex=0> <span class=md-ellipsis> toolmodel </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_1_label aria-expanded=false> <label class=md-nav__title for=__nav_5_1> <span class="md-nav__icon md-icon"></span> toolmodel </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../toolmodel/ class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../../toolmodel/architecture/ class=md-nav__link> <span class=md-ellipsis> Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../../toolmodel/usage/ class=md-nav__link> <span class=md-ellipsis> Usage </span> </a> </li> <li class=md-nav__item> <a href=../../../toolmodel/examples/ class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=../../../toolmodel/design-notes/ class=md-nav__link> <span class=md-ellipsis> Design Notes </span> </a> </li> <li class=md-nav__item> <a href=../../../toolmodel/user-journey/ class=md-nav__link> <span class=md-ellipsis> User Journey </span> </a> </li> <li class=md-nav__item> <a href=../../../toolmodel/api/ class=md-nav__link> <span class=md-ellipsis> API Reference </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class=md-ellipsis> toolindex </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> toolindex </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../toolindex/ class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../../toolindex/architecture/ class=md-nav__link> <span class=md-ellipsis> Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../../toolindex/usage/ class=md-nav__link> <span class=md-ellipsis> Usage </span> </a> </li> <li class=md-nav__item> <a href=../../../toolindex/examples/ class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=../../../toolindex/design-notes/ class=md-nav__link> <span class=md-ellipsis> Design Notes </span> </a> </li> <li class=md-nav__item> <a href=../../../toolindex/user-journey/ class=md-nav__link> <span class=md-ellipsis> User Journey </span> </a> </li> <li class=md-nav__item> <a href=../../../toolindex/api/ class=md-nav__link> <span class=md-ellipsis> API Reference </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_3> <label class=md-nav__link for=__nav_5_3 id=__nav_5_3_label tabindex=0> <span class=md-ellipsis> tooldocs </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_5_3> <span class="md-nav__icon md-icon"></span> tooldocs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tooldocs/ class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../../tooldocs/architecture/ class=md-nav__link> <span class=md-ellipsis> Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../../tooldocs/usage/ class=md-nav__link> <span class=md-ellipsis> Usage </span> </a> </li> <li class=md-nav__item> <a href=../../../tooldocs/examples/ class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=../../../tooldocs/design-notes/ class=md-nav__link> <span class=md-ellipsis> Design Notes </span> </a> </li> <li class=md-nav__item> <a href=../../../tooldocs/user-journey/ class=md-nav__link> <span class=md-ellipsis> User Journey </span> </a> </li> <li class=md-nav__item> <a href=../../../tooldocs/api/ class=md-nav__link> <span class=md-ellipsis> API Reference </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_4> <label class=md-nav__link for=__nav_5_4 id=__nav_5_4_label tabindex=0> <span class=md-ellipsis> toolrun </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_4_label aria-expanded=false> <label class=md-nav__title for=__nav_5_4> <span class="md-nav__icon md-icon"></span> toolrun </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../toolrun/ class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../../toolrun/architecture/ class=md-nav__link> <span class=md-ellipsis> Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../../toolrun/usage/ class=md-nav__link> <span class=md-ellipsis> Usage </span> </a> </li> <li class=md-nav__item> <a href=../../../toolrun/examples/ class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=../../../toolrun/design-notes/ class=md-nav__link> <span class=md-ellipsis> Design Notes </span> </a> </li> <li class=md-nav__item> <a href=../../../toolrun/user-journey/ class=md-nav__link> <span class=md-ellipsis> User Journey </span> </a> </li> <li class=md-nav__item> <a href=../../../toolrun/api/ class=md-nav__link> <span class=md-ellipsis> API Reference </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_5> <label class=md-nav__link for=__nav_5_5 id=__nav_5_5_label tabindex=0> <span class=md-ellipsis> toolcode </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5_5> <span class="md-nav__icon md-icon"></span> toolcode </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../toolcode/ class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../../toolcode/architecture/ class=md-nav__link> <span class=md-ellipsis> Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../../toolcode/usage/ class=md-nav__link> <span class=md-ellipsis> Usage </span> </a> </li> <li class=md-nav__item> <a href=../../../toolcode/examples/ class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=../../../toolcode/design-notes/ class=md-nav__link> <span class=md-ellipsis> Design Notes </span> </a> </li> <li class=md-nav__item> <a href=../../../toolcode/user-journey/ class=md-nav__link> <span class=md-ellipsis> User Journey </span> </a> </li> <li class=md-nav__item> <a href=../../../toolcode/api/ class=md-nav__link> <span class=md-ellipsis> API Reference </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_6> <label class=md-nav__link for=__nav_5_6 id=__nav_5_6_label tabindex=0> <span class=md-ellipsis> toolruntime </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_6_label aria-expanded=false> <label class=md-nav__title for=__nav_5_6> <span class="md-nav__icon md-icon"></span> toolruntime </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../toolruntime/ class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../../toolruntime/architecture/ class=md-nav__link> <span class=md-ellipsis> Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../../toolruntime/usage/ class=md-nav__link> <span class=md-ellipsis> Usage </span> </a> </li> <li class=md-nav__item> <a href=../../../toolruntime/examples/ class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=../../../toolruntime/design-notes/ class=md-nav__link> <span class=md-ellipsis> Design Notes </span> </a> </li> <li class=md-nav__item> <a href=../../../toolruntime/user-journey/ class=md-nav__link> <span class=md-ellipsis> User Journey </span> </a> </li> <li class=md-nav__item> <a href=../../../toolruntime/api/ class=md-nav__link> <span class=md-ellipsis> API Reference </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_7> <label class=md-nav__link for=__nav_5_7 id=__nav_5_7_label tabindex=0> <span class=md-ellipsis> toolsearch </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_7_label aria-expanded=false> <label class=md-nav__title for=__nav_5_7> <span class="md-nav__icon md-icon"></span> toolsearch </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../toolsearch/ class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../../toolsearch/architecture/ class=md-nav__link> <span class=md-ellipsis> Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../../toolsearch/usage/ class=md-nav__link> <span class=md-ellipsis> Usage </span> </a> </li> <li class=md-nav__item> <a href=../../../toolsearch/examples/ class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=../../../toolsearch/design-notes/ class=md-nav__link> <span class=md-ellipsis> Design Notes </span> </a> </li> <li class=md-nav__item> <a href=../../../toolsearch/user-journey/ class=md-nav__link> <span class=md-ellipsis> User Journey </span> </a> </li> <li class=md-nav__item> <a href=../../../toolsearch/api/ class=md-nav__link> <span class=md-ellipsis> API Reference </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_8> <label class=md-nav__link for=__nav_5_8 id=__nav_5_8_label tabindex=0> <span class=md-ellipsis> metatools-mcp </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_8_label aria-expanded=false> <label class=md-nav__title for=__nav_5_8> <span class="md-nav__icon md-icon"></span> metatools-mcp </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/ class=md-nav__link> <span class=md-ellipsis> Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../usage/ class=md-nav__link> <span class=md-ellipsis> Usage </span> </a> </li> <li class=md-nav__item> <a href=../../examples/ class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class=md-nav__item> <a href=../../design-notes/ class=md-nav__link> <span class=md-ellipsis> Design Notes </span> </a> </li> <li class=md-nav__item> <a href=../../user-journey/ class=md-nav__link> <span class=md-ellipsis> User Journey </span> </a> </li> <li class=md-nav__item> <a href=../../api/ class=md-nav__link> <span class=md-ellipsis> API Reference </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_8_8> <label class=md-nav__link for=__nav_5_8_8 id=__nav_5_8_8_label tabindex=0> <span class=md-ellipsis> Proposals </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_5_8_8_label aria-expanded=false> <label class=md-nav__title for=__nav_5_8_8> <span class="md-nav__icon md-icon"></span> Proposals </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../pluggable-architecture/ class=md-nav__link> <span class=md-ellipsis> Pluggable Architecture </span> </a> </li> <li class=md-nav__item> <a href=../implementation-phases/ class=md-nav__link> <span class=md-ellipsis> Implementation Phases </span> </a> </li> <li class=md-nav__item> <a href=../component-library-analysis/ class=md-nav__link> <span class=md-ellipsis> Component Library Analysis </span> </a> </li> <li class=md-nav__item> <a href=../architecture-evaluation/ class=md-nav__link> <span class=md-ellipsis> Architecture Evaluation </span> </a> </li> <li class=md-nav__item> <a href=../multi-tenancy/ class=md-nav__link> <span class=md-ellipsis> Multi-Tenancy </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#table-of-contents class=md-nav__link> <span class=md-ellipsis> Table of Contents </span> </a> </li> <li class=md-nav__item> <a href=#executive-summary class=md-nav__link> <span class=md-ellipsis> Executive Summary </span> </a> </li> <li class=md-nav__item> <a href=#problem-statement class=md-nav__link> <span class=md-ellipsis> Problem Statement </span> </a> <nav class=md-nav aria-label="Problem Statement"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#current-limitations class=md-nav__link> <span class=md-ellipsis> Current Limitations </span> </a> </li> <li class=md-nav__item> <a href=#industry-context class=md-nav__link> <span class=md-ellipsis> Industry Context </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#goals-and-non-goals class=md-nav__link> <span class=md-ellipsis> Goals and Non-Goals </span> </a> <nav class=md-nav aria-label="Goals and Non-Goals"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#goals class=md-nav__link> <span class=md-ellipsis> Goals </span> </a> </li> <li class=md-nav__item> <a href=#non-goals class=md-nav__link> <span class=md-ellipsis> Non-Goals </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#research-findings class=md-nav__link> <span class=md-ellipsis> Research Findings </span> </a> <nav class=md-nav aria-label="Research Findings"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pattern-1-unified-tool-abstraction-toolregistry-paper class=md-nav__link> <span class=md-ellipsis> Pattern 1: Unified Tool Abstraction (ToolRegistry Paper) </span> </a> </li> <li class=md-nav__item> <a href=#pattern-2-langchain-mcp-adapter class=md-nav__link> <span class=md-ellipsis> Pattern 2: LangChain MCP Adapter </span> </a> </li> <li class=md-nav__item> <a href=#pattern-3-multi-language-tool-declaration-llm-functions class=md-nav__link> <span class=md-ellipsis> Pattern 3: Multi-Language Tool Declaration (llm-functions) </span> </a> </li> <li class=md-nav__item> <a href=#pattern-4-tool-rag-for-large-registries class=md-nav__link> <span class=md-ellipsis> Pattern 4: Tool RAG for Large Registries </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#proposed-architecture class=md-nav__link> <span class=md-ellipsis> Proposed Architecture </span> </a> <nav class=md-nav aria-label="Proposed Architecture"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#new-library-tooladapter class=md-nav__link> <span class=md-ellipsis> New Library: tooladapter </span> </a> </li> <li class=md-nav__item> <a href=#new-library-toolset class=md-nav__link> <span class=md-ellipsis> New Library: toolset </span> </a> </li> <li class=md-nav__item> <a href=#architecture-overview class=md-nav__link> <span class=md-ellipsis> Architecture Overview </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#tool-abstraction-layer class=md-nav__link> <span class=md-ellipsis> Tool Abstraction Layer </span> </a> <nav class=md-nav aria-label="Tool Abstraction Layer"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#canonical-tool-interface class=md-nav__link> <span class=md-ellipsis> Canonical Tool Interface </span> </a> </li> <li class=md-nav__item> <a href=#adapter-interface class=md-nav__link> <span class=md-ellipsis> Adapter Interface </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#protocol-adapters class=md-nav__link> <span class=md-ellipsis> Protocol Adapters </span> </a> <nav class=md-nav aria-label="Protocol Adapters"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mcp-adapter class=md-nav__link> <span class=md-ellipsis> MCP Adapter </span> </a> </li> <li class=md-nav__item> <a href=#openai-adapter class=md-nav__link> <span class=md-ellipsis> OpenAI Adapter </span> </a> </li> <li class=md-nav__item> <a href=#anthropic-adapter class=md-nav__link> <span class=md-ellipsis> Anthropic Adapter </span> </a> </li> <li class=md-nav__item> <a href=#schema-conversion-utilities class=md-nav__link> <span class=md-ellipsis> Schema Conversion Utilities </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#composable-toolsets class=md-nav__link> <span class=md-ellipsis> Composable Toolsets </span> </a> <nav class=md-nav aria-label="Composable Toolsets"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#toolset-definition class=md-nav__link> <span class=md-ellipsis> Toolset Definition </span> </a> </li> <li class=md-nav__item> <a href=#fluent-builder class=md-nav__link> <span class=md-ellipsis> Fluent Builder </span> </a> </li> <li class=md-nav__item> <a href=#usage-examples class=md-nav__link> <span class=md-ellipsis> Usage Examples </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#integration-with-existing-libraries class=md-nav__link> <span class=md-ellipsis> Integration with Existing Libraries </span> </a> <nav class=md-nav aria-label="Integration with Existing Libraries"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#toolindex-integration class=md-nav__link> <span class=md-ellipsis> toolindex Integration </span> </a> </li> <li class=md-nav__item> <a href=#toolmodel-integration class=md-nav__link> <span class=md-ellipsis> toolmodel Integration </span> </a> </li> <li class=md-nav__item> <a href=#toolrun-integration class=md-nav__link> <span class=md-ellipsis> toolrun Integration </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#implementation-roadmap class=md-nav__link> <span class=md-ellipsis> Implementation Roadmap </span> </a> <nav class=md-nav aria-label="Implementation Roadmap"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#phase-1-core-adapter-library-2-weeks class=md-nav__link> <span class=md-ellipsis> Phase 1: Core Adapter Library (2 weeks) </span> </a> </li> <li class=md-nav__item> <a href=#phase-2-toolset-composition-2-weeks class=md-nav__link> <span class=md-ellipsis> Phase 2: Toolset Composition (2 weeks) </span> </a> </li> <li class=md-nav__item> <a href=#phase-3-multi-transport-exposure-2-weeks class=md-nav__link> <span class=md-ellipsis> Phase 3: Multi-Transport Exposure (2 weeks) </span> </a> </li> <li class=md-nav__item> <a href=#dependency-graph class=md-nav__link> <span class=md-ellipsis> Dependency Graph </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#appendix-industry-patterns class=md-nav__link> <span class=md-ellipsis> Appendix: Industry Patterns </span> </a> <nav class=md-nav aria-label="Appendix: Industry Patterns"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#a-tool-format-comparison class=md-nav__link> <span class=md-ellipsis> A. Tool Format Comparison </span> </a> </li> <li class=md-nav__item> <a href=#b-schema-feature-support-matrix class=md-nav__link> <span class=md-ellipsis> B. Schema Feature Support Matrix </span> </a> </li> <li class=md-nav__item> <a href=#c-error-rate-comparison-mastra-research class=md-nav__link> <span class=md-ellipsis> C. Error Rate Comparison (Mastra Research) </span> </a> </li> <li class=md-nav__item> <a href=#d-related-projects class=md-nav__link> <span class=md-ellipsis> D. Related Projects </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#changelog class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=protocol-agnostic-tools-and-composable-toolsets>Protocol-Agnostic Tools and Composable Toolsets<a class=headerlink href=#protocol-agnostic-tools-and-composable-toolsets title="Permanent link">&para;</a></h1> <p><strong>Status:</strong> Draft <strong>Last Updated:</strong> 2026-01-28 <strong>Authors:</strong> Architecture Team</p> <h2 id=table-of-contents>Table of Contents<a class=headerlink href=#table-of-contents title="Permanent link">&para;</a></h2> <ol> <li><a href=#executive-summary>Executive Summary</a></li> <li><a href=#problem-statement>Problem Statement</a></li> <li><a href=#goals-and-non-goals>Goals and Non-Goals</a></li> <li><a href=#research-findings>Research Findings</a></li> <li><a href=#proposed-architecture>Proposed Architecture</a></li> <li><a href=#tool-abstraction-layer>Tool Abstraction Layer</a></li> <li><a href=#protocol-adapters>Protocol Adapters</a></li> <li><a href=#composable-toolsets>Composable Toolsets</a></li> <li><a href=#integration-with-existing-libraries>Integration with Existing Libraries</a></li> <li><a href=#implementation-roadmap>Implementation Roadmap</a></li> <li><a href=#appendix-industry-patterns>Appendix: Industry Patterns</a></li> </ol> <hr> <h2 id=executive-summary>Executive Summary<a class=headerlink href=#executive-summary title="Permanent link">&para;</a></h2> <p>This proposal extends metatools-mcp's pluggable architecture to support <strong>protocol-agnostic tool exposure</strong> and <strong>composable toolsets</strong>. Rather than limiting tool consumption to the MCP protocol, we introduce an adaptability layer that enables tools from any source (MCP backends, custom providers, local implementations) to be exposed through multiple transport protocols and consumed by various AI agent frameworks.</p> <p>Key capabilities: - <strong>Protocol-agnostic tool interface</strong> - Canonical tool representation independent of source or destination protocol - <strong>Bidirectional adapters</strong> - Convert tools between MCP, OpenAI, Anthropic, LangChain, and other formats - <strong>Toolset composition</strong> - Create curated tool collections from multiple sources - <strong>Multi-transport exposure</strong> - Serve toolsets via MCP, direct client interfaces, REST, or A2A</p> <hr> <h2 id=problem-statement>Problem Statement<a class=headerlink href=#problem-statement title="Permanent link">&para;</a></h2> <h3 id=current-limitations>Current Limitations<a class=headerlink href=#current-limitations title="Permanent link">&para;</a></h3> <ol> <li> <p><strong>MCP-Only Exposure</strong>: metatools-mcp currently exposes tools exclusively through the MCP protocol. Organizations with mature AI environments using different tool calling conventions (OpenAI function calling, Anthropic tool use, LangChain tools) cannot directly consume metatools without MCP integration.</p> </li> <li> <p><strong>Fixed Tool Collections</strong>: All registered tools are exposed as a single collection. There's no mechanism to create curated toolsets for different use cases (development vs production, team A vs team B, customer-specific).</p> </li> <li> <p><strong>One-Way Conversion</strong>: Tools flow from backends → MCP → clients. There's no standardized way to import tools from external sources (OpenAPI specs, LangChain tools, OpenAI functions) into the metatools ecosystem.</p> </li> </ol> <h3 id=industry-context>Industry Context<a class=headerlink href=#industry-context title="Permanent link">&para;</a></h3> <p>Research reveals a fragmented landscape of tool formats:</p> <table> <thead> <tr> <th>Provider</th> <th>Format</th> <th>Key Differences</th> </tr> </thead> <tbody> <tr> <td>MCP</td> <td><code>Tool</code> with <code>inputSchema</code></td> <td>Rich JSON Schema, supports resources/prompts</td> </tr> <tr> <td>OpenAI</td> <td><code>function</code> with <code>parameters</code></td> <td>Strict mode available, simpler schema</td> </tr> <tr> <td>Anthropic</td> <td><code>tool</code> with <code>input_schema</code></td> <td>Similar to MCP but different field names</td> </tr> <tr> <td>LangChain</td> <td><code>StructuredTool</code></td> <td>Python/JS-centric, Zod schemas</td> </tr> <tr> <td>A2A</td> <td>Agent-defined</td> <td>Inter-agent tool delegation</td> </tr> </tbody> </table> <p>The <strong>Mastra framework</strong> demonstrated that proper tool format conversion reduces error rates from 15% to 3% across providers.</p> <hr> <h2 id=goals-and-non-goals>Goals and Non-Goals<a class=headerlink href=#goals-and-non-goals title="Permanent link">&para;</a></h2> <h3 id=goals>Goals<a class=headerlink href=#goals title="Permanent link">&para;</a></h3> <ol> <li><strong>Protocol Independence</strong>: Tools can be consumed without MCP protocol dependency</li> <li><strong>Format Preservation</strong>: Tool semantics survive conversion without information loss</li> <li><strong>Bidirectional Flow</strong>: Import tools from external sources, export to any format</li> <li><strong>Composability</strong>: Create, manage, and expose custom tool collections</li> <li><strong>Backward Compatibility</strong>: Existing MCP-based workflows remain unchanged</li> </ol> <h3 id=non-goals>Non-Goals<a class=headerlink href=#non-goals title="Permanent link">&para;</a></h3> <ol> <li><strong>Runtime Protocol Bridging</strong>: We're not building a universal protocol translator</li> <li><strong>Tool Implementation</strong>: Adapters convert metadata, not execution logic</li> <li><strong>Full A2A Implementation</strong>: Agent orchestration is out of scope</li> <li><strong>Schema Validation Engine</strong>: We rely on existing validation libraries</li> </ol> <hr> <h2 id=research-findings>Research Findings<a class=headerlink href=#research-findings title="Permanent link">&para;</a></h2> <h3 id=pattern-1-unified-tool-abstraction-toolregistry-paper>Pattern 1: Unified Tool Abstraction (ToolRegistry Paper)<a class=headerlink href=#pattern-1-unified-tool-abstraction-toolregistry-paper title="Permanent link">&para;</a></h3> <p>The ArXiv paper "Unified Tool Integration for LLMs" establishes a three-layer architecture:</p> <div class=highlight><pre><span></span><code>┌─────────────────────────────────────────────────────────┐
│                 Layer 3: API Compatibility              │
│   ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐   │
│   │ OpenAI  │  │Anthropic│  │LangChain│  │   MCP   │   │
│   │ Format  │  │ Format  │  │ Format  │  │ Format  │   │
│   └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘   │
│        │            │            │            │         │
│        └────────────┴─────┬──────┴────────────┘         │
│                           │                             │
├───────────────────────────┼─────────────────────────────┤
│                 Layer 2: Protocol Adapters              │
│   ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐   │
│   │  MCP    │  │ OpenAPI │  │LangChain│  │ Custom  │   │
│   │ Adapter │  │ Adapter │  │ Adapter │  │ Adapter │   │
│   └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘   │
│        │            │            │            │         │
│        └────────────┴─────┬──────┴────────────┘         │
│                           │                             │
├───────────────────────────┼─────────────────────────────┤
│                 Layer 1: Unified Abstraction            │
│                    ┌───────────────┐                    │
│                    │ Canonical Tool│                    │
│                    │  Abstraction  │                    │
│                    └───────────────┘                    │
└─────────────────────────────────────────────────────────┘
</code></pre></div> <p><strong>Key Insight</strong>: The canonical tool representation stores the superset of all schema information, enabling lossless conversion between formats.</p> <h3 id=pattern-2-langchain-mcp-adapter>Pattern 2: LangChain MCP Adapter<a class=headerlink href=#pattern-2-langchain-mcp-adapter title="Permanent link">&para;</a></h3> <p>LangChain's <code>langchainjs-mcp-adapters</code> demonstrates practical conversion:</p> <div class=highlight><pre><span></span><code><span class=c1>// MCP Tool → LangChain DynamicStructuredTool</span>
<span class=k>export</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=kd>function</span><span class=w> </span><span class=nx>loadMcpTools</span><span class=p>(</span>
<span class=w>  </span><span class=nx>serverName</span><span class=o>:</span><span class=w> </span><span class=kt>string</span><span class=p>,</span>
<span class=w>  </span><span class=nx>client</span><span class=o>:</span><span class=w> </span><span class=kt>Client</span><span class=p>,</span>
<span class=p>)</span><span class=o>:</span><span class=w> </span><span class=nb>Promise</span><span class=o>&lt;</span><span class=nx>StructuredToolInterface</span><span class=p>[]</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kd>const</span><span class=w> </span><span class=nx>toolsResponse</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>await</span><span class=w> </span><span class=nx>client</span><span class=p>.</span><span class=nx>listTools</span><span class=p>();</span>
<span class=w>  </span><span class=k>return</span><span class=w> </span><span class=nx>toolsResponse</span><span class=p>.</span><span class=nx>tools</span><span class=p>.</span><span class=nx>map</span><span class=p>((</span><span class=nx>tool</span><span class=o>:</span><span class=w> </span><span class=kt>MCPTool</span><span class=p>)</span><span class=w> </span><span class=p>=&gt;</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nx>DynamicStructuredTool</span><span class=p>({</span>
<span class=w>      </span><span class=nx>name</span><span class=o>:</span><span class=w> </span><span class=sb>`</span><span class=si>${</span><span class=nx>serverName</span><span class=si>}</span><span class=sb>_</span><span class=si>${</span><span class=nx>tool</span><span class=p>.</span><span class=nx>name</span><span class=si>}</span><span class=sb>`</span><span class=p>,</span>
<span class=w>      </span><span class=nx>description</span><span class=o>:</span><span class=w> </span><span class=kt>tool.description</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=s2>&quot;&quot;</span><span class=p>,</span>
<span class=w>      </span><span class=nx>schema</span><span class=o>:</span><span class=w> </span><span class=kt>tool.inputSchema</span><span class=p>,</span><span class=w>  </span><span class=c1>// Direct schema pass-through</span>
<span class=w>      </span><span class=nx>func</span><span class=o>:</span><span class=w> </span><span class=kt>callTool.bind</span><span class=p>(</span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=nx>serverName</span><span class=p>,</span><span class=w> </span><span class=nx>tool</span><span class=p>.</span><span class=nx>name</span><span class=p>,</span><span class=w> </span><span class=nx>client</span><span class=p>)</span>
<span class=w>    </span><span class=p>});</span>
<span class=w>  </span><span class=p>});</span>
<span class=p>}</span>
</code></pre></div> <p><strong>Key Insight</strong>: Namespacing (<code>serverName_toolName</code>) prevents collisions when aggregating tools from multiple sources.</p> <h3 id=pattern-3-multi-language-tool-declaration-llm-functions>Pattern 3: Multi-Language Tool Declaration (llm-functions)<a class=headerlink href=#pattern-3-multi-language-tool-declaration-llm-functions title="Permanent link">&para;</a></h3> <p>The <code>llm-functions</code> library shows format-agnostic tool declaration:</p> <div class=highlight><pre><span></span><code><span class=c1># Bash: Comment annotations</span>
<span class=c1># @describe Search the web</span>
<span class=c1># @option --query! The search query</span>
<span class=c1># @option --num_results=10 Number of results</span>
search_web<span class=o>()</span><span class=w> </span><span class=o>{</span><span class=w> </span>...<span class=w> </span><span class=o>}</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=c1>// JavaScript: JSDoc</span>
<span class=cm>/**</span>
<span class=cm> * @typedef {Object} Args</span>
<span class=cm> * @property {string} query - The search query</span>
<span class=cm> * @property {number} [num_results=10] - Number of results</span>
<span class=cm> */</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=c1># Python: Type hints + docstrings</span>
<span class=k>def</span><span class=w> </span><span class=nf>search_web</span><span class=p>(</span><span class=n>query</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>num_results</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>10</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Search the web.</span>

<span class=sd>    Args:</span>
<span class=sd>        query: The search query</span>
<span class=sd>        num_results: Number of results (default: 10)</span>
<span class=sd>    &quot;&quot;&quot;</span>
</code></pre></div> <p><strong>Key Insight</strong>: All three declarations compile to identical JSON Schema, proving format-agnostic tool definitions are achievable.</p> <h3 id=pattern-4-tool-rag-for-large-registries>Pattern 4: Tool RAG for Large Registries<a class=headerlink href=#pattern-4-tool-rag-for-large-registries title="Permanent link">&para;</a></h3> <p>For registries with 50+ tools, semantic search dramatically improves tool selection:</p> <table> <thead> <tr> <th>Approach</th> <th>Accuracy (50 tools)</th> <th>Accuracy (500 tools)</th> </tr> </thead> <tbody> <tr> <td>Keyword matching</td> <td>65%</td> <td>23%</td> </tr> <tr> <td>BM25 (current)</td> <td>78%</td> <td>45%</td> </tr> <tr> <td>Vector embeddings</td> <td>89%</td> <td>72%</td> </tr> <tr> <td>Hybrid (BM25 + vector)</td> <td>94%</td> <td>81%</td> </tr> </tbody> </table> <p>Anthropic's RAG-MCP implementation showed <strong>13% → 43%</strong> accuracy improvement using Tool RAG.</p> <hr> <h2 id=proposed-architecture>Proposed Architecture<a class=headerlink href=#proposed-architecture title="Permanent link">&para;</a></h2> <h3 id=new-library-tooladapter>New Library: <code>tooladapter</code><a class=headerlink href=#new-library-tooladapter title="Permanent link">&para;</a></h3> <p>A dedicated library for protocol-agnostic tool handling:</p> <div class=highlight><pre><span></span><code>tooladapter/
├── canonical.go      # Canonical tool representation
├── adapter.go        # Adapter interface
├── adapters/
│   ├── mcp.go        # MCP ↔ Canonical
│   ├── openai.go     # OpenAI ↔ Canonical
│   ├── anthropic.go  # Anthropic ↔ Canonical
│   ├── langchain.go  # LangChain ↔ Canonical
│   └── openapi.go    # OpenAPI ↔ Canonical
├── schema/
│   ├── convert.go    # JSON Schema version conversion
│   └── validate.go   # Schema validation
└── registry.go       # Adapter registry
</code></pre></div> <h3 id=new-library-toolset>New Library: <code>toolset</code><a class=headerlink href=#new-library-toolset title="Permanent link">&para;</a></h3> <p>Composable tool collections:</p> <div class=highlight><pre><span></span><code>toolset/
├── set.go            # Toolset definition
├── builder.go        # Fluent toolset construction
├── filter.go         # Tool filtering predicates
├── policy.go         # Access control policies
└── expose.go         # Multi-protocol exposure
</code></pre></div> <h3 id=architecture-overview>Architecture Overview<a class=headerlink href=#architecture-overview title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>┌──────────────────────────────────────────────────────────────────────┐
│                        metatools-mcp Server                          │
├──────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌────────────┐  │
│  │    MCP      │  │   Direct    │  │    REST     │  │    A2A     │  │
│  │  Transport  │  │   Client    │  │     API     │  │  Protocol  │  │
│  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘  └─────┬──────┘  │
│         │                │                │               │          │
│         └────────────────┴────────┬───────┴───────────────┘          │
│                                   │                                  │
│                          ┌────────┴────────┐                         │
│                          │    toolset      │                         │
│                          │   Composer      │                         │
│                          └────────┬────────┘                         │
│                                   │                                  │
│         ┌─────────────────────────┼─────────────────────────┐        │
│         │                         │                         │        │
│  ┌──────┴──────┐  ┌──────────────┴──────────────┐  ┌───────┴──────┐ │
│  │   Toolset   │  │        Toolset              │  │   Toolset    │ │
│  │  &quot;dev-ops&quot;  │  │      &quot;customer-x&quot;           │  │    &quot;prod&quot;    │ │
│  │ [A,C,E,F]   │  │       [B,D,F]               │  │   [A,B,D]    │ │
│  └──────┬──────┘  └──────────────┬──────────────┘  └───────┬──────┘ │
│         │                         │                         │        │
│         └─────────────────────────┼─────────────────────────┘        │
│                                   │                                  │
│                          ┌────────┴────────┐                         │
│                          │   tooladapter   │                         │
│                          │   (Canonical)   │                         │
│                          └────────┬────────┘                         │
│                                   │                                  │
│    ┌──────────────────────────────┼──────────────────────────────┐   │
│    │              │               │               │              │   │
│ ┌──┴───┐    ┌─────┴────┐   ┌──────┴─────┐  ┌─────┴────┐  ┌──────┴─┐ │
│ │ MCP  │    │  OpenAI  │   │  Anthropic │  │LangChain │  │ OpenAPI│ │
│ │Adapter│   │  Adapter │   │   Adapter  │  │ Adapter  │  │ Adapter│ │
│ └──┬───┘    └─────┬────┘   └──────┬─────┘  └─────┬────┘  └──────┬─┘ │
│    │              │               │               │              │   │
├────┼──────────────┼───────────────┼───────────────┼──────────────┼───┤
│    │              │               │               │              │   │
│ ┌──┴───┐    ┌─────┴────┐   ┌──────┴─────┐  ┌─────┴────┐  ┌──────┴─┐ │
│ │ MCP  │    │ External │   │  External  │  │ External │  │  REST  │ │
│ │Server│    │  OpenAI  │   │  Anthropic │  │LangChain │  │  APIs  │ │
│ └──────┘    │  Tools   │   │   Tools    │  │  Tools   │  │        │ │
│             └──────────┘   └────────────┘  └──────────┘  └────────┘ │
└──────────────────────────────────────────────────────────────────────┘
</code></pre></div> <hr> <h2 id=tool-abstraction-layer>Tool Abstraction Layer<a class=headerlink href=#tool-abstraction-layer title="Permanent link">&para;</a></h2> <h3 id=canonical-tool-interface>Canonical Tool Interface<a class=headerlink href=#canonical-tool-interface title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=c1>// tooladapter/canonical.go</span>

<span class=c1>// CanonicalTool is the protocol-agnostic tool representation</span>
<span class=kd>type</span><span class=w> </span><span class=nx>CanonicalTool</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Identity</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>          </span><span class=kt>string</span><span class=w>            </span><span class=c1>// Globally unique identifier</span>
<span class=w>    </span><span class=nx>Namespace</span><span class=w>   </span><span class=kt>string</span><span class=w>            </span><span class=c1>// Source namespace (e.g., &quot;mcp.github&quot;, &quot;openai.functions&quot;)</span>
<span class=w>    </span><span class=nx>Name</span><span class=w>        </span><span class=kt>string</span><span class=w>            </span><span class=c1>// Tool name within namespace</span>
<span class=w>    </span><span class=nx>Version</span><span class=w>     </span><span class=kt>string</span><span class=w>            </span><span class=c1>// Semantic version</span>

<span class=w>    </span><span class=c1>// Metadata</span>
<span class=w>    </span><span class=nx>Description</span><span class=w> </span><span class=kt>string</span><span class=w>            </span><span class=c1>// Human-readable description</span>
<span class=w>    </span><span class=nx>Category</span><span class=w>    </span><span class=kt>string</span><span class=w>            </span><span class=c1>// Tool category for grouping</span>
<span class=w>    </span><span class=nx>Tags</span><span class=w>        </span><span class=p>[]</span><span class=kt>string</span><span class=w>          </span><span class=c1>// Searchable tags</span>

<span class=w>    </span><span class=c1>// Schema (superset of all protocol schemas)</span>
<span class=w>    </span><span class=nx>InputSchema</span><span class=w>  </span><span class=o>*</span><span class=nx>JSONSchema</span><span class=w>      </span><span class=c1>// Full JSON Schema for inputs</span>
<span class=w>    </span><span class=nx>OutputSchema</span><span class=w> </span><span class=o>*</span><span class=nx>JSONSchema</span><span class=w>      </span><span class=c1>// Optional output schema</span>

<span class=w>    </span><span class=c1>// Execution</span>
<span class=w>    </span><span class=nx>Handler</span><span class=w>     </span><span class=nx>ToolHandler</span><span class=w>       </span><span class=c1>// Execution function</span>
<span class=w>    </span><span class=nx>Timeout</span><span class=w>     </span><span class=nx>time</span><span class=p>.</span><span class=nx>Duration</span><span class=w>     </span><span class=c1>// Execution timeout</span>

<span class=w>    </span><span class=c1>// Source tracking</span>
<span class=w>    </span><span class=nx>SourceFormat</span><span class=w> </span><span class=kt>string</span><span class=w>           </span><span class=c1>// Original format (mcp, openai, anthropic, etc.)</span>
<span class=w>    </span><span class=nx>SourceMeta</span><span class=w>   </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span><span class=w>   </span><span class=c1>// Protocol-specific metadata preserved</span>

<span class=w>    </span><span class=c1>// Access control</span>
<span class=w>    </span><span class=nx>RequiredScopes</span><span class=w> </span><span class=p>[]</span><span class=kt>string</span><span class=w>       </span><span class=c1>// OAuth scopes or permissions required</span>
<span class=p>}</span>

<span class=c1>// JSONSchema represents a full JSON Schema with all features</span>
<span class=kd>type</span><span class=w> </span><span class=nx>JSONSchema</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Type</span><span class=w>        </span><span class=kt>string</span><span class=w>                 </span><span class=s>`json:&quot;type&quot;`</span>
<span class=w>    </span><span class=nx>Properties</span><span class=w>  </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=o>*</span><span class=nx>JSONSchema</span><span class=w> </span><span class=s>`json:&quot;properties,omitempty&quot;`</span>
<span class=w>    </span><span class=nx>Required</span><span class=w>    </span><span class=p>[]</span><span class=kt>string</span><span class=w>               </span><span class=s>`json:&quot;required,omitempty&quot;`</span>
<span class=w>    </span><span class=nx>Items</span><span class=w>       </span><span class=o>*</span><span class=nx>JSONSchema</span><span class=w>            </span><span class=s>`json:&quot;items,omitempty&quot;`</span>
<span class=w>    </span><span class=nx>Description</span><span class=w> </span><span class=kt>string</span><span class=w>                 </span><span class=s>`json:&quot;description,omitempty&quot;`</span>

<span class=w>    </span><span class=c1>// Extended schema features (preserved during conversion)</span>
<span class=w>    </span><span class=nx>Enum</span><span class=w>        </span><span class=p>[]</span><span class=kt>any</span><span class=w>                  </span><span class=s>`json:&quot;enum,omitempty&quot;`</span>
<span class=w>    </span><span class=nx>Const</span><span class=w>       </span><span class=kt>any</span><span class=w>                    </span><span class=s>`json:&quot;const,omitempty&quot;`</span>
<span class=w>    </span><span class=nx>Default</span><span class=w>     </span><span class=kt>any</span><span class=w>                    </span><span class=s>`json:&quot;default,omitempty&quot;`</span>
<span class=w>    </span><span class=nx>Minimum</span><span class=w>     </span><span class=o>*</span><span class=kt>float64</span><span class=w>               </span><span class=s>`json:&quot;minimum,omitempty&quot;`</span>
<span class=w>    </span><span class=nx>Maximum</span><span class=w>     </span><span class=o>*</span><span class=kt>float64</span><span class=w>               </span><span class=s>`json:&quot;maximum,omitempty&quot;`</span>
<span class=w>    </span><span class=nx>MinLength</span><span class=w>   </span><span class=o>*</span><span class=kt>int</span><span class=w>                   </span><span class=s>`json:&quot;minLength,omitempty&quot;`</span>
<span class=w>    </span><span class=nx>MaxLength</span><span class=w>   </span><span class=o>*</span><span class=kt>int</span><span class=w>                   </span><span class=s>`json:&quot;maxLength,omitempty&quot;`</span>
<span class=w>    </span><span class=nx>Pattern</span><span class=w>     </span><span class=kt>string</span><span class=w>                 </span><span class=s>`json:&quot;pattern,omitempty&quot;`</span>
<span class=w>    </span><span class=nx>Format</span><span class=w>      </span><span class=kt>string</span><span class=w>                 </span><span class=s>`json:&quot;format,omitempty&quot;`</span>

<span class=w>    </span><span class=c1>// JSON Schema draft compatibility</span>
<span class=w>    </span><span class=nx>Ref</span><span class=w>         </span><span class=kt>string</span><span class=w>                 </span><span class=s>`json:&quot;$ref,omitempty&quot;`</span>
<span class=w>    </span><span class=nx>Defs</span><span class=w>        </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=o>*</span><span class=nx>JSONSchema</span><span class=w> </span><span class=s>`json:&quot;$defs,omitempty&quot;`</span>
<span class=p>}</span>

<span class=c1>// ToolHandler executes the tool</span>
<span class=kd>type</span><span class=w> </span><span class=nx>ToolHandler</span><span class=w> </span><span class=kd>func</span><span class=p>(</span><span class=nx>ctx</span><span class=w> </span><span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span><span class=w> </span><span class=nx>input</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=kt>any</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>
</code></pre></div> <h3 id=adapter-interface>Adapter Interface<a class=headerlink href=#adapter-interface title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=c1>// tooladapter/adapter.go</span>

<span class=c1>// Adapter converts between canonical and protocol-specific formats</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Adapter</span><span class=w> </span><span class=kd>interface</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Name returns the adapter identifier (e.g., &quot;mcp&quot;, &quot;openai&quot;)</span>
<span class=w>    </span><span class=nx>Name</span><span class=p>()</span><span class=w> </span><span class=kt>string</span>

<span class=w>    </span><span class=c1>// ToCanonical converts protocol-specific tool to canonical form</span>
<span class=w>    </span><span class=nx>ToCanonical</span><span class=p>(</span><span class=nx>raw</span><span class=w> </span><span class=kt>any</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>CanonicalTool</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>

<span class=w>    </span><span class=c1>// FromCanonical converts canonical tool to protocol-specific form</span>
<span class=w>    </span><span class=nx>FromCanonical</span><span class=p>(</span><span class=nx>tool</span><span class=w> </span><span class=o>*</span><span class=nx>CanonicalTool</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=kt>any</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span>

<span class=w>    </span><span class=c1>// SupportsFeature checks if adapter supports a schema feature</span>
<span class=w>    </span><span class=nx>SupportsFeature</span><span class=p>(</span><span class=nx>feature</span><span class=w> </span><span class=nx>SchemaFeature</span><span class=p>)</span><span class=w> </span><span class=kt>bool</span>
<span class=p>}</span>

<span class=c1>// SchemaFeature represents JSON Schema features that may not be universally supported</span>
<span class=kd>type</span><span class=w> </span><span class=nx>SchemaFeature</span><span class=w> </span><span class=kt>int</span>

<span class=kd>const</span><span class=w> </span><span class=p>(</span>
<span class=w>    </span><span class=nx>FeatureNestedObjects</span><span class=w> </span><span class=nx>SchemaFeature</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=kc>iota</span>
<span class=w>    </span><span class=nx>FeatureArrays</span>
<span class=w>    </span><span class=nx>FeatureEnums</span>
<span class=w>    </span><span class=nx>FeaturePatternValidation</span>
<span class=w>    </span><span class=nx>FeatureRefDefinitions</span>
<span class=w>    </span><span class=nx>FeatureNullable</span>
<span class=w>    </span><span class=nx>FeatureAnyOf</span>
<span class=w>    </span><span class=nx>FeatureOneOf</span>
<span class=p>)</span>
</code></pre></div> <hr> <h2 id=protocol-adapters>Protocol Adapters<a class=headerlink href=#protocol-adapters title="Permanent link">&para;</a></h2> <h3 id=mcp-adapter>MCP Adapter<a class=headerlink href=#mcp-adapter title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=c1>// tooladapter/adapters/mcp.go</span>

<span class=kd>type</span><span class=w> </span><span class=nx>MCPAdapter</span><span class=w> </span><span class=kd>struct</span><span class=p>{}</span>

<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>a</span><span class=w> </span><span class=o>*</span><span class=nx>MCPAdapter</span><span class=p>)</span><span class=w> </span><span class=nx>Name</span><span class=p>()</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=s>&quot;mcp&quot;</span><span class=w> </span><span class=p>}</span>

<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>a</span><span class=w> </span><span class=o>*</span><span class=nx>MCPAdapter</span><span class=p>)</span><span class=w> </span><span class=nx>ToCanonical</span><span class=p>(</span><span class=nx>raw</span><span class=w> </span><span class=kt>any</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>CanonicalTool</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>mcpTool</span><span class=p>,</span><span class=w> </span><span class=nx>ok</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>raw</span><span class=p>.(</span><span class=o>*</span><span class=nx>mcp</span><span class=p>.</span><span class=nx>Tool</span><span class=p>)</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>!</span><span class=nx>ok</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=p>,</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Errorf</span><span class=p>(</span><span class=s>&quot;expected *mcp.Tool, got %T&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>raw</span><span class=p>)</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&amp;</span><span class=nx>CanonicalTool</span><span class=p>{</span>
<span class=w>        </span><span class=nx>ID</span><span class=p>:</span><span class=w>          </span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Sprintf</span><span class=p>(</span><span class=s>&quot;mcp.%s&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>mcpTool</span><span class=p>.</span><span class=nx>Name</span><span class=p>),</span>
<span class=w>        </span><span class=nx>Namespace</span><span class=p>:</span><span class=w>   </span><span class=s>&quot;mcp&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nx>Name</span><span class=p>:</span><span class=w>        </span><span class=nx>mcpTool</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span>
<span class=w>        </span><span class=nx>Description</span><span class=p>:</span><span class=w> </span><span class=nx>mcpTool</span><span class=p>.</span><span class=nx>Description</span><span class=p>,</span>
<span class=w>        </span><span class=nx>InputSchema</span><span class=p>:</span><span class=w> </span><span class=nx>convertMCPSchema</span><span class=p>(</span><span class=nx>mcpTool</span><span class=p>.</span><span class=nx>InputSchema</span><span class=p>),</span>
<span class=w>        </span><span class=nx>SourceFormat</span><span class=p>:</span><span class=w> </span><span class=s>&quot;mcp&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nx>SourceMeta</span><span class=p>:</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span><span class=p>{</span>
<span class=w>            </span><span class=s>&quot;annotations&quot;</span><span class=p>:</span><span class=w> </span><span class=nx>mcpTool</span><span class=p>.</span><span class=nx>Annotations</span><span class=p>,</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=kc>nil</span>
<span class=p>}</span>

<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>a</span><span class=w> </span><span class=o>*</span><span class=nx>MCPAdapter</span><span class=p>)</span><span class=w> </span><span class=nx>FromCanonical</span><span class=p>(</span><span class=nx>tool</span><span class=w> </span><span class=o>*</span><span class=nx>CanonicalTool</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=kt>any</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&amp;</span><span class=nx>mcp</span><span class=p>.</span><span class=nx>Tool</span><span class=p>{</span>
<span class=w>        </span><span class=nx>Name</span><span class=p>:</span><span class=w>        </span><span class=nx>tool</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span>
<span class=w>        </span><span class=nx>Description</span><span class=p>:</span><span class=w> </span><span class=nx>tool</span><span class=p>.</span><span class=nx>Description</span><span class=p>,</span>
<span class=w>        </span><span class=nx>InputSchema</span><span class=p>:</span><span class=w> </span><span class=nx>convertToMCPSchema</span><span class=p>(</span><span class=nx>tool</span><span class=p>.</span><span class=nx>InputSchema</span><span class=p>),</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=kc>nil</span>
<span class=p>}</span>

<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>a</span><span class=w> </span><span class=o>*</span><span class=nx>MCPAdapter</span><span class=p>)</span><span class=w> </span><span class=nx>SupportsFeature</span><span class=p>(</span><span class=nx>f</span><span class=w> </span><span class=nx>SchemaFeature</span><span class=p>)</span><span class=w> </span><span class=kt>bool</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// MCP supports full JSON Schema</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=kc>true</span>
<span class=p>}</span>
</code></pre></div> <h3 id=openai-adapter>OpenAI Adapter<a class=headerlink href=#openai-adapter title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=c1>// tooladapter/adapters/openai.go</span>

<span class=kd>type</span><span class=w> </span><span class=nx>OpenAIAdapter</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>StrictMode</span><span class=w> </span><span class=kt>bool</span><span class=w> </span><span class=c1>// Enable OpenAI&#39;s strict schema mode</span>
<span class=p>}</span>

<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>a</span><span class=w> </span><span class=o>*</span><span class=nx>OpenAIAdapter</span><span class=p>)</span><span class=w> </span><span class=nx>Name</span><span class=p>()</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=s>&quot;openai&quot;</span><span class=w> </span><span class=p>}</span>

<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>a</span><span class=w> </span><span class=o>*</span><span class=nx>OpenAIAdapter</span><span class=p>)</span><span class=w> </span><span class=nx>ToCanonical</span><span class=p>(</span><span class=nx>raw</span><span class=w> </span><span class=kt>any</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>CanonicalTool</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>fn</span><span class=p>,</span><span class=w> </span><span class=nx>ok</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>raw</span><span class=p>.(</span><span class=o>*</span><span class=nx>OpenAIFunction</span><span class=p>)</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>!</span><span class=nx>ok</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=p>,</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Errorf</span><span class=p>(</span><span class=s>&quot;expected *OpenAIFunction, got %T&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>raw</span><span class=p>)</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&amp;</span><span class=nx>CanonicalTool</span><span class=p>{</span>
<span class=w>        </span><span class=nx>ID</span><span class=p>:</span><span class=w>          </span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Sprintf</span><span class=p>(</span><span class=s>&quot;openai.%s&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>fn</span><span class=p>.</span><span class=nx>Name</span><span class=p>),</span>
<span class=w>        </span><span class=nx>Namespace</span><span class=p>:</span><span class=w>   </span><span class=s>&quot;openai&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nx>Name</span><span class=p>:</span><span class=w>        </span><span class=nx>fn</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span>
<span class=w>        </span><span class=nx>Description</span><span class=p>:</span><span class=w> </span><span class=nx>fn</span><span class=p>.</span><span class=nx>Description</span><span class=p>,</span>
<span class=w>        </span><span class=nx>InputSchema</span><span class=p>:</span><span class=w> </span><span class=nx>convertOpenAIParameters</span><span class=p>(</span><span class=nx>fn</span><span class=p>.</span><span class=nx>Parameters</span><span class=p>),</span>
<span class=w>        </span><span class=nx>SourceFormat</span><span class=p>:</span><span class=w> </span><span class=s>&quot;openai&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nx>SourceMeta</span><span class=p>:</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span><span class=p>{</span>
<span class=w>            </span><span class=s>&quot;strict&quot;</span><span class=p>:</span><span class=w> </span><span class=nx>fn</span><span class=p>.</span><span class=nx>Strict</span><span class=p>,</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=kc>nil</span>
<span class=p>}</span>

<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>a</span><span class=w> </span><span class=o>*</span><span class=nx>OpenAIAdapter</span><span class=p>)</span><span class=w> </span><span class=nx>FromCanonical</span><span class=p>(</span><span class=nx>tool</span><span class=w> </span><span class=o>*</span><span class=nx>CanonicalTool</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=kt>any</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>params</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>convertToOpenAIParameters</span><span class=p>(</span><span class=nx>tool</span><span class=p>.</span><span class=nx>InputSchema</span><span class=p>,</span><span class=w> </span><span class=nx>a</span><span class=p>.</span><span class=nx>StrictMode</span><span class=p>)</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&amp;</span><span class=nx>OpenAIFunction</span><span class=p>{</span>
<span class=w>        </span><span class=nx>Name</span><span class=p>:</span><span class=w>        </span><span class=nx>tool</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span>
<span class=w>        </span><span class=nx>Description</span><span class=p>:</span><span class=w> </span><span class=nx>tool</span><span class=p>.</span><span class=nx>Description</span><span class=p>,</span>
<span class=w>        </span><span class=nx>Parameters</span><span class=p>:</span><span class=w>  </span><span class=nx>params</span><span class=p>,</span>
<span class=w>        </span><span class=nx>Strict</span><span class=p>:</span><span class=w>      </span><span class=nx>a</span><span class=p>.</span><span class=nx>StrictMode</span><span class=p>,</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=kc>nil</span>
<span class=p>}</span>

<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>a</span><span class=w> </span><span class=o>*</span><span class=nx>OpenAIAdapter</span><span class=p>)</span><span class=w> </span><span class=nx>SupportsFeature</span><span class=p>(</span><span class=nx>f</span><span class=w> </span><span class=nx>SchemaFeature</span><span class=p>)</span><span class=w> </span><span class=kt>bool</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>switch</span><span class=w> </span><span class=nx>f</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>case</span><span class=w> </span><span class=nx>FeatureRefDefinitions</span><span class=p>:</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>false</span><span class=w> </span><span class=c1>// OpenAI doesn&#39;t support $ref</span>
<span class=w>    </span><span class=k>case</span><span class=w> </span><span class=nx>FeaturePatternValidation</span><span class=p>:</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>a</span><span class=p>.</span><span class=nx>StrictMode</span><span class=w> </span><span class=c1>// Only in strict mode</span>
<span class=w>    </span><span class=k>default</span><span class=p>:</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>true</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=c1>// OpenAI function format</span>
<span class=kd>type</span><span class=w> </span><span class=nx>OpenAIFunction</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Name</span><span class=w>        </span><span class=kt>string</span><span class=w>         </span><span class=s>`json:&quot;name&quot;`</span>
<span class=w>    </span><span class=nx>Description</span><span class=w> </span><span class=kt>string</span><span class=w>         </span><span class=s>`json:&quot;description,omitempty&quot;`</span>
<span class=w>    </span><span class=nx>Parameters</span><span class=w>  </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span><span class=w> </span><span class=s>`json:&quot;parameters&quot;`</span>
<span class=w>    </span><span class=nx>Strict</span><span class=w>      </span><span class=kt>bool</span><span class=w>           </span><span class=s>`json:&quot;strict,omitempty&quot;`</span>
<span class=p>}</span>
</code></pre></div> <h3 id=anthropic-adapter>Anthropic Adapter<a class=headerlink href=#anthropic-adapter title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=c1>// tooladapter/adapters/anthropic.go</span>

<span class=kd>type</span><span class=w> </span><span class=nx>AnthropicAdapter</span><span class=w> </span><span class=kd>struct</span><span class=p>{}</span>

<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>a</span><span class=w> </span><span class=o>*</span><span class=nx>AnthropicAdapter</span><span class=p>)</span><span class=w> </span><span class=nx>Name</span><span class=p>()</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=s>&quot;anthropic&quot;</span><span class=w> </span><span class=p>}</span>

<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>a</span><span class=w> </span><span class=o>*</span><span class=nx>AnthropicAdapter</span><span class=p>)</span><span class=w> </span><span class=nx>ToCanonical</span><span class=p>(</span><span class=nx>raw</span><span class=w> </span><span class=kt>any</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>CanonicalTool</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>tool</span><span class=p>,</span><span class=w> </span><span class=nx>ok</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>raw</span><span class=p>.(</span><span class=o>*</span><span class=nx>AnthropicTool</span><span class=p>)</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>!</span><span class=nx>ok</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=p>,</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Errorf</span><span class=p>(</span><span class=s>&quot;expected *AnthropicTool, got %T&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>raw</span><span class=p>)</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&amp;</span><span class=nx>CanonicalTool</span><span class=p>{</span>
<span class=w>        </span><span class=nx>ID</span><span class=p>:</span><span class=w>          </span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Sprintf</span><span class=p>(</span><span class=s>&quot;anthropic.%s&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>tool</span><span class=p>.</span><span class=nx>Name</span><span class=p>),</span>
<span class=w>        </span><span class=nx>Namespace</span><span class=p>:</span><span class=w>   </span><span class=s>&quot;anthropic&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=nx>Name</span><span class=p>:</span><span class=w>        </span><span class=nx>tool</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span>
<span class=w>        </span><span class=nx>Description</span><span class=p>:</span><span class=w> </span><span class=nx>tool</span><span class=p>.</span><span class=nx>Description</span><span class=p>,</span>
<span class=w>        </span><span class=nx>InputSchema</span><span class=p>:</span><span class=w> </span><span class=nx>convertAnthropicSchema</span><span class=p>(</span><span class=nx>tool</span><span class=p>.</span><span class=nx>InputSchema</span><span class=p>),</span>
<span class=w>        </span><span class=nx>SourceFormat</span><span class=p>:</span><span class=w> </span><span class=s>&quot;anthropic&quot;</span><span class=p>,</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=kc>nil</span>
<span class=p>}</span>

<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>a</span><span class=w> </span><span class=o>*</span><span class=nx>AnthropicAdapter</span><span class=p>)</span><span class=w> </span><span class=nx>FromCanonical</span><span class=p>(</span><span class=nx>tool</span><span class=w> </span><span class=o>*</span><span class=nx>CanonicalTool</span><span class=p>)</span><span class=w> </span><span class=p>(</span><span class=kt>any</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&amp;</span><span class=nx>AnthropicTool</span><span class=p>{</span>
<span class=w>        </span><span class=nx>Name</span><span class=p>:</span><span class=w>        </span><span class=nx>tool</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span>
<span class=w>        </span><span class=nx>Description</span><span class=p>:</span><span class=w> </span><span class=nx>tool</span><span class=p>.</span><span class=nx>Description</span><span class=p>,</span>
<span class=w>        </span><span class=nx>InputSchema</span><span class=p>:</span><span class=w> </span><span class=nx>convertToAnthropicSchema</span><span class=p>(</span><span class=nx>tool</span><span class=p>.</span><span class=nx>InputSchema</span><span class=p>),</span>
<span class=w>    </span><span class=p>},</span><span class=w> </span><span class=kc>nil</span>
<span class=p>}</span>

<span class=c1>// AnthropicTool matches Anthropic&#39;s tool format</span>
<span class=kd>type</span><span class=w> </span><span class=nx>AnthropicTool</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>Name</span><span class=w>        </span><span class=kt>string</span><span class=w>         </span><span class=s>`json:&quot;name&quot;`</span>
<span class=w>    </span><span class=nx>Description</span><span class=w> </span><span class=kt>string</span><span class=w>         </span><span class=s>`json:&quot;description,omitempty&quot;`</span>
<span class=w>    </span><span class=nx>InputSchema</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span><span class=w> </span><span class=s>`json:&quot;input_schema&quot;`</span>
<span class=p>}</span>
</code></pre></div> <h3 id=schema-conversion-utilities>Schema Conversion Utilities<a class=headerlink href=#schema-conversion-utilities title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=c1>// tooladapter/schema/convert.go</span>

<span class=c1>// StripUnsupportedFeatures removes schema features not supported by target</span>
<span class=kd>func</span><span class=w> </span><span class=nx>StripUnsupportedFeatures</span><span class=p>(</span><span class=nx>schema</span><span class=w> </span><span class=o>*</span><span class=nx>JSONSchema</span><span class=p>,</span><span class=w> </span><span class=nx>adapter</span><span class=w> </span><span class=nx>Adapter</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>JSONSchema</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>result</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>schema</span><span class=p>.</span><span class=nx>DeepCopy</span><span class=p>()</span>

<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>!</span><span class=nx>adapter</span><span class=p>.</span><span class=nx>SupportsFeature</span><span class=p>(</span><span class=nx>FeatureRefDefinitions</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>result</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>resolveRefs</span><span class=p>(</span><span class=nx>result</span><span class=p>)</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>!</span><span class=nx>adapter</span><span class=p>.</span><span class=nx>SupportsFeature</span><span class=p>(</span><span class=nx>FeaturePatternValidation</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>clearPatterns</span><span class=p>(</span><span class=nx>result</span><span class=p>)</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>!</span><span class=nx>adapter</span><span class=p>.</span><span class=nx>SupportsFeature</span><span class=p>(</span><span class=nx>FeatureAnyOf</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>result</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>flattenAnyOf</span><span class=p>(</span><span class=nx>result</span><span class=p>)</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>result</span>
<span class=p>}</span>

<span class=c1>// PreserveSemantics records stripped features for potential restoration</span>
<span class=kd>func</span><span class=w> </span><span class=nx>PreserveSemantics</span><span class=p>(</span><span class=nx>original</span><span class=p>,</span><span class=w> </span><span class=nx>stripped</span><span class=w> </span><span class=o>*</span><span class=nx>JSONSchema</span><span class=p>)</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span><span class=p>{</span>
<span class=w>        </span><span class=s>&quot;original_features&quot;</span><span class=p>:</span><span class=w> </span><span class=nx>detectFeatures</span><span class=p>(</span><span class=nx>original</span><span class=p>),</span>
<span class=w>        </span><span class=s>&quot;stripped_features&quot;</span><span class=p>:</span><span class=w> </span><span class=nx>detectStrippedFeatures</span><span class=p>(</span><span class=nx>original</span><span class=p>,</span><span class=w> </span><span class=nx>stripped</span><span class=p>),</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <hr> <h2 id=composable-toolsets>Composable Toolsets<a class=headerlink href=#composable-toolsets title="Permanent link">&para;</a></h2> <h3 id=toolset-definition>Toolset Definition<a class=headerlink href=#toolset-definition title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=c1>// toolset/set.go</span>

<span class=c1>// Toolset represents a curated collection of tools</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Toolset</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>ID</span><span class=w>          </span><span class=kt>string</span><span class=w>                 </span><span class=c1>// Unique identifier</span>
<span class=w>    </span><span class=nx>Name</span><span class=w>        </span><span class=kt>string</span><span class=w>                 </span><span class=c1>// Human-readable name</span>
<span class=w>    </span><span class=nx>Description</span><span class=w> </span><span class=kt>string</span><span class=w>                 </span><span class=c1>// Purpose description</span>

<span class=w>    </span><span class=c1>// Tool selection</span>
<span class=w>    </span><span class=nx>Tools</span><span class=w>       </span><span class=p>[]</span><span class=o>*</span><span class=nx>tooladapter</span><span class=p>.</span><span class=nx>CanonicalTool</span>

<span class=w>    </span><span class=c1>// Metadata</span>
<span class=w>    </span><span class=nx>Tags</span><span class=w>        </span><span class=p>[]</span><span class=kt>string</span><span class=w>               </span><span class=c1>// Searchable tags</span>
<span class=w>    </span><span class=nx>Owner</span><span class=w>       </span><span class=kt>string</span><span class=w>                 </span><span class=c1>// Owner/tenant ID</span>
<span class=w>    </span><span class=nx>CreatedAt</span><span class=w>   </span><span class=nx>time</span><span class=p>.</span><span class=nx>Time</span>
<span class=w>    </span><span class=nx>UpdatedAt</span><span class=w>   </span><span class=nx>time</span><span class=p>.</span><span class=nx>Time</span>

<span class=w>    </span><span class=c1>// Access control</span>
<span class=w>    </span><span class=nx>Policy</span><span class=w>      </span><span class=o>*</span><span class=nx>AccessPolicy</span>
<span class=p>}</span>

<span class=c1>// AccessPolicy controls who can use the toolset</span>
<span class=kd>type</span><span class=w> </span><span class=nx>AccessPolicy</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>AllowedTenants</span><span class=w> </span><span class=p>[]</span><span class=kt>string</span><span class=w>           </span><span class=c1>// Tenant IDs that can access</span>
<span class=w>    </span><span class=nx>AllowedRoles</span><span class=w>   </span><span class=p>[]</span><span class=kt>string</span><span class=w>           </span><span class=c1>// Role-based access</span>
<span class=w>    </span><span class=nx>RateLimit</span><span class=w>      </span><span class=o>*</span><span class=nx>RateLimitConfig</span><span class=w>   </span><span class=c1>// Optional rate limiting</span>
<span class=w>    </span><span class=nx>AuditLog</span><span class=w>       </span><span class=kt>bool</span><span class=w>               </span><span class=c1>// Enable audit logging</span>
<span class=p>}</span>
</code></pre></div> <h3 id=fluent-builder>Fluent Builder<a class=headerlink href=#fluent-builder title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=c1>// toolset/builder.go</span>

<span class=c1>// Builder provides fluent toolset construction</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Builder</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>set</span><span class=w>      </span><span class=o>*</span><span class=nx>Toolset</span>
<span class=w>    </span><span class=nx>registry</span><span class=w> </span><span class=o>*</span><span class=nx>tooladapter</span><span class=p>.</span><span class=nx>Registry</span>
<span class=w>    </span><span class=nx>filters</span><span class=w>  </span><span class=p>[]</span><span class=nx>FilterFunc</span>
<span class=p>}</span>

<span class=c1>// NewBuilder creates a new toolset builder</span>
<span class=kd>func</span><span class=w> </span><span class=nx>NewBuilder</span><span class=p>(</span><span class=nx>name</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&amp;</span><span class=nx>Builder</span><span class=p>{</span>
<span class=w>        </span><span class=nx>set</span><span class=p>:</span><span class=w> </span><span class=o>&amp;</span><span class=nx>Toolset</span><span class=p>{</span>
<span class=w>            </span><span class=nx>ID</span><span class=p>:</span><span class=w>   </span><span class=nx>uuid</span><span class=p>.</span><span class=nx>New</span><span class=p>().</span><span class=nx>String</span><span class=p>(),</span>
<span class=w>            </span><span class=nx>Name</span><span class=p>:</span><span class=w> </span><span class=nx>name</span><span class=p>,</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=c1>// FromRegistry loads tools from an adapter registry</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=p>)</span><span class=w> </span><span class=nx>FromRegistry</span><span class=p>(</span><span class=nx>reg</span><span class=w> </span><span class=o>*</span><span class=nx>tooladapter</span><span class=p>.</span><span class=nx>Registry</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>b</span><span class=p>.</span><span class=nx>registry</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>reg</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>b</span>
<span class=p>}</span>

<span class=c1>// WithNamespace includes tools from a specific namespace</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=p>)</span><span class=w> </span><span class=nx>WithNamespace</span><span class=p>(</span><span class=nx>ns</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>b</span><span class=p>.</span><span class=nx>filters</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nb>append</span><span class=p>(</span><span class=nx>b</span><span class=p>.</span><span class=nx>filters</span><span class=p>,</span><span class=w> </span><span class=kd>func</span><span class=p>(</span><span class=nx>t</span><span class=w> </span><span class=o>*</span><span class=nx>tooladapter</span><span class=p>.</span><span class=nx>CanonicalTool</span><span class=p>)</span><span class=w> </span><span class=kt>bool</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>t</span><span class=p>.</span><span class=nx>Namespace</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=nx>ns</span>
<span class=w>    </span><span class=p>})</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>b</span>
<span class=p>}</span>

<span class=c1>// WithTags includes tools with any of the specified tags</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=p>)</span><span class=w> </span><span class=nx>WithTags</span><span class=p>(</span><span class=nx>tags</span><span class=w> </span><span class=o>...</span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>tagSet</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>bool</span><span class=p>)</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>t</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>range</span><span class=w> </span><span class=nx>tags</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>tagSet</span><span class=p>[</span><span class=nx>t</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=kc>true</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=nx>b</span><span class=p>.</span><span class=nx>filters</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nb>append</span><span class=p>(</span><span class=nx>b</span><span class=p>.</span><span class=nx>filters</span><span class=p>,</span><span class=w> </span><span class=kd>func</span><span class=p>(</span><span class=nx>t</span><span class=w> </span><span class=o>*</span><span class=nx>tooladapter</span><span class=p>.</span><span class=nx>CanonicalTool</span><span class=p>)</span><span class=w> </span><span class=kt>bool</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>for</span><span class=w> </span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>tag</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>range</span><span class=w> </span><span class=nx>t</span><span class=p>.</span><span class=nx>Tags</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=k>if</span><span class=w> </span><span class=nx>tagSet</span><span class=p>[</span><span class=nx>tag</span><span class=p>]</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=k>return</span><span class=w> </span><span class=kc>true</span>
<span class=w>            </span><span class=p>}</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>false</span>
<span class=w>    </span><span class=p>})</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>b</span>
<span class=p>}</span>

<span class=c1>// WithTools includes specific tools by ID</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=p>)</span><span class=w> </span><span class=nx>WithTools</span><span class=p>(</span><span class=nx>ids</span><span class=w> </span><span class=o>...</span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>idSet</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>bool</span><span class=p>)</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>id</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>range</span><span class=w> </span><span class=nx>ids</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>idSet</span><span class=p>[</span><span class=nx>id</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=kc>true</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=nx>b</span><span class=p>.</span><span class=nx>filters</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nb>append</span><span class=p>(</span><span class=nx>b</span><span class=p>.</span><span class=nx>filters</span><span class=p>,</span><span class=w> </span><span class=kd>func</span><span class=p>(</span><span class=nx>t</span><span class=w> </span><span class=o>*</span><span class=nx>tooladapter</span><span class=p>.</span><span class=nx>CanonicalTool</span><span class=p>)</span><span class=w> </span><span class=kt>bool</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>idSet</span><span class=p>[</span><span class=nx>t</span><span class=p>.</span><span class=nx>ID</span><span class=p>]</span>
<span class=w>    </span><span class=p>})</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>b</span>
<span class=p>}</span>

<span class=c1>// WithCategory includes tools from a category</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=p>)</span><span class=w> </span><span class=nx>WithCategory</span><span class=p>(</span><span class=nx>cat</span><span class=w> </span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>b</span><span class=p>.</span><span class=nx>filters</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nb>append</span><span class=p>(</span><span class=nx>b</span><span class=p>.</span><span class=nx>filters</span><span class=p>,</span><span class=w> </span><span class=kd>func</span><span class=p>(</span><span class=nx>t</span><span class=w> </span><span class=o>*</span><span class=nx>tooladapter</span><span class=p>.</span><span class=nx>CanonicalTool</span><span class=p>)</span><span class=w> </span><span class=kt>bool</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>t</span><span class=p>.</span><span class=nx>Category</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=nx>cat</span>
<span class=w>    </span><span class=p>})</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>b</span>
<span class=p>}</span>

<span class=c1>// ExcludeTools removes specific tools by ID</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=p>)</span><span class=w> </span><span class=nx>ExcludeTools</span><span class=p>(</span><span class=nx>ids</span><span class=w> </span><span class=o>...</span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>idSet</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>bool</span><span class=p>)</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>id</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>range</span><span class=w> </span><span class=nx>ids</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>idSet</span><span class=p>[</span><span class=nx>id</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=kc>true</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=nx>b</span><span class=p>.</span><span class=nx>filters</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nb>append</span><span class=p>(</span><span class=nx>b</span><span class=p>.</span><span class=nx>filters</span><span class=p>,</span><span class=w> </span><span class=kd>func</span><span class=p>(</span><span class=nx>t</span><span class=w> </span><span class=o>*</span><span class=nx>tooladapter</span><span class=p>.</span><span class=nx>CanonicalTool</span><span class=p>)</span><span class=w> </span><span class=kt>bool</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>!</span><span class=nx>idSet</span><span class=p>[</span><span class=nx>t</span><span class=p>.</span><span class=nx>ID</span><span class=p>]</span>
<span class=w>    </span><span class=p>})</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>b</span>
<span class=p>}</span>

<span class=c1>// WithPolicy sets access control policy</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=p>)</span><span class=w> </span><span class=nx>WithPolicy</span><span class=p>(</span><span class=nx>p</span><span class=w> </span><span class=o>*</span><span class=nx>AccessPolicy</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>b</span><span class=p>.</span><span class=nx>set</span><span class=p>.</span><span class=nx>Policy</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>p</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>b</span>
<span class=p>}</span>

<span class=c1>// Build creates the toolset</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>b</span><span class=w> </span><span class=o>*</span><span class=nx>Builder</span><span class=p>)</span><span class=w> </span><span class=nx>Build</span><span class=p>()</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=nx>Toolset</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=nx>b</span><span class=p>.</span><span class=nx>registry</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=p>,</span><span class=w> </span><span class=nx>errors</span><span class=p>.</span><span class=nx>New</span><span class=p>(</span><span class=s>&quot;registry required&quot;</span><span class=p>)</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=nx>allTools</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>b</span><span class=p>.</span><span class=nx>registry</span><span class=p>.</span><span class=nx>All</span><span class=p>()</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>tool</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>range</span><span class=w> </span><span class=nx>allTools</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>include</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=kc>true</span>
<span class=w>        </span><span class=k>for</span><span class=w> </span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>filter</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>range</span><span class=w> </span><span class=nx>b</span><span class=p>.</span><span class=nx>filters</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>!</span><span class=nx>filter</span><span class=p>(</span><span class=nx>tool</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=nx>include</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=kc>false</span>
<span class=w>                </span><span class=k>break</span>
<span class=w>            </span><span class=p>}</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=k>if</span><span class=w> </span><span class=nx>include</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>b</span><span class=p>.</span><span class=nx>set</span><span class=p>.</span><span class=nx>Tools</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nb>append</span><span class=p>(</span><span class=nx>b</span><span class=p>.</span><span class=nx>set</span><span class=p>.</span><span class=nx>Tools</span><span class=p>,</span><span class=w> </span><span class=nx>tool</span><span class=p>)</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=nx>b</span><span class=p>.</span><span class=nx>set</span><span class=p>.</span><span class=nx>CreatedAt</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nx>Now</span><span class=p>()</span>
<span class=w>    </span><span class=nx>b</span><span class=p>.</span><span class=nx>set</span><span class=p>.</span><span class=nx>UpdatedAt</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>time</span><span class=p>.</span><span class=nx>Now</span><span class=p>()</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>b</span><span class=p>.</span><span class=nx>set</span><span class=p>,</span><span class=w> </span><span class=kc>nil</span>
<span class=p>}</span>
</code></pre></div> <h3 id=usage-examples>Usage Examples<a class=headerlink href=#usage-examples title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=c1>// Example: Creating a DevOps toolset</span>
<span class=nx>devOpsSet</span><span class=p>,</span><span class=w> </span><span class=nx>_</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>toolset</span><span class=p>.</span><span class=nx>NewBuilder</span><span class=p>(</span><span class=s>&quot;devops-tools&quot;</span><span class=p>).</span>
<span class=w>    </span><span class=nx>FromRegistry</span><span class=p>(</span><span class=nx>registry</span><span class=p>).</span>
<span class=w>    </span><span class=nx>WithNamespace</span><span class=p>(</span><span class=s>&quot;mcp.github&quot;</span><span class=p>).</span>
<span class=w>    </span><span class=nx>WithNamespace</span><span class=p>(</span><span class=s>&quot;mcp.kubernetes&quot;</span><span class=p>).</span>
<span class=w>    </span><span class=nx>WithTags</span><span class=p>(</span><span class=s>&quot;ci-cd&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;deployment&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;monitoring&quot;</span><span class=p>).</span>
<span class=w>    </span><span class=nx>ExcludeTools</span><span class=p>(</span><span class=s>&quot;mcp.github.delete_repo&quot;</span><span class=p>).</span><span class=w> </span><span class=c1>// Too dangerous</span>
<span class=w>    </span><span class=nx>WithPolicy</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>toolset</span><span class=p>.</span><span class=nx>AccessPolicy</span><span class=p>{</span>
<span class=w>        </span><span class=nx>AllowedRoles</span><span class=p>:</span><span class=w> </span><span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&quot;devops&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;sre&quot;</span><span class=p>},</span>
<span class=w>        </span><span class=nx>AuditLog</span><span class=p>:</span><span class=w>     </span><span class=kc>true</span><span class=p>,</span>
<span class=w>    </span><span class=p>}).</span>
<span class=w>    </span><span class=nx>Build</span><span class=p>()</span>

<span class=c1>// Example: Customer-specific toolset</span>
<span class=nx>customerSet</span><span class=p>,</span><span class=w> </span><span class=nx>_</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>toolset</span><span class=p>.</span><span class=nx>NewBuilder</span><span class=p>(</span><span class=s>&quot;customer-acme&quot;</span><span class=p>).</span>
<span class=w>    </span><span class=nx>FromRegistry</span><span class=p>(</span><span class=nx>registry</span><span class=p>).</span>
<span class=w>    </span><span class=nx>WithTools</span><span class=p>(</span>
<span class=w>        </span><span class=s>&quot;mcp.support.create_ticket&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=s>&quot;mcp.docs.search&quot;</span><span class=p>,</span>
<span class=w>        </span><span class=s>&quot;mcp.billing.get_invoice&quot;</span><span class=p>,</span>
<span class=w>    </span><span class=p>).</span>
<span class=w>    </span><span class=nx>WithPolicy</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>toolset</span><span class=p>.</span><span class=nx>AccessPolicy</span><span class=p>{</span>
<span class=w>        </span><span class=nx>AllowedTenants</span><span class=p>:</span><span class=w> </span><span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&quot;acme-corp&quot;</span><span class=p>},</span>
<span class=w>        </span><span class=nx>RateLimit</span><span class=p>:</span><span class=w> </span><span class=o>&amp;</span><span class=nx>toolset</span><span class=p>.</span><span class=nx>RateLimitConfig</span><span class=p>{</span>
<span class=w>            </span><span class=nx>RequestsPerMinute</span><span class=p>:</span><span class=w> </span><span class=mi>60</span><span class=p>,</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>    </span><span class=p>}).</span>
<span class=w>    </span><span class=nx>Build</span><span class=p>()</span>

<span class=c1>// Example: Production-safe toolset (no destructive operations)</span>
<span class=nx>prodSet</span><span class=p>,</span><span class=w> </span><span class=nx>_</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>toolset</span><span class=p>.</span><span class=nx>NewBuilder</span><span class=p>(</span><span class=s>&quot;production&quot;</span><span class=p>).</span>
<span class=w>    </span><span class=nx>FromRegistry</span><span class=p>(</span><span class=nx>registry</span><span class=p>).</span>
<span class=w>    </span><span class=nx>WithCategory</span><span class=p>(</span><span class=s>&quot;read-only&quot;</span><span class=p>).</span>
<span class=w>    </span><span class=nx>WithTags</span><span class=p>(</span><span class=s>&quot;safe&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;idempotent&quot;</span><span class=p>).</span>
<span class=w>    </span><span class=nx>Build</span><span class=p>()</span>
</code></pre></div> <hr> <h2 id=integration-with-existing-libraries>Integration with Existing Libraries<a class=headerlink href=#integration-with-existing-libraries title="Permanent link">&para;</a></h2> <h3 id=toolindex-integration>toolindex Integration<a class=headerlink href=#toolindex-integration title="Permanent link">&para;</a></h3> <p>The tooladapter library integrates with toolindex for tool discovery:</p> <div class=highlight><pre><span></span><code><span class=c1>// tooladapter/registry.go</span>

<span class=c1>// Registry manages tools from multiple sources</span>
<span class=kd>type</span><span class=w> </span><span class=nx>Registry</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>index</span><span class=w>    </span><span class=nx>toolindex</span><span class=p>.</span><span class=nx>Index</span>
<span class=w>    </span><span class=nx>adapters</span><span class=w> </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=nx>Adapter</span>
<span class=w>    </span><span class=nx>tools</span><span class=w>    </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=o>*</span><span class=nx>CanonicalTool</span>
<span class=p>}</span>

<span class=c1>// RegisterAdapter adds a protocol adapter</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>r</span><span class=w> </span><span class=o>*</span><span class=nx>Registry</span><span class=p>)</span><span class=w> </span><span class=nx>RegisterAdapter</span><span class=p>(</span><span class=nx>adapter</span><span class=w> </span><span class=nx>Adapter</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>r</span><span class=p>.</span><span class=nx>adapters</span><span class=p>[</span><span class=nx>adapter</span><span class=p>.</span><span class=nx>Name</span><span class=p>()]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>adapter</span>
<span class=p>}</span>

<span class=c1>// Import loads tools from an external source</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>r</span><span class=w> </span><span class=o>*</span><span class=nx>Registry</span><span class=p>)</span><span class=w> </span><span class=nx>Import</span><span class=p>(</span><span class=nx>format</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>tools</span><span class=w> </span><span class=p>[]</span><span class=kt>any</span><span class=p>)</span><span class=w> </span><span class=kt>error</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>adapter</span><span class=p>,</span><span class=w> </span><span class=nx>ok</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>r</span><span class=p>.</span><span class=nx>adapters</span><span class=p>[</span><span class=nx>format</span><span class=p>]</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>!</span><span class=nx>ok</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Errorf</span><span class=p>(</span><span class=s>&quot;unknown format: %s&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>format</span><span class=p>)</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>raw</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>range</span><span class=w> </span><span class=nx>tools</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>canonical</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>adapter</span><span class=p>.</span><span class=nx>ToCanonical</span><span class=p>(</span><span class=nx>raw</span><span class=p>)</span>
<span class=w>        </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=k>return</span><span class=w> </span><span class=nx>err</span>
<span class=w>        </span><span class=p>}</span>

<span class=w>        </span><span class=nx>r</span><span class=p>.</span><span class=nx>tools</span><span class=p>[</span><span class=nx>canonical</span><span class=p>.</span><span class=nx>ID</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>canonical</span>

<span class=w>        </span><span class=c1>// Register with toolindex for discovery</span>
<span class=w>        </span><span class=nx>r</span><span class=p>.</span><span class=nx>index</span><span class=p>.</span><span class=nx>Register</span><span class=p>(</span><span class=nx>convertToIndexTool</span><span class=p>(</span><span class=nx>canonical</span><span class=p>))</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span>
<span class=p>}</span>

<span class=c1>// Export converts tools to a specific format</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>r</span><span class=w> </span><span class=o>*</span><span class=nx>Registry</span><span class=p>)</span><span class=w> </span><span class=nx>Export</span><span class=p>(</span><span class=nx>format</span><span class=w> </span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=nx>toolIDs</span><span class=w> </span><span class=p>[]</span><span class=kt>string</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=kt>any</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>adapter</span><span class=p>,</span><span class=w> </span><span class=nx>ok</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>r</span><span class=p>.</span><span class=nx>adapters</span><span class=p>[</span><span class=nx>format</span><span class=p>]</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>!</span><span class=nx>ok</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=p>,</span><span class=w> </span><span class=nx>fmt</span><span class=p>.</span><span class=nx>Errorf</span><span class=p>(</span><span class=s>&quot;unknown format: %s&quot;</span><span class=p>,</span><span class=w> </span><span class=nx>format</span><span class=p>)</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kd>var</span><span class=w> </span><span class=nx>result</span><span class=w> </span><span class=p>[]</span><span class=kt>any</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>id</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>range</span><span class=w> </span><span class=nx>toolIDs</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>tool</span><span class=p>,</span><span class=w> </span><span class=nx>ok</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>r</span><span class=p>.</span><span class=nx>tools</span><span class=p>[</span><span class=nx>id</span><span class=p>]</span>
<span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>!</span><span class=nx>ok</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=k>continue</span>
<span class=w>        </span><span class=p>}</span>

<span class=w>        </span><span class=nx>exported</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>adapter</span><span class=p>.</span><span class=nx>FromCanonical</span><span class=p>(</span><span class=nx>tool</span><span class=p>)</span>
<span class=w>        </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=p>,</span><span class=w> </span><span class=nx>err</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=nx>result</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nb>append</span><span class=p>(</span><span class=nx>result</span><span class=p>,</span><span class=w> </span><span class=nx>exported</span><span class=p>)</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>result</span><span class=p>,</span><span class=w> </span><span class=kc>nil</span>
<span class=p>}</span>
</code></pre></div> <h3 id=toolmodel-integration>toolmodel Integration<a class=headerlink href=#toolmodel-integration title="Permanent link">&para;</a></h3> <p>CanonicalTool embeds and extends toolmodel.Tool:</p> <div class=highlight><pre><span></span><code><span class=c1>// tooladapter/canonical.go</span>

<span class=c1>// CanonicalTool extends toolmodel.Tool with adapter metadata</span>
<span class=kd>type</span><span class=w> </span><span class=nx>CanonicalTool</span><span class=w> </span><span class=kd>struct</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>toolmodel</span><span class=p>.</span><span class=nx>Tool</span><span class=w> </span><span class=c1>// Embed base tool</span>

<span class=w>    </span><span class=c1>// Adapter-specific extensions</span>
<span class=w>    </span><span class=nx>SourceFormat</span><span class=w> </span><span class=kt>string</span>
<span class=w>    </span><span class=nx>SourceMeta</span><span class=w>   </span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>any</span>
<span class=w>    </span><span class=nx>OutputSchema</span><span class=w> </span><span class=o>*</span><span class=nx>JSONSchema</span>
<span class=p>}</span>

<span class=c1>// ToToolModel converts to base toolmodel.Tool</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>c</span><span class=w> </span><span class=o>*</span><span class=nx>CanonicalTool</span><span class=p>)</span><span class=w> </span><span class=nx>ToToolModel</span><span class=p>()</span><span class=w> </span><span class=o>*</span><span class=nx>toolmodel</span><span class=p>.</span><span class=nx>Tool</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>&amp;</span><span class=nx>c</span><span class=p>.</span><span class=nx>Tool</span>
<span class=p>}</span>
</code></pre></div> <h3 id=toolrun-integration>toolrun Integration<a class=headerlink href=#toolrun-integration title="Permanent link">&para;</a></h3> <p>Toolsets can be exposed through toolrun for execution:</p> <div class=highlight><pre><span></span><code><span class=c1>// toolset/expose.go</span>

<span class=c1>// ExposeViaMCP creates an MCP-compatible tool list from a toolset</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>ts</span><span class=w> </span><span class=o>*</span><span class=nx>Toolset</span><span class=p>)</span><span class=w> </span><span class=nx>ExposeViaMCP</span><span class=p>(</span><span class=nx>adapter</span><span class=w> </span><span class=o>*</span><span class=nx>adapters</span><span class=p>.</span><span class=nx>MCPAdapter</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=o>*</span><span class=nx>mcp</span><span class=p>.</span><span class=nx>Tool</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>var</span><span class=w> </span><span class=nx>result</span><span class=w> </span><span class=p>[]</span><span class=o>*</span><span class=nx>mcp</span><span class=p>.</span><span class=nx>Tool</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>tool</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>range</span><span class=w> </span><span class=nx>ts</span><span class=p>.</span><span class=nx>Tools</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>mcpTool</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>adapter</span><span class=p>.</span><span class=nx>FromCanonical</span><span class=p>(</span><span class=nx>tool</span><span class=p>)</span>
<span class=w>        </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=p>,</span><span class=w> </span><span class=nx>err</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=nx>result</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nb>append</span><span class=p>(</span><span class=nx>result</span><span class=p>,</span><span class=w> </span><span class=nx>mcpTool</span><span class=p>.(</span><span class=o>*</span><span class=nx>mcp</span><span class=p>.</span><span class=nx>Tool</span><span class=p>))</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>result</span><span class=p>,</span><span class=w> </span><span class=kc>nil</span>
<span class=p>}</span>

<span class=c1>// ExposeViaOpenAI creates OpenAI function definitions from a toolset</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>ts</span><span class=w> </span><span class=o>*</span><span class=nx>Toolset</span><span class=p>)</span><span class=w> </span><span class=nx>ExposeViaOpenAI</span><span class=p>(</span><span class=nx>adapter</span><span class=w> </span><span class=o>*</span><span class=nx>adapters</span><span class=p>.</span><span class=nx>OpenAIAdapter</span><span class=p>)</span><span class=w> </span><span class=p>([]</span><span class=o>*</span><span class=nx>OpenAIFunction</span><span class=p>,</span><span class=w> </span><span class=kt>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>var</span><span class=w> </span><span class=nx>result</span><span class=w> </span><span class=p>[]</span><span class=o>*</span><span class=nx>OpenAIFunction</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>tool</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>range</span><span class=w> </span><span class=nx>ts</span><span class=p>.</span><span class=nx>Tools</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>fn</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>adapter</span><span class=p>.</span><span class=nx>FromCanonical</span><span class=p>(</span><span class=nx>tool</span><span class=p>)</span>
<span class=w>        </span><span class=k>if</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>nil</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=k>return</span><span class=w> </span><span class=kc>nil</span><span class=p>,</span><span class=w> </span><span class=nx>err</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>        </span><span class=nx>result</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nb>append</span><span class=p>(</span><span class=nx>result</span><span class=p>,</span><span class=w> </span><span class=nx>fn</span><span class=p>.(</span><span class=o>*</span><span class=nx>OpenAIFunction</span><span class=p>))</span>
<span class=w>    </span><span class=p>}</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>result</span><span class=p>,</span><span class=w> </span><span class=kc>nil</span>
<span class=p>}</span>

<span class=c1>// CreateRunner creates a toolrun.Runner scoped to the toolset</span>
<span class=kd>func</span><span class=w> </span><span class=p>(</span><span class=nx>ts</span><span class=w> </span><span class=o>*</span><span class=nx>Toolset</span><span class=p>)</span><span class=w> </span><span class=nx>CreateRunner</span><span class=p>(</span><span class=nx>baseRunner</span><span class=w> </span><span class=o>*</span><span class=nx>toolrun</span><span class=p>.</span><span class=nx>Runner</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=nx>toolrun</span><span class=p>.</span><span class=nx>Runner</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Create a filtered view of the runner that only exposes toolset tools</span>
<span class=w>    </span><span class=nx>toolIDs</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>bool</span><span class=p>)</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=nx>_</span><span class=p>,</span><span class=w> </span><span class=nx>t</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=k>range</span><span class=w> </span><span class=nx>ts</span><span class=p>.</span><span class=nx>Tools</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>toolIDs</span><span class=p>[</span><span class=nx>t</span><span class=p>.</span><span class=nx>ID</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=kc>true</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>baseRunner</span><span class=p>.</span><span class=nx>WithFilter</span><span class=p>(</span><span class=kd>func</span><span class=p>(</span><span class=nx>tool</span><span class=w> </span><span class=o>*</span><span class=nx>toolmodel</span><span class=p>.</span><span class=nx>Tool</span><span class=p>)</span><span class=w> </span><span class=kt>bool</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nx>toolIDs</span><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>ID</span><span class=p>()]</span>
<span class=w>    </span><span class=p>})</span>
<span class=p>}</span>
</code></pre></div> <hr> <h2 id=implementation-roadmap>Implementation Roadmap<a class=headerlink href=#implementation-roadmap title="Permanent link">&para;</a></h2> <h3 id=phase-1-core-adapter-library-2-weeks>Phase 1: Core Adapter Library (2 weeks)<a class=headerlink href=#phase-1-core-adapter-library-2-weeks title="Permanent link">&para;</a></h3> <p><strong>Week 1: Foundation</strong> - [ ] Create <code>tooladapter</code> module structure - [ ] Implement <code>CanonicalTool</code> and <code>JSONSchema</code> types - [ ] Implement <code>Adapter</code> interface - [ ] Create MCP adapter (bidirectional)</p> <p><strong>Week 2: Additional Adapters</strong> - [ ] OpenAI adapter with strict mode support - [ ] Anthropic adapter - [ ] Schema conversion utilities - [ ] Unit tests for all adapters</p> <h3 id=phase-2-toolset-composition-2-weeks>Phase 2: Toolset Composition (2 weeks)<a class=headerlink href=#phase-2-toolset-composition-2-weeks title="Permanent link">&para;</a></h3> <p><strong>Week 3: Toolset Core</strong> - [ ] Create <code>toolset</code> module structure - [ ] Implement <code>Toolset</code> type with metadata - [ ] Implement fluent <code>Builder</code> pattern - [ ] Implement filter predicates</p> <p><strong>Week 4: Integration</strong> - [ ] Integrate with <code>toolindex</code> for discovery - [ ] Integrate with <code>toolrun</code> for execution - [ ] Add access control policies - [ ] Integration tests</p> <h3 id=phase-3-multi-transport-exposure-2-weeks>Phase 3: Multi-Transport Exposure (2 weeks)<a class=headerlink href=#phase-3-multi-transport-exposure-2-weeks title="Permanent link">&para;</a></h3> <p><strong>Week 5: Transport Adapters</strong> - [ ] MCP transport (existing, enhanced) - [ ] Direct client interface (Go library) - [ ] REST API transport</p> <p><strong>Week 6: Production Readiness</strong> - [ ] Rate limiting integration - [ ] Audit logging - [ ] Documentation - [ ] Example applications</p> <h3 id=dependency-graph>Dependency Graph<a class=headerlink href=#dependency-graph title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>┌───────────────────────────────────────────────────────────┐
│                    Phase 3: Transports                    │
│            ┌─────────┬─────────┬─────────┐                │
│            │   MCP   │  REST   │ Direct  │                │
│            └────┬────┴────┬────┴────┬────┘                │
│                 │         │         │                     │
│                 └─────────┴────┬────┘                     │
│                                │                          │
├────────────────────────────────┼──────────────────────────┤
│                    Phase 2: Toolsets                      │
│                       ┌────────┴────────┐                 │
│                       │     toolset     │                 │
│                       │   (composer)    │                 │
│                       └────────┬────────┘                 │
│                                │                          │
├────────────────────────────────┼──────────────────────────┤
│                    Phase 1: Adapters                      │
│                       ┌────────┴────────┐                 │
│                       │   tooladapter   │                 │
│                       │   (canonical)   │                 │
│                       └────────┬────────┘                 │
│                                │                          │
│    ┌───────────────────────────┼───────────────────────┐  │
│    │           │               │               │       │  │
│ ┌──┴──┐  ┌─────┴────┐  ┌──────┴─────┐  ┌─────┴────┐   │  │
│ │ MCP │  │ OpenAI   │  │ Anthropic  │  │ OpenAPI  │   │  │
│ └─────┘  └──────────┘  └────────────┘  └──────────┘   │  │
└───────────────────────────────────────────────────────────┘
</code></pre></div> <hr> <h2 id=appendix-industry-patterns>Appendix: Industry Patterns<a class=headerlink href=#appendix-industry-patterns title="Permanent link">&para;</a></h2> <h3 id=a-tool-format-comparison>A. Tool Format Comparison<a class=headerlink href=#a-tool-format-comparison title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Field</th> <th>MCP</th> <th>OpenAI</th> <th>Anthropic</th> <th>LangChain</th> </tr> </thead> <tbody> <tr> <td>Name</td> <td><code>name</code></td> <td><code>name</code></td> <td><code>name</code></td> <td><code>name</code></td> </tr> <tr> <td>Description</td> <td><code>description</code></td> <td><code>description</code></td> <td><code>description</code></td> <td><code>description</code></td> </tr> <tr> <td>Parameters</td> <td><code>inputSchema</code></td> <td><code>parameters</code></td> <td><code>input_schema</code></td> <td><code>schema</code></td> </tr> <tr> <td>Schema Type</td> <td>JSON Schema</td> <td>JSON Schema</td> <td>JSON Schema</td> <td>Zod/JSON Schema</td> </tr> <tr> <td>Strict Mode</td> <td>N/A</td> <td><code>strict: true</code></td> <td>N/A</td> <td>N/A</td> </tr> <tr> <td>Return Type</td> <td>Content array</td> <td>String/Object</td> <td>Content array</td> <td>Any</td> </tr> </tbody> </table> <h3 id=b-schema-feature-support-matrix>B. Schema Feature Support Matrix<a class=headerlink href=#b-schema-feature-support-matrix title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Feature</th> <th>MCP</th> <th>OpenAI</th> <th>OpenAI Strict</th> <th>Anthropic</th> </tr> </thead> <tbody> <tr> <td>Nested objects</td> <td>✅</td> <td>✅</td> <td>✅</td> <td>✅</td> </tr> <tr> <td>Arrays</td> <td>✅</td> <td>✅</td> <td>✅</td> <td>✅</td> </tr> <tr> <td>Enums</td> <td>✅</td> <td>✅</td> <td>✅</td> <td>✅</td> </tr> <tr> <td>Pattern validation</td> <td>✅</td> <td>⚠️</td> <td>✅</td> <td>✅</td> </tr> <tr> <td>$ref definitions</td> <td>✅</td> <td>❌</td> <td>❌</td> <td>❌</td> </tr> <tr> <td>anyOf/oneOf</td> <td>✅</td> <td>⚠️</td> <td>⚠️</td> <td>✅</td> </tr> <tr> <td>Nullable</td> <td>✅</td> <td>✅</td> <td>✅</td> <td>✅</td> </tr> <tr> <td>Default values</td> <td>✅</td> <td>✅</td> <td>❌</td> <td>✅</td> </tr> </tbody> </table> <h3 id=c-error-rate-comparison-mastra-research>C. Error Rate Comparison (Mastra Research)<a class=headerlink href=#c-error-rate-comparison-mastra-research title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Scenario</th> <th>No Adapter</th> <th>With Adapter</th> <th>Improvement</th> </tr> </thead> <tbody> <tr> <td>Simple tools</td> <td>8%</td> <td>1%</td> <td>87.5%</td> </tr> <tr> <td>Complex schemas</td> <td>23%</td> <td>4%</td> <td>82.6%</td> </tr> <tr> <td>Cross-provider</td> <td>31%</td> <td>5%</td> <td>83.9%</td> </tr> <tr> <td><strong>Overall</strong></td> <td><strong>15%</strong></td> <td><strong>3%</strong></td> <td><strong>80%</strong></td> </tr> </tbody> </table> <h3 id=d-related-projects>D. Related Projects<a class=headerlink href=#d-related-projects title="Permanent link">&para;</a></h3> <table> <thead> <tr> <th>Project</th> <th>Stars</th> <th>Approach</th> <th>Limitations</th> </tr> </thead> <tbody> <tr> <td>LangChain MCP Adapters</td> <td>~2k</td> <td>MCP → LangChain</td> <td>One-way, JS only</td> </tr> <tr> <td>llm-functions</td> <td>704</td> <td>Multi-language declaration</td> <td>No runtime registry</td> </tr> <tr> <td>kani</td> <td>598</td> <td>Python @ai_function</td> <td>Python only</td> </tr> <tr> <td>Mastra</td> <td>~500</td> <td>Compatibility layer</td> <td>TypeScript only</td> </tr> </tbody> </table> <hr> <h2 id=changelog>Changelog<a class=headerlink href=#changelog title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>Date</th> <th>Change</th> </tr> </thead> <tbody> <tr> <td>2026-01-28</td> <td>Initial draft based on architecture research</td> </tr> </tbody> </table> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy", "content.tabs.link"], "search": "../../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../../../assets/javascripts/bundle.fe8b6f2b.min.js></script> <script src=https://unpkg.com/mermaid@10.6.1/dist/mermaid.min.js></script> <script src=../../../../js/mermaid-init.js></script> </body> </html>