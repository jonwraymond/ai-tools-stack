{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"AI Tools Stack","text":"<p>Welcome to the unified documentation for the AI Tools Stack. This site brings all tool libraries together in one place and shows how they compose into a progressive-disclosure MCP surface.</p>"},{"location":"#what-this-stack-provides","title":"What this stack provides","text":"<ul> <li>Canonical tool schemas (toolmodel)</li> <li>Registry and discovery (toolindex)</li> <li>Docs and examples (tooldocs)</li> <li>Execution and chaining (toolrun)</li> <li>Code-mode orchestration (toolcode)</li> <li>Sandbox/runtime backends (toolruntime)</li> <li>Search strategies (toolsearch)</li> <li>MCP server wiring (metatools-mcp)</li> </ul>"},{"location":"#high-level-flow","title":"High-level flow","text":"<pre><code>flowchart LR\n  A[toolmodel] --&gt; B[toolindex]\n  B --&gt; C[tooldocs]\n  B --&gt; D[toolrun]\n  D --&gt; E[toolcode]\n  D --&gt; F[toolruntime]\n  B --&gt; G[toolsearch]\n  B --&gt; H[metatools-mcp]\n  C --&gt; H\n  D --&gt; H\n  E --&gt; H</code></pre>"},{"location":"#quickstart","title":"Quickstart","text":"<ol> <li>Start with <code>toolmodel</code> for your canonical schemas.</li> <li>Register tools in <code>toolindex</code> for discovery.</li> <li>Add docs/examples in <code>tooldocs</code>.</li> <li>Execute tools via <code>toolrun</code>.</li> <li>Expose the MCP surface using <code>metatools-mcp</code>.</li> </ol> <p>See the Components section for per-library examples and diagrams.</p>"},{"location":"#docs-from-each-repo","title":"Docs from each repo","text":"<p>Under Library Docs (from repos) you will find the docs imported directly from each repository at build time.</p>"},{"location":"architecture/overview/","title":"Stack Architecture","text":"<p>This stack is built around progressive disclosure and a clean separation of schema, discovery, docs, execution, and transport.</p>"},{"location":"architecture/overview/#layering-model","title":"Layering model","text":"<pre><code>flowchart TB\n  A[toolmodel] --&gt; B[toolindex]\n  B --&gt; C[tooldocs]\n  B --&gt; D[toolrun]\n  D --&gt; E[toolcode]\n  E --&gt; F[toolruntime]\n  B --&gt; G[toolsearch]\n  B --&gt; H[metatools-mcp]\n  C --&gt; H\n  D --&gt; H\n  E --&gt; H</code></pre>"},{"location":"architecture/overview/#progressive-disclosure-pipeline","title":"Progressive disclosure pipeline","text":"<pre><code>sequenceDiagram\n  participant Agent\n  participant MCP as metatools-mcp\n  participant Index as toolindex\n  participant Docs as tooldocs\n  participant Run as toolrun\n\n  Agent-&gt;&gt;MCP: search_tools(query)\n  MCP-&gt;&gt;Index: Search(query)\n  Index--&gt;&gt;MCP: summaries\n  MCP--&gt;&gt;Agent: summaries\n\n  Agent-&gt;&gt;MCP: describe_tool(id, schema)\n  MCP-&gt;&gt;Docs: DescribeTool(id, schema)\n  Docs--&gt;&gt;MCP: tool schema\n  MCP--&gt;&gt;Agent: schema\n\n  Agent-&gt;&gt;MCP: run_tool(id, args)\n  MCP-&gt;&gt;Run: Run(id, args)\n  Run--&gt;&gt;MCP: result\n  MCP--&gt;&gt;Agent: result</code></pre>"},{"location":"architecture/overview/#tool-execution-and-runtime-isolation","title":"Tool execution and runtime isolation","text":"<pre><code>flowchart LR\n  A[toolrun] --&gt; B[toolruntime]\n  B --&gt; C[unsafe host]\n  B --&gt; D[docker]\n  B --&gt; E[kubernetes]\n  B --&gt; F[firecracker]\n  B --&gt; G[gvisor]\n  B --&gt; H[wasm]</code></pre>"},{"location":"architecture/overview/#search-strategy-layering","title":"Search strategy layering","text":"<pre><code>flowchart LR\n  A[toolindex] --&gt; B[toolsearch]\n  B --&gt; C[BM25]\n  B --&gt; D[future: semantic]\n  B --&gt; E[future: hybrid]</code></pre>"},{"location":"architecture/pluggable-architecture/","title":"Pluggable Architecture","text":"<p>The stack is designed so each layer is replaceable without changing the others. This keeps the core stable while allowing experimentation and integration.</p>"},{"location":"architecture/pluggable-architecture/#extension-points","title":"Extension points","text":"<pre><code>flowchart LR\n  A[toolmodel] --&gt; B[toolindex]\n  B --&gt; C[tooldocs]\n  B --&gt; D[toolrun]\n  D --&gt; E[toolcode]\n  E --&gt; F[toolruntime]\n\n  B --&gt; G[toolsearch]\n\n  subgraph Pluggable\n    S[Searcher]\n    R[Backend]\n    E1[Engine]\n  end\n\n  G --&gt; S\n  D --&gt; R\n  E --&gt; E1</code></pre>"},{"location":"architecture/pluggable-architecture/#what-you-can-plug-in","title":"What you can plug in","text":"<ul> <li>Search: swap lexical for BM25 or semantic ranking</li> <li>Execution: add MCP servers, local handlers, or provider adapters</li> <li>Code execution: change engines or language runtimes</li> <li>Runtime isolation: choose the sandbox backend per environment</li> </ul>"},{"location":"architecture/pluggable-architecture/#design-goal","title":"Design goal","text":"<p>The default implementations are intentionally simple and safe. Advanced capabilities are injected rather than baked into the core.</p>"},{"location":"architecture/progressive-disclosure/","title":"Progressive Disclosure","text":"<p>Progressive disclosure is the core usability strategy of this stack. It lets agents discover just enough information to choose the right tool, then retrieve deeper details only when needed.</p>"},{"location":"architecture/progressive-disclosure/#why-it-matters","title":"Why it matters","text":"<ul> <li>Lower token cost: most tools are never fully expanded</li> <li>Faster decisions: summary-level signals are enough to pick candidates</li> <li>Safer execution: schema and examples are fetched only after a tool is chosen</li> </ul>"},{"location":"architecture/progressive-disclosure/#flow","title":"Flow","text":"<pre><code>sequenceDiagram\n  participant Agent\n  participant MCP as metatools-mcp\n  participant Index as toolindex\n  participant Docs as tooldocs\n  participant Run as toolrun\n\n  Agent-&gt;&gt;MCP: search_tools(\"repo metadata\")\n  MCP-&gt;&gt;Index: Search\n  Index--&gt;&gt;MCP: summaries\n  MCP--&gt;&gt;Agent: summaries\n\n  Agent-&gt;&gt;MCP: describe_tool(id, schema)\n  MCP-&gt;&gt;Docs: DescribeTool\n  Docs--&gt;&gt;MCP: tool schema\n  MCP--&gt;&gt;Agent: schema\n\n  Agent-&gt;&gt;MCP: run_tool(id, args)\n  MCP-&gt;&gt;Run: Run\n  Run--&gt;&gt;MCP: result\n  MCP--&gt;&gt;Agent: result</code></pre>"},{"location":"architecture/progressive-disclosure/#component-roles","title":"Component roles","text":"<ul> <li><code>toolindex</code>: fast, summary-only discovery</li> <li><code>tooldocs</code>: structured detail (schema/full/examples)</li> <li><code>toolrun</code>: execution with validation + consistent errors</li> <li><code>toolcode</code>: optional code-mode orchestration</li> </ul>"},{"location":"architecture/why-go/","title":"Why Go","text":"<p>Go is a strong fit for this stack because it pairs high performance with a simple concurrency model and a clean interface story.</p>"},{"location":"architecture/why-go/#advantages-for-this-stack","title":"Advantages for this stack","text":""},{"location":"architecture/why-go/#compiled-fast-startup","title":"Compiled + fast startup","text":"<ul> <li>Small binaries and quick startup times are ideal for MCP servers</li> <li>Predictable performance for low-latency tool calls</li> </ul>"},{"location":"architecture/why-go/#concurrency-without-complexity","title":"Concurrency without complexity","text":"<ul> <li>Goroutines and channels make async tool execution straightforward</li> <li><code>context.Context</code> enables timeouts and cancellation across the stack</li> </ul>"},{"location":"architecture/why-go/#interface-first-extensibility","title":"Interface-first extensibility","text":"<ul> <li>Each layer (<code>Searcher</code>, <code>Runner</code>, <code>Engine</code>, <code>Backend</code>) is interface-driven</li> <li>You can plug in new languages, providers, or runtimes without redesigning</li> </ul>"},{"location":"architecture/why-go/#operational-simplicity","title":"Operational simplicity","text":"<ul> <li>Static binaries simplify deployment</li> <li>Works equally well in containers, VMs, or bare metal</li> </ul>"},{"location":"architecture/why-go/#summary","title":"Summary","text":"<p>Go lets you build a composable system that is fast, concurrent, and easy to extend. That is exactly what this stack needs.</p>"},{"location":"components/metatools-mcp/","title":"metatools-mcp","text":"<p>MCP server that exposes the tool stack via standardized MCP tools with a progressive-disclosure flow.</p>"},{"location":"components/metatools-mcp/#motivation","title":"Motivation","text":"<ul> <li>Provide a minimal, consistent MCP surface</li> <li>Keep discovery cheap and execution safe</li> <li>Enable pluggable search and optional code execution</li> </ul>"},{"location":"components/metatools-mcp/#core-responsibilities","title":"Core responsibilities","text":"<ul> <li>Expose <code>search_tools</code>, <code>list_namespaces</code></li> <li>Expose <code>describe_tool</code>, <code>list_tool_examples</code></li> <li>Expose <code>run_tool</code>, <code>run_chain</code></li> <li>Optionally expose <code>execute_code</code></li> <li>Use the official MCP Go SDK</li> </ul>"},{"location":"components/metatools-mcp/#example","title":"Example","text":"<pre><code>srv, _ := server.New(cfg)\n_ = srv.Run(context.Background(), &amp;mcp.StdioTransport{})\n</code></pre>"},{"location":"components/metatools-mcp/#diagram","title":"Diagram","text":"<pre><code>flowchart LR\n  A[metatools-mcp] --&gt; B[toolindex]\n  A --&gt; C[tooldocs]\n  A --&gt; D[toolrun]\n  A --&gt; E[toolcode]\n  E --&gt; F[toolruntime]</code></pre>"},{"location":"components/metatools-mcp/#usability-notes","title":"Usability notes","text":"<ul> <li>Small tool surface reduces prompt complexity</li> <li>Schemas and examples are fetched on demand</li> </ul>"},{"location":"components/toolcode/","title":"toolcode","text":"<p>Code-mode orchestration layer that wraps search, docs, and execution into a single programmable surface.</p>"},{"location":"components/toolcode/#motivation","title":"Motivation","text":"<ul> <li>Enable conditional logic and multi-step orchestration</li> <li>Keep tool orchestration explicit and testable</li> <li>Provide call traces for debugging</li> </ul>"},{"location":"components/toolcode/#core-responsibilities","title":"Core responsibilities","text":"<ul> <li>Execute short orchestration snippets</li> <li>Provide a minimal in-sandbox API (SearchTools, DescribeTool, RunTool)</li> <li>Enforce timeouts and limits</li> </ul>"},{"location":"components/toolcode/#example","title":"Example","text":"<pre><code>executor := toolcode.NewDefaultExecutor(toolcode.Config{\n  Index:  idx,\n  Docs:   docs,\n  Run:    runner,\n  Engine: engine,\n})\n\nres, _ := executor.ExecuteCode(ctx, toolcode.ExecuteParams{\n  Language: \"go\",\n  Code:     \"__out = 2 + 2\",\n})\n</code></pre>"},{"location":"components/toolcode/#diagram","title":"Diagram","text":"<pre><code>flowchart LR\n  A[toolcode] --&gt; B[toolindex]\n  A --&gt; C[tooldocs]\n  A --&gt; D[toolrun]\n  A --&gt; E[toolruntime]</code></pre>"},{"location":"components/toolcode/#usability-notes","title":"Usability notes","text":"<ul> <li><code>ExecuteResult</code> includes tool call traces</li> <li>Limits are enforced consistently across engines</li> </ul>"},{"location":"components/tooldocs/","title":"tooldocs","text":"<p>Progressive, structured documentation and examples for tools. Designed for schema-first usage and token-efficient guidance.</p>"},{"location":"components/tooldocs/#motivation","title":"Motivation","text":"<ul> <li>Pull full schemas only when needed</li> <li>Reduce tool call errors with examples</li> <li>Keep long docs out of the critical path</li> </ul>"},{"location":"components/tooldocs/#core-responsibilities","title":"Core responsibilities","text":"<ul> <li>Detail tiers: summary \u2192 schema \u2192 full</li> <li>Short usage examples with caps</li> <li>Notes and external references</li> </ul>"},{"location":"components/tooldocs/#example","title":"Example","text":"<pre><code>store := tooldocs.NewInMemoryStore(tooldocs.StoreOptions{Index: idx})\n\n_ = store.RegisterDoc(\"github:get_repo\", tooldocs.DocEntry{\n  Summary: \"Fetch repository metadata\",\n  Notes:   \"Requires authentication.\",\n})\n\nschema, _ := store.DescribeTool(\"github:get_repo\", tooldocs.DetailSchema)\nexamples, _ := store.ListExamples(\"github:get_repo\", 2)\n</code></pre>"},{"location":"components/tooldocs/#diagram","title":"Diagram","text":"<pre><code>flowchart LR\n  A[tooldocs] --&gt; B[summary]\n  A --&gt; C[schema]\n  A --&gt; D[full]\n  A --&gt; E[metatools-mcp]</code></pre>"},{"location":"components/tooldocs/#usability-notes","title":"Usability notes","text":"<ul> <li>Example caps protect token budgets</li> <li>Summary tier is safe for discovery</li> <li>Schema tier is designed for tool invocation</li> </ul>"},{"location":"components/toolindex/","title":"toolindex","text":"<p>Global registry and search layer for tools. Provides progressive discovery and canonical lookup by tool ID.</p>"},{"location":"components/toolindex/#motivation","title":"Motivation","text":"<ul> <li>Keep discovery fast and cheap</li> <li>Decouple search quality from core registry</li> <li>Provide a single source of truth for tool IDs and backends</li> </ul>"},{"location":"components/toolindex/#core-responsibilities","title":"Core responsibilities","text":"<ul> <li>Register tools + backends</li> <li>Search by name/namespace/description/tags</li> <li>List namespaces</li> <li>Resolve tools by canonical ID</li> </ul>"},{"location":"components/toolindex/#example","title":"Example","text":"<pre><code>idx := toolindex.NewInMemoryIndex()\n\n_ = idx.RegisterTool(tool, backend)\n\nsummaries, _ := idx.Search(\"repo\", 5)\nfor _, s := range summaries {\n  fmt.Println(s.ID, s.ShortDescription)\n}\n</code></pre>"},{"location":"components/toolindex/#diagram","title":"Diagram","text":"<pre><code>flowchart LR\n  A[toolindex] --&gt; B[Searcher]\n  B --&gt; C[lexical]\n  B --&gt; D[toolsearch BM25]\n  A --&gt; E[tooldocs]\n  A --&gt; F[toolrun]</code></pre>"},{"location":"components/toolindex/#usability-notes","title":"Usability notes","text":"<ul> <li>Summaries are token-cheap</li> <li>Namespace listing enables simple filtering</li> <li>Backends are swappable without changing IDs</li> </ul>"},{"location":"components/toolmodel/","title":"toolmodel","text":"<p>Canonical schema definitions for all tools. This is the source of truth for IDs, schemas, tags, and backend bindings.</p>"},{"location":"components/toolmodel/#motivation","title":"Motivation","text":"<ul> <li>Standardize tool definitions across the stack</li> <li>Align directly with MCP via the official Go SDK</li> <li>Keep schemas portable and validation deterministic</li> </ul>"},{"location":"components/toolmodel/#core-types","title":"Core types","text":"<ul> <li><code>Tool</code> (embeds MCP <code>mcp.Tool</code>, adds <code>Namespace</code>, <code>Version</code>, <code>Tags</code>)</li> <li><code>ToolBackend</code> (execution binding: mcp, provider, local)</li> <li><code>SchemaValidator</code> (input/output validation)</li> </ul>"},{"location":"components/toolmodel/#example","title":"Example","text":"<pre><code>import (\n  \"github.com/jonwraymond/toolmodel\"\n  \"github.com/modelcontextprotocol/go-sdk/mcp\"\n)\n\ntool := toolmodel.Tool{\n  Namespace: \"github\",\n  Tool: mcp.Tool{\n    Name:        \"get_repo\",\n    Description: \"Fetch repository metadata\",\n    InputSchema: map[string]any{\n      \"type\": \"object\",\n      \"properties\": map[string]any{\n        \"owner\": {\"type\": \"string\"},\n        \"repo\":  {\"type\": \"string\"},\n      },\n      \"required\": []string{\"owner\", \"repo\"},\n    },\n  },\n  Tags: toolmodel.NormalizeTags([]string{\"GitHub\", \"repos\"}),\n}\n\n_ = tool.Validate()\n</code></pre>"},{"location":"components/toolmodel/#diagram","title":"Diagram","text":"<pre><code>flowchart LR\n  A[toolmodel.Tool] --&gt; B[toolindex]\n  A --&gt; C[tooldocs]\n  A --&gt; D[toolrun]</code></pre>"},{"location":"components/toolmodel/#usability-notes","title":"Usability notes","text":"<ul> <li>Schemas accept maps or JSON bytes</li> <li>Tags are normalized for fast search</li> <li>IDs are stable and human\u2011readable</li> </ul>"},{"location":"components/toolrun/","title":"toolrun","text":"<p>Execution layer for tools and chains. Backend-agnostic and aligned to MCP <code>run_tool</code> and <code>run_chain</code> semantics.</p>"},{"location":"components/toolrun/#motivation","title":"Motivation","text":"<ul> <li>Provide consistent execution semantics across backends</li> <li>Validate inputs/outputs for safety</li> <li>Offer deterministic chain behavior</li> </ul>"},{"location":"components/toolrun/#core-responsibilities","title":"Core responsibilities","text":"<ul> <li>Resolve tools and backends</li> <li>Validate inputs/outputs with toolmodel schemas</li> <li>Dispatch to MCP, provider, or local backends</li> <li>Execute chains with <code>previous</code> injection</li> </ul>"},{"location":"components/toolrun/#example","title":"Example","text":"<pre><code>runner := toolrun.NewRunner(\n  toolrun.WithIndex(idx),\n  toolrun.WithLocalRegistry(localRegistry),\n)\n\nresult, _ := runner.Run(ctx, \"github:get_repo\", map[string]any{\n  \"owner\": \"octo\",\n  \"repo\":  \"hello\",\n})\n</code></pre>"},{"location":"components/toolrun/#diagram","title":"Diagram","text":"<pre><code>flowchart LR\n  A[toolrun] --&gt; B[Resolve + Validate]\n  B --&gt; C[Dispatch]\n  C --&gt; D[MCP]\n  C --&gt; E[Provider]\n  C --&gt; F[Local]</code></pre>"},{"location":"components/toolrun/#usability-notes","title":"Usability notes","text":"<ul> <li>Streaming is optional; non-streaming backends return <code>ErrStreamNotSupported</code></li> <li>Backend selection is deterministic by default</li> </ul>"},{"location":"components/toolruntime/","title":"toolruntime","text":"<p>Sandbox/runtime abstraction for executing code securely. Provides multiple backends with a single interface.</p>"},{"location":"components/toolruntime/#motivation","title":"Motivation","text":"<ul> <li>Create an explicit trust boundary for code execution</li> <li>Swap isolation backends without changing APIs</li> <li>Apply security profiles consistently</li> </ul>"},{"location":"components/toolruntime/#core-responsibilities","title":"Core responsibilities","text":"<ul> <li>Runtime interface + default implementation</li> <li>Backends (unsafe host, docker, kubernetes, gvisor, firecracker, wasm)</li> <li>Security profiles and execution limits</li> </ul>"},{"location":"components/toolruntime/#example","title":"Example","text":"<pre><code>rt := toolruntime.NewDefaultRuntime(toolruntime.RuntimeConfig{\n  Backends: map[toolruntime.SecurityProfile]toolruntime.Backend{\n    toolruntime.ProfileDev: unsafe.New(unsafe.Config{Mode: unsafe.ModeSubprocess}),\n  },\n  DefaultProfile: toolruntime.ProfileDev,\n})\n</code></pre>"},{"location":"components/toolruntime/#diagram","title":"Diagram","text":"<pre><code>flowchart LR\n  A[toolruntime] --&gt; B[unsafe]\n  A --&gt; C[docker]\n  A --&gt; D[kubernetes]\n  A --&gt; E[firecracker]\n  A --&gt; F[gvisor]\n  A --&gt; G[wasm]</code></pre>"},{"location":"components/toolruntime/#usability-notes","title":"Usability notes","text":"<ul> <li>Profiles separate policy from implementation</li> <li>Backends are swappable per environment</li> </ul>"},{"location":"components/toolsearch/","title":"toolsearch","text":"<p>Search strategy library that plugs into toolindex. Currently provides BM25 with room for semantic/hybrid search.</p>"},{"location":"components/toolsearch/#motivation","title":"Motivation","text":"<ul> <li>Keep <code>toolindex</code> minimal</li> <li>Allow search experimentation without destabilizing the core</li> <li>Improve relevance without changing IDs or schemas</li> </ul>"},{"location":"components/toolsearch/#core-responsibilities","title":"Core responsibilities","text":"<ul> <li>Provide BM25 ranking</li> <li>Keep search logic decoupled from the index</li> <li>Support pluggable scoring</li> </ul>"},{"location":"components/toolsearch/#example","title":"Example","text":"<pre><code>searcher := toolsearch.NewBM25Searcher(toolsearch.BM25Config{K1: 1.5, B: 0.75})\nidx := toolindex.NewInMemoryIndex(toolindex.IndexOptions{Searcher: searcher})\n</code></pre>"},{"location":"components/toolsearch/#diagram","title":"Diagram","text":"<pre><code>flowchart LR\n  A[toolindex] --&gt; B[toolsearch]\n  B --&gt; C[BM25]\n  B --&gt; D[semantic]</code></pre>"},{"location":"components/toolsearch/#usability-notes","title":"Usability notes","text":"<ul> <li>Deterministic ranking avoids jitter</li> <li>BM25 is opt-in and isolated by design</li> </ul>"},{"location":"operations/ci-and-versioning/","title":"CI and Versioning","text":""},{"location":"operations/ci-and-versioning/#ci-checks","title":"CI checks","text":"<p>Each repo runs CI for:</p> <ul> <li>go vet</li> <li>go test</li> <li>lint + security (golangci-lint + gosec)</li> </ul>"},{"location":"operations/ci-and-versioning/#version-alignment","title":"Version alignment","text":"<ul> <li><code>ai-tools-stack/go.mod</code> is the source of truth.</li> <li><code>VERSIONS.md</code> is generated in each repo and updated via:</li> </ul> <pre><code>scripts/update-version-matrix.sh --apply\n</code></pre>"},{"location":"operations/ci-and-versioning/#dependency-bumping","title":"Dependency bumping","text":"<p>Use the DAG-aware bump tool:</p> <pre><code>scripts/bump-dep.sh --dep toolruntime --latest --apply\n</code></pre> <p>This updates all downstream repos and ai-tools-stack in order.</p>"},{"location":"operations/ci-and-versioning/#docs-automation","title":"Docs automation","text":"<p>The unified docs site is built from this repo using MkDocs + the multirepo plugin. GitHub Actions runs on push to main and nightly (scheduled) to pull fresh docs from the tool repos.</p> <p>Versioned docs are published with <code>mike</code>:</p> <ul> <li><code>latest</code> alias is deployed from <code>main</code></li> <li>tag builds deploy versioned docs (for example, <code>v0.1.8</code>) and set <code>stable</code></li> </ul> <p>Local preview:</p> <pre><code>pip install -r requirements.txt\n./scripts/prepare-mkdocs-multirepo.sh\nmkdocs serve\n</code></pre> <p>Versioned preview:</p> <pre><code>pip install -r requirements.txt\n./scripts/prepare-mkdocs-multirepo.sh\nmike serve\n</code></pre>"},{"location":"library-docs-from-repos/toolmodel/","title":"toolmodel","text":"<p><code>toolmodel</code> is the canonical, MCP-aligned data model for tools across the stack. It embeds the official MCP Go SDK <code>mcp.Tool</code>, adds namespace + tags, and provides schema validation helpers.</p>"},{"location":"library-docs-from-repos/toolmodel/#motivation","title":"Motivation","text":"<ul> <li>Single source of truth for tool schemas and IDs</li> <li>Protocol alignment by embedding the official MCP SDK type</li> <li>Safe validation with deterministic, dependency-light JSON Schema checks</li> </ul>"},{"location":"library-docs-from-repos/toolmodel/#key-apis","title":"Key APIs","text":"<ul> <li><code>Tool</code> (embeds <code>mcp.Tool</code>, adds <code>Namespace</code>, <code>Version</code>, <code>Tags</code>)</li> <li><code>ToolBackend</code> (mcp/provider/local binding)</li> <li><code>SchemaValidator</code> + <code>NewDefaultValidator()</code></li> <li><code>NormalizeTags</code>, <code>ToolID</code>, <code>ParseToolID</code></li> </ul>"},{"location":"library-docs-from-repos/toolmodel/#quickstart","title":"Quickstart","text":"<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"log\"\n\n  \"github.com/jonwraymond/toolmodel\"\n  \"github.com/modelcontextprotocol/go-sdk/mcp\"\n)\n\nfunc main() {\n  tool := toolmodel.Tool{\n    Namespace: \"github\",\n    Tool: mcp.Tool{\n      Name:        \"get_repo\",\n      Description: \"Fetch repository metadata\",\n      InputSchema: map[string]any{\n        \"type\": \"object\",\n        \"properties\": map[string]any{\n          \"owner\": {\"type\": \"string\"},\n          \"repo\":  {\"type\": \"string\"},\n        },\n        \"required\": []string{\"owner\", \"repo\"},\n      },\n    },\n    Tags: toolmodel.NormalizeTags([]string{\"GitHub\", \"repos\"}),\n  }\n\n  if err := tool.Validate(); err != nil {\n    log.Fatal(err)\n  }\n\n  fmt.Println(tool.ToolID()) // github:get_repo\n}\n</code></pre>"},{"location":"library-docs-from-repos/toolmodel/#usability-notes","title":"Usability notes","text":"<ul> <li><code>InputSchema</code>/<code>OutputSchema</code> accept <code>map[string]any</code> or JSON bytes</li> <li>Tags are normalized for search (<code>toolindex</code> + <code>toolsearch</code>)</li> <li>Canonical IDs are stable and human-friendly</li> </ul>"},{"location":"library-docs-from-repos/toolmodel/#next","title":"Next","text":"<ul> <li>Architecture and placement in the stack: <code>architecture.md</code></li> <li>Usage patterns and validation: <code>usage.md</code></li> <li>Additional examples: <code>examples.md</code></li> </ul>"},{"location":"library-docs-from-repos/toolmodel/architecture/","title":"Architecture","text":"<p><code>toolmodel</code> sits at the bottom of the stack. Everything else consumes its types and uses it as the canonical source of truth.</p>"},{"location":"library-docs-from-repos/toolmodel/architecture/#component-view","title":"Component view","text":"<pre><code>flowchart LR\n  A[toolmodel.Tool] --&gt; B[toolindex]\n  A --&gt; C[tooldocs]\n  A --&gt; D[toolrun]\n  A --&gt; E[metatools-mcp]\n\n  subgraph Binding\n    F[ToolBackend]\n  end\n\n  F --&gt; D</code></pre>"},{"location":"library-docs-from-repos/toolmodel/architecture/#data-model-view","title":"Data model view","text":"<pre><code>classDiagram\n  class Tool {\n    +string Namespace\n    +string Name\n    +string Version\n    +[]string Tags\n    +ToolID() string\n  }\n\n  class ToolBackend {\n    +BackendKind Kind\n  }\n\n  class MCPBackend {\n    +string ServerName\n  }\n\n  class ProviderBackend {\n    +string ProviderID\n    +string ToolID\n  }\n\n  class LocalBackend {\n    +string Name\n  }\n\n  ToolBackend --&gt; MCPBackend\n  ToolBackend --&gt; ProviderBackend\n  ToolBackend --&gt; LocalBackend</code></pre>"},{"location":"library-docs-from-repos/toolmodel/architecture/#validation-pipeline","title":"Validation pipeline","text":"<pre><code>flowchart LR\n  A[Tool.InputSchema] --&gt; B[DefaultValidator]\n  B --&gt; C[Resolve schema]\n  C --&gt; D[Validate instance]\n  D --&gt; E[Error or success]</code></pre>"},{"location":"library-docs-from-repos/toolmodel/architecture/#design-notes","title":"Design notes","text":"<ul> <li>Embeds <code>mcp.Tool</code> to stay aligned with the official MCP SDK.</li> <li>Adds <code>Namespace</code>, <code>Version</code>, and <code>Tags</code> without altering MCP semantics.</li> <li>Keeps validation dependency-light and deterministic.</li> </ul>"},{"location":"library-docs-from-repos/toolmodel/examples/","title":"Examples","text":""},{"location":"library-docs-from-repos/toolmodel/examples/#tag-normalization","title":"Tag normalization","text":"<pre><code>normalized := toolmodel.NormalizeTags([]string{\n  \"  GitHub Repos \",\n  \"GITHUB  repos\",\n  \"  ci/cd  \",\n})\n// =&gt; [\"github-repos\", \"ci-cd\"]\n</code></pre>"},{"location":"library-docs-from-repos/toolmodel/examples/#validate-output","title":"Validate output","text":"<pre><code>result := map[string]any{\n  \"full_name\": \"octo/hello\",\n}\n\nif err := validator.ValidateOutput(&amp;tool, result); err != nil {\n  // handle schema mismatch\n}\n</code></pre>"},{"location":"library-docs-from-repos/toolmodel/examples/#canonical-id-parsing","title":"Canonical ID parsing","text":"<pre><code>ns, name, err := toolmodel.ParseToolID(\"github:get_repo\")\n// ns = \"github\", name = \"get_repo\"\n</code></pre>"},{"location":"library-docs-from-repos/toolmodel/usage/","title":"Usage","text":""},{"location":"library-docs-from-repos/toolmodel/usage/#define-a-tool","title":"Define a tool","text":"<pre><code>import (\n  \"github.com/jonwraymond/toolmodel\"\n  \"github.com/modelcontextprotocol/go-sdk/mcp\"\n)\n\ntool := toolmodel.Tool{\n  Namespace: \"tickets\",\n  Tool: mcp.Tool{\n    Name:        \"create\",\n    Description: \"Create a support ticket\",\n    InputSchema: map[string]any{\n      \"type\": \"object\",\n      \"properties\": map[string]any{\n        \"title\":    {\"type\": \"string\"},\n        \"priority\": {\"type\": \"string\", \"enum\": []string{\"low\", \"high\"}},\n      },\n      \"required\": []string{\"title\"},\n    },\n  },\n  Tags: toolmodel.NormalizeTags([]string{\"Support\", \"Tickets\"}),\n}\n</code></pre>"},{"location":"library-docs-from-repos/toolmodel/usage/#tool-ids","title":"Tool IDs","text":"<pre><code>id := tool.ToolID()                 // tickets:create\nns, name, _ := toolmodel.ParseToolID(id)\n</code></pre>"},{"location":"library-docs-from-repos/toolmodel/usage/#backends","title":"Backends","text":"<p><code>toolmodel</code> does not execute anything. It only describes how a tool can be executed. These backends are consumed by <code>toolrun</code>.</p> <pre><code>mcpBackend := toolmodel.ToolBackend{\n  Kind: toolmodel.BackendKindMCP,\n  MCP:  &amp;toolmodel.MCPBackend{ServerName: \"github\"},\n}\n\nproviderBackend := toolmodel.ToolBackend{\n  Kind: toolmodel.BackendKindProvider,\n  Provider: &amp;toolmodel.ProviderBackend{\n    ProviderID: \"internal-api\",\n    ToolID:     \"tickets.create\",\n  },\n}\n\nlocalBackend := toolmodel.ToolBackend{\n  Kind: toolmodel.BackendKindLocal,\n  Local: &amp;toolmodel.LocalBackend{Name: \"create_ticket\"},\n}\n</code></pre>"},{"location":"library-docs-from-repos/toolmodel/usage/#validation","title":"Validation","text":"<pre><code>validator := toolmodel.NewDefaultValidator()\n\nif err := validator.ValidateInput(&amp;tool, map[string]any{\"title\": \"Help\"}); err != nil {\n  // handle validation error\n}\n</code></pre>"},{"location":"library-docs-from-repos/toolmodel/usage/#dialects-and-safety","title":"Dialects and safety","text":"<ul> <li>JSON Schema 2020-12 is assumed when <code>$schema</code> is missing.</li> <li>draft-07 is accepted (normalized internally).</li> <li>External <code>$ref</code> is blocked (no network resolution).</li> </ul>"},{"location":"library-docs-from-repos/toolindex/","title":"toolindex","text":"<p><code>toolindex</code> is the global registry and progressive discovery layer for tools. It stores <code>toolmodel.Tool</code> + <code>toolmodel.ToolBackend</code>, provides search, and returns token-cheap summaries.</p>"},{"location":"library-docs-from-repos/toolindex/#motivation","title":"Motivation","text":"<ul> <li>Progressive disclosure: search returns summaries, not schemas</li> <li>Deterministic lookup: canonical tool IDs resolve to stable backends</li> <li>Pluggable search: swap lexical search for BM25 or semantic ranking</li> </ul>"},{"location":"library-docs-from-repos/toolindex/#key-apis","title":"Key APIs","text":"<ul> <li><code>Index</code> interface</li> <li><code>InMemoryIndex</code> implementation</li> <li><code>Search</code> + <code>ListNamespaces</code></li> <li><code>RegisterTool(s)</code> + <code>GetTool</code></li> <li><code>Searcher</code> interface for pluggable ranking</li> </ul>"},{"location":"library-docs-from-repos/toolindex/#quickstart","title":"Quickstart","text":"<pre><code>idx := toolindex.NewInMemoryIndex()\n\n_ = idx.RegisterTool(tool, backend)\n\nsummaries, _ := idx.Search(\"repo\", 5)\nfor _, s := range summaries {\n  fmt.Println(s.ID, s.ShortDescription)\n}\n</code></pre>"},{"location":"library-docs-from-repos/toolindex/#usability-notes","title":"Usability notes","text":"<ul> <li>Summaries are token-cheap and safe to display in discovery</li> <li>Namespaces group tools for easy filtering</li> <li>Backends can be replaced without changing the tool ID</li> </ul>"},{"location":"library-docs-from-repos/toolindex/#next","title":"Next","text":"<ul> <li>Architecture and data flow: <code>architecture.md</code></li> <li>Usage patterns and options: <code>usage.md</code></li> <li>Searcher examples: <code>examples.md</code></li> </ul>"},{"location":"library-docs-from-repos/toolindex/architecture/","title":"Architecture","text":"<p><code>toolindex</code> maintains a canonical map of tools and a cached search document set. It is optimized for frequent reads and infrequent writes.</p>"},{"location":"library-docs-from-repos/toolindex/architecture/#registration-search-flow","title":"Registration + search flow","text":"<pre><code>flowchart LR\n  A[RegisterTool(s)] --&gt; B[toolRecord map]\n  B --&gt; C[SearchDoc cache]\n  C --&gt; D[Searcher]\n  D --&gt; E[Summary list]\n\n  B --&gt; F[GetTool]\n  B --&gt; G[ListNamespaces]</code></pre>"},{"location":"library-docs-from-repos/toolindex/architecture/#search-sequence","title":"Search sequence","text":"<pre><code>sequenceDiagram\n  participant Client\n  participant Index\n  participant Searcher\n\n  Client-&gt;&gt;Index: Search(query, limit)\n  Index-&gt;&gt;Index: Build docs (if dirty)\n  Index-&gt;&gt;Searcher: Search(query, docs)\n  Searcher--&gt;&gt;Index: summaries\n  Index--&gt;&gt;Client: summaries</code></pre>"},{"location":"library-docs-from-repos/toolindex/architecture/#progressive-disclosure-contract","title":"Progressive disclosure contract","text":"<ul> <li><code>Search</code> returns summaries only</li> <li>Schema and examples are retrieved later via <code>tooldocs</code></li> </ul>"},{"location":"library-docs-from-repos/toolindex/architecture/#default-backend-policy","title":"Default backend policy","text":"<p>The default backend selector prefers:</p> <ol> <li>local</li> <li>provider</li> <li>mcp</li> </ol> <p>Exported as <code>toolindex.DefaultBackendSelector</code>.</p>"},{"location":"library-docs-from-repos/toolindex/examples/","title":"Examples","text":""},{"location":"library-docs-from-repos/toolindex/examples/#custom-backend-selection","title":"Custom backend selection","text":"<pre><code>selector := func(backends []toolmodel.ToolBackend) toolmodel.ToolBackend {\n  // Prefer MCP for this app\n  for _, b := range backends {\n    if b.Kind == toolmodel.BackendKindMCP {\n      return b\n    }\n  }\n  return toolindex.DefaultBackendSelector(backends)\n}\n\nidx := toolindex.NewInMemoryIndex(toolindex.IndexOptions{BackendSelector: selector})\n</code></pre>"},{"location":"library-docs-from-repos/toolindex/examples/#inject-bm25-searcher","title":"Inject BM25 searcher","text":"<pre><code>searcher := toolsearch.NewBM25Searcher(toolsearch.BM25Config{K1: 1.4, B: 0.75})\nidx := toolindex.NewInMemoryIndex(toolindex.IndexOptions{Searcher: searcher})\n</code></pre>"},{"location":"library-docs-from-repos/toolindex/examples/#multiple-backends","title":"Multiple backends","text":"<pre><code>_ = idx.RegisterTool(tool, toolmodel.ToolBackend{\n  Kind: toolmodel.BackendKindMCP,\n  MCP:  &amp;toolmodel.MCPBackend{ServerName: \"github\"},\n})\n\n_ = idx.RegisterTool(tool, toolmodel.ToolBackend{\n  Kind:  toolmodel.BackendKindLocal,\n  Local: &amp;toolmodel.LocalBackend{Name: \"get_repo\"},\n})\n</code></pre>"},{"location":"library-docs-from-repos/toolindex/usage/","title":"Usage","text":""},{"location":"library-docs-from-repos/toolindex/usage/#register-tools","title":"Register tools","text":"<pre><code>idx := toolindex.NewInMemoryIndex()\n\nreg := toolindex.ToolRegistration{Tool: tool, Backend: backend}\nif err := idx.RegisterTools([]toolindex.ToolRegistration{reg}); err != nil {\n  // handle error\n}\n</code></pre>"},{"location":"library-docs-from-repos/toolindex/usage/#search","title":"Search","text":"<pre><code>summaries, err := idx.Search(\"repo metadata\", 5)\nif err != nil {\n  // handle error\n}\n</code></pre>"},{"location":"library-docs-from-repos/toolindex/usage/#lookup-and-backends","title":"Lookup and backends","text":"<pre><code>t, defaultBackend, err := idx.GetTool(\"github:get_repo\")\nif err != nil {\n  // handle not found\n}\n\nallBackends, _ := idx.GetAllBackends(t.ToolID())\n</code></pre>"},{"location":"library-docs-from-repos/toolindex/usage/#register-from-mcp","title":"Register from MCP","text":"<pre><code>_ = idx.RegisterToolsFromMCP(\"github\", []toolmodel.Tool{toolA, toolB})\n</code></pre>"},{"location":"library-docs-from-repos/toolindex/usage/#options","title":"Options","text":"<pre><code>idx := toolindex.NewInMemoryIndex(toolindex.IndexOptions{\n  BackendSelector: mySelector,\n  Searcher:        mySearcher,\n})\n</code></pre>"},{"location":"library-docs-from-repos/tooldocs/","title":"tooldocs","text":"<p><code>tooldocs</code> provides progressive documentation and examples for tools defined in <code>toolmodel</code> and discovered via <code>toolindex</code>.</p>"},{"location":"library-docs-from-repos/tooldocs/#motivation","title":"Motivation","text":"<ul> <li>Token efficiency: fetch details only when needed</li> <li>Better tool usage: schema + examples reduce call errors</li> <li>Usability: humans and agents see consistent, structured guidance</li> </ul>"},{"location":"library-docs-from-repos/tooldocs/#key-apis","title":"Key APIs","text":"<ul> <li><code>Store</code> interface</li> <li><code>InMemoryStore</code> implementation</li> <li><code>DescribeTool</code> (summary/schema/full)</li> <li><code>ListExamples</code></li> <li><code>DocEntry</code> + <code>ToolExample</code></li> </ul>"},{"location":"library-docs-from-repos/tooldocs/#quickstart","title":"Quickstart","text":"<pre><code>store := tooldocs.NewInMemoryStore(tooldocs.StoreOptions{Index: idx})\n\n_ = store.RegisterDoc(\"github:get_repo\", tooldocs.DocEntry{\n  Summary: \"Fetch repository metadata\",\n  Notes:   \"Requires authentication.\",\n})\n\ndoc, _ := store.DescribeTool(\"github:get_repo\", tooldocs.DetailSchema)\nexamples, _ := store.ListExamples(\"github:get_repo\", 2)\n</code></pre>"},{"location":"library-docs-from-repos/tooldocs/#usability-notes","title":"Usability notes","text":"<ul> <li>Summary and schema are safe defaults for discovery</li> <li>Examples are capped to prevent token blowups</li> <li>Notes and external refs are optional but highly recommended</li> </ul>"},{"location":"library-docs-from-repos/tooldocs/#next","title":"Next","text":"<ul> <li>Detail tiers and resolution: <code>architecture.md</code></li> <li>Registration and caps: <code>usage.md</code></li> <li>Examples: <code>examples.md</code></li> </ul>"},{"location":"library-docs-from-repos/tooldocs/architecture/","title":"Architecture","text":"<p><code>tooldocs</code> adds a documentation layer on top of <code>toolmodel</code>. It does not change schemas; it augments them with guidance and examples.</p>"},{"location":"library-docs-from-repos/tooldocs/architecture/#tiered-disclosure","title":"Tiered disclosure","text":"<pre><code>flowchart LR\n  A[DescribeTool] --&gt; B[summary]\n  A --&gt; C[schema]\n  A --&gt; D[full]\n  D --&gt; E[examples]</code></pre>"},{"location":"library-docs-from-repos/tooldocs/architecture/#resolution-sequence","title":"Resolution sequence","text":"<pre><code>sequenceDiagram\n  participant Client\n  participant Docs as tooldocs\n  participant Index as toolindex\n\n  Client-&gt;&gt;Docs: DescribeTool(id, schema)\n  Docs-&gt;&gt;Index: GetTool(id)\n  Index--&gt;&gt;Docs: tool\n  Docs--&gt;&gt;Client: ToolDoc (schema)</code></pre>"},{"location":"library-docs-from-repos/tooldocs/architecture/#progressive-disclosure-contract","title":"Progressive disclosure contract","text":"<ul> <li><code>DetailSummary</code>: short text only</li> <li><code>DetailSchema</code>: full tool + derived schema info</li> <li><code>DetailFull</code>: schema + notes + examples</li> </ul>"},{"location":"library-docs-from-repos/tooldocs/architecture/#resolution-modes","title":"Resolution modes","text":"<ul> <li>via <code>toolindex.Index</code> (preferred)</li> <li>via a custom <code>ToolResolver</code> function</li> </ul>"},{"location":"library-docs-from-repos/tooldocs/examples/","title":"Examples","text":""},{"location":"library-docs-from-repos/tooldocs/examples/#schema-level-detail","title":"Schema-level detail","text":"<pre><code>doc, _ := store.DescribeTool(\"github:get_repo\", tooldocs.DetailSchema)\nfmt.Println(doc.Tool.InputSchema)\n</code></pre>"},{"location":"library-docs-from-repos/tooldocs/examples/#full-detail-with-examples","title":"Full detail with examples","text":"<pre><code>full, _ := store.DescribeTool(\"github:get_repo\", tooldocs.DetailFull)\nfor _, ex := range full.Examples {\n  fmt.Println(ex.Title, ex.Args)\n}\n</code></pre>"},{"location":"library-docs-from-repos/tooldocs/examples/#resolver-only-usage-no-toolindex","title":"Resolver-only usage (no toolindex)","text":"<pre><code>store := tooldocs.NewInMemoryStore(tooldocs.StoreOptions{\n  ToolResolver: func(id string) (*toolmodel.Tool, error) {\n    if id != \"tickets:create\" {\n      return nil, fmt.Errorf(\"unknown: %s\", id)\n    }\n    t := toolmodel.Tool{Namespace: \"tickets\"}\n    t.Name = \"create\"\n    t.Description = \"Create a support ticket\"\n    t.InputSchema = map[string]any{\"type\": \"object\"}\n    return &amp;t, nil\n  },\n})\n</code></pre>"},{"location":"library-docs-from-repos/tooldocs/usage/","title":"Usage","text":""},{"location":"library-docs-from-repos/tooldocs/usage/#register-docs","title":"Register docs","text":"<pre><code>store := tooldocs.NewInMemoryStore(tooldocs.StoreOptions{\n  Index:       idx,\n  MaxExamples: 3,\n})\n\nerr := store.RegisterDoc(\"tickets:create\", tooldocs.DocEntry{\n  Summary: \"Create a support ticket\",\n  Notes:   \"Requires authentication. Supports idempotency via request_id.\",\n  Examples: []tooldocs.ToolExample{\n    {\n      Title:       \"Minimal\",\n      Description: \"Create a low-priority ticket\",\n      Args:        map[string]any{\"title\": \"Login broken\"},\n      ResultHint:  \"Ticket object with id and status\",\n    },\n  },\n})\n</code></pre>"},{"location":"library-docs-from-repos/tooldocs/usage/#describe-tools","title":"Describe tools","text":"<pre><code>doc, _ := store.DescribeTool(\"tickets:create\", tooldocs.DetailSchema)\nfull, _ := store.DescribeTool(\"tickets:create\", tooldocs.DetailFull)\n</code></pre>"},{"location":"library-docs-from-repos/tooldocs/usage/#list-examples","title":"List examples","text":"<pre><code>examples, _ := store.ListExamples(\"tickets:create\", 2)\n</code></pre>"},{"location":"library-docs-from-repos/tooldocs/usage/#size-caps","title":"Size caps","text":"<p>Examples are validated at registration time:</p> <ul> <li><code>MaxArgsDepth = 5</code></li> <li><code>MaxArgsKeys = 50</code></li> <li><code>MaxDescriptionLen = 300</code></li> <li><code>MaxResultHintLen = 200</code></li> </ul>"},{"location":"library-docs-from-repos/toolrun/","title":"toolrun","text":"<p><code>toolrun</code> executes tools and chains. It resolves tools/backends, validates inputs/outputs against JSON Schema, dispatches to the correct executor, and normalizes results.</p>"},{"location":"library-docs-from-repos/toolrun/#motivation","title":"Motivation","text":"<ul> <li>Consistent execution across MCP, provider, and local tools</li> <li>Safety via schema validation and normalized results</li> <li>Usability with clear error wrapping and chain semantics</li> </ul>"},{"location":"library-docs-from-repos/toolrun/#key-apis","title":"Key APIs","text":"<ul> <li><code>Runner</code> interface</li> <li><code>DefaultRunner</code> (via <code>NewRunner</code>)</li> <li><code>Run</code>, <code>RunStream</code>, <code>RunChain</code></li> <li><code>ChainStep</code>, <code>RunResult</code>, <code>StreamEvent</code></li> </ul>"},{"location":"library-docs-from-repos/toolrun/#quickstart","title":"Quickstart","text":"<pre><code>runner := toolrun.NewRunner(\n  toolrun.WithIndex(idx),\n  toolrun.WithMCPExecutor(mcpExec),\n  toolrun.WithLocalRegistry(localRegistry),\n)\n\nres, _ := runner.Run(ctx, \"github:get_repo\", map[string]any{\"owner\": \"o\", \"repo\": \"r\"})\n</code></pre>"},{"location":"library-docs-from-repos/toolrun/#usability-notes","title":"Usability notes","text":"<ul> <li>Backend selection is deterministic by default</li> <li>Chain steps can inject <code>previous</code> results</li> <li>Streaming is optional; non-streaming backends return <code>ErrStreamNotSupported</code></li> </ul>"},{"location":"library-docs-from-repos/toolrun/#next","title":"Next","text":"<ul> <li>Execution pipeline: <code>architecture.md</code></li> <li>Configuration and options: <code>usage.md</code></li> <li>Examples: <code>examples.md</code></li> </ul>"},{"location":"library-docs-from-repos/toolrun/architecture/","title":"Architecture","text":"<p><code>toolrun</code> implements a consistent execution pipeline with validation and backend dispatch. It is transport-agnostic and depends on <code>toolmodel</code> types.</p>"},{"location":"library-docs-from-repos/toolrun/architecture/#single-tool-execution","title":"Single-tool execution","text":"<pre><code>flowchart LR\n  A[Run] --&gt; B[Resolve tool + backends]\n  B --&gt; C[Select backend]\n  C --&gt; D[Validate input]\n  D --&gt; E[Dispatch]\n  E --&gt; F[Normalize result]\n  F --&gt; G[Validate output]\n\n  subgraph Dispatch\n    M[MCP executor]\n    P[Provider executor]\n    L[Local registry]\n  end\n  E --&gt; M\n  E --&gt; P\n  E --&gt; L</code></pre>"},{"location":"library-docs-from-repos/toolrun/architecture/#chain-execution","title":"Chain execution","text":"<pre><code>sequenceDiagram\n  participant R as Runner\n  participant T1 as Tool 1\n  participant T2 as Tool 2\n\n  R-&gt;&gt;T1: Run(step1)\n  T1--&gt;&gt;R: Result\n  R-&gt;&gt;T2: Run(step2, previous)\n  T2--&gt;&gt;R: Result</code></pre>"},{"location":"library-docs-from-repos/toolrun/examples/","title":"Examples","text":""},{"location":"library-docs-from-repos/toolrun/examples/#local-tool-execution","title":"Local tool execution","text":"<pre><code>registry := toolrun.NewLocalRegistry()\nregistry.Register(\"ping\", func(ctx context.Context, args map[string]any) (any, error) {\n  return map[string]any{\"ok\": true}, nil\n})\n\nrunner := toolrun.NewRunner(\n  toolrun.WithIndex(idx),\n  toolrun.WithLocalRegistry(registry),\n)\n\nres, _ := runner.Run(ctx, \"local:ping\", map[string]any{})\n</code></pre>"},{"location":"library-docs-from-repos/toolrun/examples/#streaming","title":"Streaming","text":"<pre><code>ch, err := runner.RunStream(ctx, \"logs:stream\", map[string]any{\"tail\": 100})\nif err != nil {\n  // handle ErrStreamNotSupported\n}\nfor ev := range ch {\n  fmt.Println(ev.Data)\n}\n</code></pre>"},{"location":"library-docs-from-repos/toolrun/examples/#backend-resolution-fallback","title":"Backend resolution fallback","text":"<pre><code>runner := toolrun.NewRunner(\n  toolrun.WithToolResolver(func(id string) (*toolmodel.Tool, error) {\n    // resolve from external store\n    return &amp;tool, nil\n  }),\n  toolrun.WithBackendsResolver(func(id string) ([]toolmodel.ToolBackend, error) {\n    return []toolmodel.ToolBackend{backend}, nil\n  }),\n)\n</code></pre>"},{"location":"library-docs-from-repos/toolrun/usage/","title":"Usage","text":""},{"location":"library-docs-from-repos/toolrun/usage/#configure-a-runner","title":"Configure a runner","text":"<pre><code>runner := toolrun.NewRunner(\n  toolrun.WithIndex(idx),\n  toolrun.WithMCPExecutor(mcpExec),\n  toolrun.WithProviderExecutor(providerExec),\n  toolrun.WithLocalRegistry(localRegistry),\n)\n</code></pre>"},{"location":"library-docs-from-repos/toolrun/usage/#validation-control","title":"Validation control","text":"<pre><code>runner := toolrun.NewRunner(\n  toolrun.WithIndex(idx),\n  toolrun.WithValidation(true, false), // validate input, skip output\n)\n</code></pre>"},{"location":"library-docs-from-repos/toolrun/usage/#run-a-tool","title":"Run a tool","text":"<pre><code>res, err := runner.Run(ctx, \"github:get_repo\", map[string]any{\n  \"owner\": \"octo\",\n  \"repo\":  \"hello\",\n})\n</code></pre>"},{"location":"library-docs-from-repos/toolrun/usage/#run-a-chain","title":"Run a chain","text":"<pre><code>steps := []toolrun.ChainStep{\n  {ToolID: \"user:get\", Args: map[string]any{\"user_id\": \"123\"}},\n  {ToolID: \"orders:list\", UsePrevious: true},\n}\n\nfinal, all, err := runner.RunChain(ctx, steps)\n</code></pre>"},{"location":"library-docs-from-repos/toolcode/","title":"toolcode","text":"<p><code>toolcode</code> executes short orchestration snippets over the tool stack. It exposes Search/Describe/Run helpers to code, enforces timeouts and limits, and records tool calls for observability.</p>"},{"location":"library-docs-from-repos/toolcode/#motivation","title":"Motivation","text":"<ul> <li>Programmable orchestration: loops, conditionals, fallbacks</li> <li>Uniform tool surface: same helpers regardless of backend</li> <li>Traceability: tool call records for debugging and audits</li> </ul>"},{"location":"library-docs-from-repos/toolcode/#key-apis","title":"Key APIs","text":"<ul> <li><code>Executor</code> interface (<code>ExecuteCode</code>)</li> <li><code>DefaultExecutor</code> implementation</li> <li><code>Engine</code> interface (pluggable runtime)</li> <li><code>ExecuteParams</code>, <code>ExecuteResult</code>, <code>ToolCallRecord</code></li> </ul>"},{"location":"library-docs-from-repos/toolcode/#quickstart","title":"Quickstart","text":"<pre><code>exec, _ := toolcode.NewDefaultExecutor(toolcode.Config{\n  Index:  idx,\n  Docs:   docs,\n  Run:    runner,\n  Engine: engine,\n})\n\nres, _ := exec.ExecuteCode(ctx, toolcode.ExecuteParams{\n  Language: \"go\",\n  Code:     \"__out = 2 + 2\",\n})\n</code></pre>"},{"location":"library-docs-from-repos/toolcode/#usability-notes","title":"Usability notes","text":"<ul> <li><code>ExecuteParams</code> supports per-call timeouts</li> <li>Tool calls are capped via config and params</li> <li><code>ExecuteResult</code> includes tool call traces</li> </ul>"},{"location":"library-docs-from-repos/toolcode/#next","title":"Next","text":"<ul> <li>Execution pipeline: <code>architecture.md</code></li> <li>Config, limits, and params: <code>usage.md</code></li> <li>Examples: <code>examples.md</code></li> </ul>"},{"location":"library-docs-from-repos/toolcode/architecture/","title":"Architecture","text":"<p><code>toolcode</code> wraps tool discovery, docs, and execution into a single programmable surface. The actual code execution is delegated to an injected <code>Engine</code>.</p>"},{"location":"library-docs-from-repos/toolcode/architecture/#execution-flow","title":"Execution flow","text":"<pre><code>flowchart LR\n  A[Executor] --&gt; B[Engine]\n  A --&gt; C[toolindex]\n  A --&gt; D[tooldocs]\n  A --&gt; E[toolrun]\n\n  B --&gt; F[toolruntime (optional)]</code></pre>"},{"location":"library-docs-from-repos/toolcode/architecture/#snippet-lifecycle","title":"Snippet lifecycle","text":"<pre><code>sequenceDiagram\n  participant Client\n  participant Exec as toolcode\n  participant Eng as Engine\n  participant Run as toolrun\n\n  Client-&gt;&gt;Exec: ExecuteCode(params)\n  Exec-&gt;&gt;Eng: Execute(params, Tools)\n  Eng-&gt;&gt;Run: RunTool(...) / RunChain(...)\n  Run--&gt;&gt;Eng: results\n  Eng--&gt;&gt;Exec: ExecuteResult\n  Exec--&gt;&gt;Client: ExecuteResult</code></pre>"},{"location":"library-docs-from-repos/toolcode/architecture/#control-points","title":"Control points","text":"<ul> <li><code>Config</code> controls limits and defaults</li> <li><code>Engine</code> controls the execution sandbox</li> <li><code>Tools</code> surface mediates tool calls and captures traces</li> </ul>"},{"location":"library-docs-from-repos/toolcode/examples/","title":"Examples","text":""},{"location":"library-docs-from-repos/toolcode/examples/#minimal-snippet","title":"Minimal snippet","text":"<pre><code>res, _ := exec.ExecuteCode(ctx, toolcode.ExecuteParams{\n  Language: \"go\",\n  Code:     \"__out = 2 + 2\",\n})\n</code></pre>"},{"location":"library-docs-from-repos/toolcode/examples/#tool-selection-execution","title":"Tool selection + execution","text":"<pre><code>code := `\n  tools := SearchTools(\"get repo\", 3)\n  if len(tools) == 0 {\n    __out = \"no tools\"\n  } else {\n    __out = RunTool(tools[0].ID, map[string]any{\"owner\":\"octo\",\"repo\":\"hello\"})\n  }\n`\n\nres, _ := exec.ExecuteCode(ctx, toolcode.ExecuteParams{Language: \"go\", Code: code})\n</code></pre>"},{"location":"library-docs-from-repos/toolcode/examples/#chain-helper","title":"Chain helper","text":"<pre><code>steps := []ChainStep{\n  {ToolID: \"user:get\", Args: map[string]any{\"user_id\": \"123\"}},\n  {ToolID: \"orders:list\", UsePrevious: true},\n}\n\ncode := `__out = RunChain(steps)`\n</code></pre>"},{"location":"library-docs-from-repos/toolcode/usage/","title":"Usage","text":""},{"location":"library-docs-from-repos/toolcode/usage/#configure-an-executor","title":"Configure an executor","text":"<pre><code>exec, err := toolcode.NewDefaultExecutor(toolcode.Config{\n  Index:          idx,\n  Docs:           docs,\n  Run:            runner,\n  Engine:         engine,\n  DefaultTimeout: 5 * time.Second,\n  MaxToolCalls:   32,\n  MaxChainSteps:  8,\n})\nif err != nil {\n  // handle config error\n}\n</code></pre>"},{"location":"library-docs-from-repos/toolcode/usage/#execute-a-snippet","title":"Execute a snippet","text":"<pre><code>res, err := exec.ExecuteCode(ctx, toolcode.ExecuteParams{\n  Language: \"go\",\n  Code: `\n    tools := SearchTools(\"repo\", 3)\n    repo := RunTool(tools[0].ID, map[string]any{\"owner\":\"o\",\"repo\":\"r\"})\n    __out = repo\n  `,\n})\n</code></pre>"},{"location":"library-docs-from-repos/toolcode/usage/#limits","title":"Limits","text":"<ul> <li><code>MaxToolCalls</code> caps tool invocations per execution</li> <li><code>MaxChainSteps</code> caps chain length</li> <li><code>DefaultTimeout</code> applies when params omit a timeout</li> </ul>"},{"location":"library-docs-from-repos/toolruntime/","title":"toolruntime","text":"<p><code>toolruntime</code> defines the runtime and trust boundary for executing code in <code>toolcode</code>. It routes execution to backends with configurable security profiles.</p>"},{"location":"library-docs-from-repos/toolruntime/#motivation","title":"Motivation","text":"<ul> <li>Isolation for untrusted or semi-trusted code</li> <li>Portability across environments (host, containers, VMs)</li> <li>Policy via explicit security profiles</li> </ul>"},{"location":"library-docs-from-repos/toolruntime/#key-apis","title":"Key APIs","text":"<ul> <li><code>Runtime</code> interface</li> <li><code>DefaultRuntime</code> implementation</li> <li><code>Backend</code> interface</li> <li><code>SecurityProfile</code> (dev/standard/hardened)</li> <li><code>ExecuteRequest</code> / <code>ExecuteResult</code></li> </ul>"},{"location":"library-docs-from-repos/toolruntime/#quickstart-dev","title":"Quickstart (dev)","text":"<pre><code>backend := unsafe.New(unsafe.Config{Mode: unsafe.ModeSubprocess})\n\nrt := toolruntime.NewDefaultRuntime(toolruntime.RuntimeConfig{\n  Backends: map[toolruntime.SecurityProfile]toolruntime.Backend{\n    toolruntime.ProfileDev: backend,\n  },\n  DefaultProfile: toolruntime.ProfileDev,\n})\n</code></pre>"},{"location":"library-docs-from-repos/toolruntime/#usability-notes","title":"Usability notes","text":"<ul> <li>Profiles keep policy separate from implementation</li> <li>Backends are swappable without changing the executor API</li> <li>Tool calls are mediated via the gateway interface</li> </ul>"},{"location":"library-docs-from-repos/toolruntime/#next","title":"Next","text":"<ul> <li>Runtime pipeline and profiles: <code>architecture.md</code></li> <li>Backend configuration: <code>usage.md</code></li> <li>Examples: <code>examples.md</code></li> </ul>"},{"location":"library-docs-from-repos/toolruntime/architecture/","title":"Architecture","text":"<p><code>toolruntime</code> is the execution boundary underneath <code>toolcode</code>. It chooses a backend based on the requested security profile.</p>"},{"location":"library-docs-from-repos/toolruntime/architecture/#runtime-selection","title":"Runtime selection","text":"<pre><code>flowchart LR\n  A[ExecuteRequest] --&gt; B[DefaultRuntime]\n  B --&gt; C[Profile selection]\n  C --&gt; D[Backend]\n\n  subgraph Backends\n    U[unsafe host]\n    Dk[docker]\n    K8s[kubernetes]\n    Gv[gvisor]\n    Fc[firecracker]\n    W[wasm]\n  end</code></pre>"},{"location":"library-docs-from-repos/toolruntime/architecture/#execution-sequence","title":"Execution sequence","text":"<pre><code>sequenceDiagram\n  participant Client\n  participant RT as Runtime\n  participant BE as Backend\n  participant GW as ToolGateway\n\n  Client-&gt;&gt;RT: Execute(req)\n  RT-&gt;&gt;BE: Execute(req)\n  BE-&gt;&gt;GW: tool calls\n  GW--&gt;&gt;BE: tool results\n  BE--&gt;&gt;RT: ExecuteResult\n  RT--&gt;&gt;Client: ExecuteResult</code></pre>"},{"location":"library-docs-from-repos/toolruntime/architecture/#profiles","title":"Profiles","text":"<ul> <li><code>dev</code>: convenience, unsafe host allowed</li> <li><code>standard</code>: safer defaults, may deny unsafe backend</li> <li><code>hardened</code>: expected to require strong isolation</li> </ul>"},{"location":"library-docs-from-repos/toolruntime/examples/","title":"Examples","text":""},{"location":"library-docs-from-repos/toolruntime/examples/#toolcode-integration","title":"Toolcode integration","text":"<pre><code>engine := toolcodeengine.New(toolcodeengine.Config{\n  Runtime: rt,\n  Profile: toolruntime.ProfileDev,\n})\n\nexec, _ := toolcode.NewDefaultExecutor(toolcode.Config{\n  Index:  idx,\n  Docs:   docs,\n  Run:    runner,\n  Engine: engine,\n})\n</code></pre>"},{"location":"library-docs-from-repos/toolruntime/examples/#inspect-tool-calls","title":"Inspect tool calls","text":"<pre><code>res, _ := rt.Execute(ctx, toolruntime.ExecuteRequest{\n  Language: \"go\",\n  Code:     \"__out = 1\",\n  Profile:  toolruntime.ProfileDev,\n  Gateway:  gw,\n})\n\nfor _, call := range res.ToolCalls {\n  fmt.Println(call.ToolID, call.Duration)\n}\n</code></pre>"},{"location":"library-docs-from-repos/toolruntime/usage/","title":"Usage","text":""},{"location":"library-docs-from-repos/toolruntime/usage/#create-a-runtime","title":"Create a runtime","text":"<pre><code>rt := toolruntime.NewDefaultRuntime(toolruntime.RuntimeConfig{\n  Backends: map[toolruntime.SecurityProfile]toolruntime.Backend{\n    toolruntime.ProfileDev: unsafe.New(unsafe.Config{Mode: unsafe.ModeSubprocess}),\n  },\n  DefaultProfile: toolruntime.ProfileDev,\n})\n</code></pre>"},{"location":"library-docs-from-repos/toolruntime/usage/#execute-code","title":"Execute code","text":"<pre><code>res, err := rt.Execute(ctx, toolruntime.ExecuteRequest{\n  Language: \"go\",\n  Code:     \"__out = 2 + 2\",\n  Profile:  toolruntime.ProfileDev,\n  Gateway:  gw,\n})\n</code></pre>"},{"location":"library-docs-from-repos/toolruntime/usage/#deny-unsafe-backend","title":"Deny unsafe backend","text":"<pre><code>rt := toolruntime.NewDefaultRuntime(toolruntime.RuntimeConfig{\n  Backends: map[toolruntime.SecurityProfile]toolruntime.Backend{\n    toolruntime.ProfileDev: unsafe.New(unsafe.Config{Mode: unsafe.ModeSubprocess}),\n  },\n  DenyUnsafeProfiles: []toolruntime.SecurityProfile{toolruntime.ProfileStandard},\n  DefaultProfile:     toolruntime.ProfileStandard,\n})\n</code></pre>"},{"location":"library-docs-from-repos/toolsearch/","title":"toolsearch","text":"<p><code>toolsearch</code> provides higher-quality search strategies for <code>toolindex</code> while keeping heavy dependencies out of the core registry. Today it ships a BM25 searcher backed by Bleve.</p>"},{"location":"library-docs-from-repos/toolsearch/#motivation","title":"Motivation","text":"<ul> <li>Keep toolindex small while enabling stronger ranking</li> <li>Experiment safely with search without changing core behavior</li> <li>Deterministic results for stable agent behavior</li> </ul>"},{"location":"library-docs-from-repos/toolsearch/#key-apis","title":"Key APIs","text":"<ul> <li><code>BM25Searcher</code> (implements <code>toolindex.Searcher</code>)</li> <li><code>BM25Config</code> for ranking and safety caps</li> </ul>"},{"location":"library-docs-from-repos/toolsearch/#quickstart","title":"Quickstart","text":"<pre><code>searcher := toolsearch.NewBM25Searcher(toolsearch.BM25Config{})\nidx := toolindex.NewInMemoryIndex(toolindex.IndexOptions{Searcher: searcher})\n</code></pre>"},{"location":"library-docs-from-repos/toolsearch/#usability-notes","title":"Usability notes","text":"<ul> <li>Deterministic ordering avoids jitter in tool selection</li> <li>Index fingerprinting avoids rebuilds on no-op updates</li> </ul>"},{"location":"library-docs-from-repos/toolsearch/#next","title":"Next","text":"<ul> <li>Ranking pipeline: <code>architecture.md</code></li> <li>Configuration and caps: <code>usage.md</code></li> <li>Examples: <code>examples.md</code></li> </ul>"},{"location":"library-docs-from-repos/toolsearch/architecture/","title":"Architecture","text":"<p><code>toolsearch</code> is a pluggable search strategy for <code>toolindex</code>.</p>"},{"location":"library-docs-from-repos/toolsearch/architecture/#indexing-flow","title":"Indexing flow","text":"<pre><code>flowchart LR\n  A[Search docs] --&gt; B[Fingerprint]\n  B --&gt; C[BM25 index]\n  C --&gt; D[Ranked summaries]</code></pre>"},{"location":"library-docs-from-repos/toolsearch/architecture/#search-sequence","title":"Search sequence","text":"<pre><code>sequenceDiagram\n  participant Index\n  participant Searcher\n  participant Bleve\n\n  Index-&gt;&gt;Searcher: Search(query, docs)\n  Searcher-&gt;&gt;Searcher: Build index if fingerprint changed\n  Searcher-&gt;&gt;Bleve: Query\n  Bleve--&gt;&gt;Searcher: Hits\n  Searcher--&gt;&gt;Index: Summaries</code></pre>"},{"location":"library-docs-from-repos/toolsearch/architecture/#determinism","title":"Determinism","text":"<ul> <li>Docs are sorted by ID before indexing</li> <li>Tie-breaking uses score DESC, then ID ASC</li> <li>Fingerprints ensure stable caching</li> </ul>"},{"location":"library-docs-from-repos/toolsearch/examples/","title":"Examples","text":""},{"location":"library-docs-from-repos/toolsearch/examples/#deterministic-ranking","title":"Deterministic ranking","text":"<pre><code>searcher := toolsearch.NewBM25Searcher(toolsearch.BM25Config{})\nidx := toolindex.NewInMemoryIndex(toolindex.IndexOptions{Searcher: searcher})\n\nresults, _ := idx.Search(\"repo\", 10)\n// results are deterministic across runs\n</code></pre>"},{"location":"library-docs-from-repos/toolsearch/examples/#custom-boosts","title":"Custom boosts","text":"<pre><code>searcher := toolsearch.NewBM25Searcher(toolsearch.BM25Config{\n  NameBoost:      5,\n  NamespaceBoost: 3,\n  TagsBoost:      1,\n})\n</code></pre>"},{"location":"library-docs-from-repos/toolsearch/usage/","title":"Usage","text":""},{"location":"library-docs-from-repos/toolsearch/usage/#configure-bm25","title":"Configure BM25","text":"<pre><code>searcher := toolsearch.NewBM25Searcher(toolsearch.BM25Config{\n  NameBoost:      3,\n  NamespaceBoost: 2,\n  TagsBoost:      2,\n  MaxDocs:        5000,\n  MaxDocTextLen:  2000,\n})\n</code></pre>"},{"location":"library-docs-from-repos/toolsearch/usage/#inject-into-toolindex","title":"Inject into toolindex","text":"<pre><code>idx := toolindex.NewInMemoryIndex(toolindex.IndexOptions{Searcher: searcher})\n</code></pre>"},{"location":"library-docs-from-repos/toolsearch/usage/#safety-controls","title":"Safety controls","text":"<ul> <li><code>MaxDocs</code>: cap indexed documents</li> <li><code>MaxDocTextLen</code>: truncate long descriptions</li> </ul>"},{"location":"library-docs-from-repos/metatools-mcp/","title":"metatools-mcp","text":"<p><code>metatools-mcp</code> is the MCP server that exposes the tool stack via a small, progressive-disclosure tool surface. It composes toolmodel, toolindex, tooldocs, toolrun, and optionally toolcode/toolruntime.</p>"},{"location":"library-docs-from-repos/metatools-mcp/#motivation","title":"Motivation","text":"<ul> <li>One MCP surface for discovery, docs, and execution</li> <li>Progressive disclosure to keep tool context small</li> <li>Pluggable design for search, runtimes, and engines</li> </ul>"},{"location":"library-docs-from-repos/metatools-mcp/#mcp-tools-exposed","title":"MCP tools exposed","text":"<ul> <li><code>search_tools</code></li> <li><code>list_namespaces</code></li> <li><code>describe_tool</code></li> <li><code>list_tool_examples</code></li> <li><code>run_tool</code></li> <li><code>run_chain</code></li> <li><code>execute_code</code> (optional)</li> </ul>"},{"location":"library-docs-from-repos/metatools-mcp/#quickstart","title":"Quickstart","text":"<pre><code>idx := toolindex.NewInMemoryIndex()\ndocs := tooldocs.NewInMemoryStore(tooldocs.StoreOptions{Index: idx})\nrunner := toolrun.NewRunner(toolrun.WithIndex(idx))\n\ncfg := adapters.NewConfig(idx, docs, runner, nil)\nserver, _ := server.New(cfg)\n\n_ = server.Run(context.Background(), &amp;mcp.StdioTransport{})\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/#usability-notes","title":"Usability notes","text":"<ul> <li>Fewer MCP tools means simpler agent prompts</li> <li>Outputs are structured and aligned to MCP schemas</li> <li>Search and execution behaviors are deterministic by default</li> </ul>"},{"location":"library-docs-from-repos/metatools-mcp/#next","title":"Next","text":"<ul> <li>Server architecture: <code>architecture.md</code></li> <li>Configuration and env vars: <code>usage.md</code></li> <li>Examples: <code>examples.md</code></li> </ul>"},{"location":"library-docs-from-repos/metatools-mcp/architecture/","title":"Architecture","text":"<p><code>metatools-mcp</code> composes the core libraries and exposes a small MCP tool surface.</p>"},{"location":"library-docs-from-repos/metatools-mcp/architecture/#component-wiring","title":"Component wiring","text":"<pre><code>flowchart LR\n  A[metatools-mcp] --&gt; B[toolindex]\n  A --&gt; C[tooldocs]\n  A --&gt; D[toolrun]\n  A --&gt; E[toolcode]\n  E --&gt; F[toolruntime]\n\n  B --&gt; G[toolsearch]</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/architecture/#progressive-disclosure-flow","title":"Progressive disclosure flow","text":"<pre><code>sequenceDiagram\n  participant Agent\n  participant MCP as metatools-mcp\n  participant Index as toolindex\n  participant Docs as tooldocs\n  participant Run as toolrun\n\n  Agent-&gt;&gt;MCP: search_tools\n  MCP-&gt;&gt;Index: Search\n  Index--&gt;&gt;MCP: summaries\n  MCP--&gt;&gt;Agent: summaries\n\n  Agent-&gt;&gt;MCP: describe_tool (schema)\n  MCP-&gt;&gt;Docs: DescribeTool\n  Docs--&gt;&gt;MCP: tool schema\n  MCP--&gt;&gt;Agent: schema\n\n  Agent-&gt;&gt;MCP: run_tool\n  MCP-&gt;&gt;Run: Run\n  Run--&gt;&gt;MCP: result\n  MCP--&gt;&gt;Agent: result</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/architecture/#mcp-tool-mapping","title":"MCP tool mapping","text":"<pre><code>flowchart LR\n  search_tools --&gt; toolindex\n  list_namespaces --&gt; toolindex\n  describe_tool --&gt; tooldocs\n  list_tool_examples --&gt; tooldocs\n  run_tool --&gt; toolrun\n  run_chain --&gt; toolrun\n  execute_code --&gt; toolcode</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/examples/","title":"Examples","text":""},{"location":"library-docs-from-repos/metatools-mcp/examples/#register-a-local-tool-expose-mcp-server","title":"Register a local tool + expose MCP server","text":"<pre><code>idx := toolindex.NewInMemoryIndex()\n\nlocal := toolrun.NewLocalRegistry()\nlocal.Register(\"ping\", func(ctx context.Context, args map[string]any) (any, error) {\n  return map[string]any{\"ok\": true}, nil\n})\n\n_ = idx.RegisterTool(toolmodel.Tool{\n  Namespace: \"local\",\n  Tool: mcp.Tool{\n    Name:        \"ping\",\n    Description: \"Simple health check\",\n    InputSchema: map[string]any{\"type\": \"object\"},\n  },\n}, toolmodel.ToolBackend{\n  Kind:  toolmodel.BackendKindLocal,\n  Local: &amp;toolmodel.LocalBackend{Name: \"ping\"},\n})\n\nrunner := toolrun.NewRunner(toolrun.WithIndex(idx), toolrun.WithLocalRegistry(local))\n\ncfg := adapters.NewConfig(idx, tooldocs.NewInMemoryStore(tooldocs.StoreOptions{Index: idx}), runner, nil)\nserver, _ := server.New(cfg)\n_ = server.Run(context.Background(), &amp;mcp.StdioTransport{})\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/examples/#tool-search-and-execution","title":"Tool search and execution","text":"<pre><code>summaries, _ := idx.Search(\"ping\", 3)\n\nres, _ := runner.Run(ctx, summaries[0].ID, map[string]any{})\nfmt.Println(res.Structured)\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/usage/","title":"Usage","text":""},{"location":"library-docs-from-repos/metatools-mcp/usage/#build-and-run-stdio","title":"Build and run (stdio)","text":"<pre><code>go run ./cmd/metatools\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/usage/#enable-bm25-search-build-tag-env","title":"Enable BM25 search (build tag + env)","text":"<pre><code>go build -tags toolsearch ./cmd/metatools\nMETATOOLS_SEARCH_STRATEGY=bm25 ./metatools\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/usage/#environment-variables","title":"Environment variables","text":"Variable Default Description <code>METATOOLS_SEARCH_STRATEGY</code> <code>lexical</code> <code>lexical</code> or <code>bm25</code> <code>METATOOLS_SEARCH_BM25_NAME_BOOST</code> <code>3</code> BM25 name field boost <code>METATOOLS_SEARCH_BM25_NAMESPACE_BOOST</code> <code>2</code> BM25 namespace field boost <code>METATOOLS_SEARCH_BM25_TAGS_BOOST</code> <code>2</code> BM25 tags field boost <code>METATOOLS_SEARCH_BM25_MAX_DOCS</code> <code>0</code> Max docs to index (0=unlimited) <code>METATOOLS_SEARCH_BM25_MAX_DOCTEXT_LEN</code> <code>0</code> Max doc text length (0=unlimited)"},{"location":"library-docs-from-repos/metatools-mcp/usage/#optional-toolruntime-support","title":"Optional toolruntime support","text":"<pre><code>go run -tags toolruntime ./cmd/metatools\n</code></pre> <p>This enables <code>execute_code</code> backed by a <code>toolruntime</code> engine.</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/","title":"Pluggable Architecture Implementation Phases","text":"<p>Status: Draft Date: 2026-01-27 Related: Pluggable Architecture Proposal</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#overview","title":"Overview","text":"<p>This document breaks the pluggable architecture proposal into manageable implementation phases, following Go best practices and layered architecture principles. Each phase is designed to be:</p> <ul> <li>Independently deliverable - Can be merged and deployed after completion</li> <li>Backward compatible - Existing functionality continues to work</li> <li>Testable - Includes clear verification criteria</li> <li>Incremental - Builds on previous phases</li> </ul> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         IMPLEMENTATION ROADMAP                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                               \u2502\n\u2502   Phase 1 \u2500\u2500\u2500\u2500\u2500\u25ba Phase 2 \u2500\u2500\u2500\u2500\u2500\u25ba Phase 3 \u2500\u2500\u2500\u2500\u2500\u25ba Phase 4 \u2500\u2500\u2500\u2500\u2500\u25ba Phase 5       \u2502\n\u2502   CLI + Config   Transport     Tool Provider   Backend        Middleware     \u2502\n\u2502                  Abstraction   Registry        Registry       Chain          \u2502\n\u2502                                                                               \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502   \u2502 2 weeks  \u2502   \u2502 2 weeks  \u2502   \u2502 1 week   \u2502   \u2502 2 weeks  \u2502   \u2502 2 weeks  \u2502  \u2502\n\u2502   \u2502          \u2502   \u2502          \u2502   \u2502          \u2502   \u2502          \u2502   \u2502          \u2502  \u2502\n\u2502   \u2502 Cobra    \u2502   \u2502 Transport\u2502   \u2502 Provider \u2502   \u2502 Backend  \u2502   \u2502 Logging  \u2502  \u2502\n\u2502   \u2502 Koanf    \u2502   \u2502 Interface\u2502   \u2502 Interface\u2502   \u2502 Interface\u2502   \u2502 Auth     \u2502  \u2502\n\u2502   \u2502 YAML cfg \u2502   \u2502 Stdio    \u2502   \u2502 Registry \u2502   \u2502 Local    \u2502   \u2502 RateLimit\u2502  \u2502\n\u2502   \u2502          \u2502   \u2502 SSE      \u2502   \u2502 Migration\u2502   \u2502 MCP      \u2502   \u2502 Metrics  \u2502  \u2502\n\u2502   \u2502          \u2502   \u2502          \u2502   \u2502          \u2502   \u2502 HTTP     \u2502   \u2502          \u2502  \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                                                                               \u2502\n\u2502   MVP \u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba   \u2502\n\u2502   (Phases 1-2)                                                               \u2502\n\u2502                                                                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#phase-1-cli-framework-configuration-foundation","title":"Phase 1: CLI Framework &amp; Configuration (Foundation)","text":"<p>Duration: ~2 weeks Priority: Critical (foundation for all other phases) Risk: Low (additive changes, no breaking changes)</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#objective","title":"Objective","text":"<p>Introduce Cobra CLI framework and Koanf configuration library while maintaining backward compatibility with current environment variable configuration.</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#directory-structure-changes","title":"Directory Structure Changes","text":"<pre><code>cmd/metatools/\n\u251c\u2500\u2500 main.go              # Entry point (simplified)\n\u251c\u2500\u2500 root.go              # Root command\n\u251c\u2500\u2500 stdio.go             # `metatools stdio` (current behavior)\n\u251c\u2500\u2500 serve.go             # `metatools serve` (HTTP/SSE) - placeholder\n\u251c\u2500\u2500 version.go           # `metatools version`\n\u251c\u2500\u2500 validate.go          # `metatools validate` (config validation)\n\u251c\u2500\u2500 executor_toolruntime.go  # (unchanged)\n\u2514\u2500\u2500 executor_stub.go         # (unchanged)\n\ninternal/\n\u251c\u2500\u2500 config/\n\u2502   \u251c\u2500\u2500 env.go           # (unchanged - backward compat)\n\u2502   \u251c\u2500\u2500 loader.go        # NEW: Koanf-based config loader\n\u2502   \u251c\u2500\u2500 schema.go        # NEW: Config struct definitions\n\u2502   \u2514\u2500\u2500 defaults.go      # NEW: Default values\n\u2514\u2500\u2500 ...\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#implementation-tasks","title":"Implementation Tasks","text":""},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#11-add-dependencies","title":"1.1 Add Dependencies","text":"<pre><code>// go.mod additions\nrequire (\n    github.com/spf13/cobra v1.8.1\n    github.com/knadh/koanf/v2 v2.1.2\n    github.com/knadh/koanf/parsers/yaml v0.1.0\n    github.com/knadh/koanf/providers/env v1.0.0\n    github.com/knadh/koanf/providers/file v1.1.0\n)\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#12-configuration-schema-internalconfigschemago","title":"1.2 Configuration Schema (<code>internal/config/schema.go</code>)","text":"<pre><code>package config\n\n// ServerConfig is the root configuration structure\ntype ServerConfig struct {\n    Server    ServerSettings    `koanf:\"server\"`\n    Transport TransportConfig   `koanf:\"transport\"`\n    Search    SearchConfig      `koanf:\"search\"`\n    Execution ExecutionConfig   `koanf:\"execution\"`\n    Providers ProvidersConfig   `koanf:\"providers\"`\n    Backends  BackendsConfig    `koanf:\"backends\"`\n    Middleware MiddlewareConfig `koanf:\"middleware\"`\n}\n\ntype ServerSettings struct {\n    Name    string `koanf:\"name\"`\n    Version string `koanf:\"version\"`\n}\n\ntype TransportConfig struct {\n    Type string       `koanf:\"type\"` // stdio, sse, http\n    HTTP HTTPConfig   `koanf:\"http\"`\n}\n\ntype HTTPConfig struct {\n    Host     string        `koanf:\"host\"`\n    Port     int           `koanf:\"port\"`\n    TLS      TLSConfig     `koanf:\"tls\"`\n    Timeouts TimeoutConfig `koanf:\"timeouts\"`\n    CORS     CORSConfig    `koanf:\"cors\"`\n    Health   HealthConfig  `koanf:\"health\"`\n}\n\n// SearchConfig matches current EnvConfig.SearchConfig\ntype SearchConfig struct {\n    Strategy       string `koanf:\"strategy\"`\n    NameBoost      int    `koanf:\"name_boost\"`\n    NamespaceBoost int    `koanf:\"namespace_boost\"`\n    TagsBoost      int    `koanf:\"tags_boost\"`\n    MaxDocs        int    `koanf:\"max_docs\"`\n    MaxDocTextLen  int    `koanf:\"max_doctext_len\"`\n}\n\n// ... (additional config types)\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#13-configuration-loader-internalconfigloadergo","title":"1.3 Configuration Loader (<code>internal/config/loader.go</code>)","text":"<pre><code>package config\n\nimport (\n    \"github.com/knadh/koanf/v2\"\n    \"github.com/knadh/koanf/parsers/yaml\"\n    \"github.com/knadh/koanf/providers/env\"\n    \"github.com/knadh/koanf/providers/file\"\n)\n\ntype Loader struct {\n    k *koanf.Koanf\n}\n\n// Load loads configuration with precedence:\n// CLI flags &gt; Environment variables &gt; Config file &gt; Defaults\nfunc (l *Loader) Load(configPath string) (*ServerConfig, error) {\n    l.k = koanf.New(\".\")\n\n    // 1. Load defaults\n    if err := l.loadDefaults(); err != nil {\n        return nil, err\n    }\n\n    // 2. Load config file (if exists)\n    if configPath != \"\" {\n        if err := l.k.Load(file.Provider(configPath), yaml.Parser()); err != nil {\n            return nil, fmt.Errorf(\"loading config file: %w\", err)\n        }\n    }\n\n    // 3. Load environment variables (METATOOLS_ prefix)\n    if err := l.k.Load(env.Provider(\"METATOOLS_\", \".\", func(s string) string {\n        return strings.Replace(strings.ToLower(\n            strings.TrimPrefix(s, \"METATOOLS_\")), \"_\", \".\", -1)\n    }), nil); err != nil {\n        return nil, fmt.Errorf(\"loading env vars: %w\", err)\n    }\n\n    var cfg ServerConfig\n    if err := l.k.Unmarshal(\"\", &amp;cfg); err != nil {\n        return nil, fmt.Errorf(\"unmarshaling config: %w\", err)\n    }\n\n    return &amp;cfg, nil\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#14-cli-root-command-cmdmetatoolsrootgo","title":"1.4 CLI Root Command (<code>cmd/metatools/root.go</code>)","text":"<pre><code>package main\n\nimport (\n    \"os\"\n\n    \"github.com/spf13/cobra\"\n)\n\nvar (\n    cfgFile string\n    verbose bool\n)\n\nvar rootCmd = &amp;cobra.Command{\n    Use:   \"metatools\",\n    Short: \"MCP server for tool discovery and execution\",\n    Long: `metatools-mcp is a Model Context Protocol server that provides\nunified tool discovery, documentation, and execution capabilities.`,\n}\n\nfunc init() {\n    rootCmd.PersistentFlags().StringVarP(&amp;cfgFile, \"config\", \"c\", \"\",\n        \"config file (default: metatools.yaml)\")\n    rootCmd.PersistentFlags().BoolVarP(&amp;verbose, \"verbose\", \"v\", false,\n        \"verbose output\")\n\n    rootCmd.AddCommand(stdioCmd)\n    rootCmd.AddCommand(serveCmd)\n    rootCmd.AddCommand(versionCmd)\n    rootCmd.AddCommand(validateCmd)\n}\n\nfunc Execute() {\n    if err := rootCmd.Execute(); err != nil {\n        os.Exit(1)\n    }\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#15-stdio-command-cmdmetatoolsstdiogo","title":"1.5 Stdio Command (<code>cmd/metatools/stdio.go</code>)","text":"<pre><code>package main\n\nimport (\n    \"context\"\n    \"log\"\n    \"os/signal\"\n    \"syscall\"\n\n    \"github.com/spf13/cobra\"\n    \"github.com/modelcontextprotocol/go-sdk/mcp\"\n)\n\nvar stdioCmd = &amp;cobra.Command{\n    Use:   \"stdio\",\n    Short: \"Run as stdio MCP server (default mode)\",\n    Long:  `Runs the MCP server using stdin/stdout transport for MCP clients like Claude Desktop.`,\n    RunE:  runStdio,\n}\n\nfunc init() {\n    // Set as default command when no subcommand provided\n    rootCmd.Run = stdioCmd.Run\n}\n\nfunc runStdio(cmd *cobra.Command, args []string) error {\n    ctx, cancel := signal.NotifyContext(context.Background(), syscall.SIGINT, syscall.SIGTERM)\n    defer cancel()\n\n    srv, err := createServer()\n    if err != nil {\n        return fmt.Errorf(\"failed to create server: %w\", err)\n    }\n\n    tools := srv.ListTools()\n    log.Printf(\"metatools-mcp server starting with %d tools\", len(tools))\n\n    transport := &amp;mcp.StdioTransport{}\n    if err := srv.Run(ctx, transport); err != nil &amp;&amp; ctx.Err() == nil {\n        return fmt.Errorf(\"server error: %w\", err)\n    }\n\n    log.Println(\"Server stopped\")\n    return nil\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#verification-criteria","title":"Verification Criteria","text":"<ul> <li>[ ] <code>metatools stdio</code> works identically to current behavior</li> <li>[ ] <code>metatools version</code> prints version info</li> <li>[ ] <code>metatools validate -c config.yaml</code> validates configuration files</li> <li>[ ] Existing environment variables (<code>METATOOLS_SEARCH_*</code>) continue to work</li> <li>[ ] New YAML config file loading works</li> <li>[ ] Config precedence: CLI &gt; Env &gt; File &gt; Defaults</li> <li>[ ] All existing tests pass</li> <li>[ ] New unit tests for config loader (&gt;80% coverage)</li> </ul>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#migration-notes","title":"Migration Notes","text":"<ul> <li>No breaking changes</li> <li><code>metatools</code> (no args) defaults to <code>metatools stdio</code></li> <li>Environment variable prefix remains <code>METATOOLS_</code></li> </ul>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#phase-2-transport-layer-abstraction","title":"Phase 2: Transport Layer Abstraction","text":"<p>Duration: ~2 weeks Priority: High (enables multi-modal deployment) Risk: Medium (touches core server logic) Depends on: Phase 1</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#objective_1","title":"Objective","text":"<p>Abstract the transport layer so the same server logic can run over stdio, SSE, or HTTP.</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#directory-structure-changes_1","title":"Directory Structure Changes","text":"<pre><code>internal/\n\u251c\u2500\u2500 transport/\n\u2502   \u251c\u2500\u2500 transport.go     # NEW: Transport interface\n\u2502   \u251c\u2500\u2500 registry.go      # NEW: Transport registry\n\u2502   \u251c\u2500\u2500 stdio.go         # NEW: Stdio transport wrapper\n\u2502   \u251c\u2500\u2500 sse.go           # NEW: SSE transport\n\u2502   \u2514\u2500\u2500 http.go          # NEW: HTTP transport (optional)\n\u251c\u2500\u2500 server/\n\u2502   \u251c\u2500\u2500 server.go        # MODIFIED: Use Transport interface\n\u2502   \u2514\u2500\u2500 handler.go       # NEW: Shared request handler\n\u2514\u2500\u2500 ...\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#implementation-tasks_1","title":"Implementation Tasks","text":""},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#21-transport-interface-internaltransporttransportgo","title":"2.1 Transport Interface (<code>internal/transport/transport.go</code>)","text":"<pre><code>package transport\n\nimport (\n    \"context\"\n)\n\n// Transport defines how MCP clients connect to the server\ntype Transport interface {\n    // Name returns the transport identifier\n    Name() string\n\n    // Serve starts the transport and blocks until ctx is cancelled\n    Serve(ctx context.Context, handler RequestHandler) error\n\n    // Close gracefully shuts down the transport\n    Close() error\n\n    // Info returns runtime information about the transport\n    Info() Info\n}\n\n// RequestHandler processes incoming MCP requests\ntype RequestHandler interface {\n    HandleRequest(ctx context.Context, req *Request) (*Response, error)\n}\n\n// Info provides runtime details about a transport\ntype Info struct {\n    Name      string\n    Listening bool\n    Address   string\n    Metadata  map[string]string\n}\n\n// Config holds transport-specific configuration\ntype Config struct {\n    Type      string\n    HTTP      HTTPConfig\n    WebSocket WebSocketConfig\n    GRPC      GRPCConfig\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#22-transport-registry-internaltransportregistrygo","title":"2.2 Transport Registry (<code>internal/transport/registry.go</code>)","text":"<pre><code>package transport\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\n// Factory creates a configured transport instance\ntype Factory func(cfg Config) (Transport, error)\n\n// Registry manages available transports\ntype Registry struct {\n    mu         sync.RWMutex\n    transports map[string]Factory\n}\n\n// NewRegistry creates a new transport registry with built-in transports\nfunc NewRegistry() *Registry {\n    r := &amp;Registry{\n        transports: make(map[string]Factory),\n    }\n\n    // Register built-in transports\n    r.Register(\"stdio\", NewStdioTransport)\n    r.Register(\"sse\", NewSSETransport)\n    r.Register(\"http\", NewHTTPTransport)\n\n    return r\n}\n\n// Register adds a transport factory\nfunc (r *Registry) Register(name string, factory Factory) {\n    r.mu.Lock()\n    defer r.mu.Unlock()\n    r.transports[name] = factory\n}\n\n// Create instantiates a transport from config\nfunc (r *Registry) Create(cfg Config) (Transport, error) {\n    r.mu.RLock()\n    factory, ok := r.transports[cfg.Type]\n    r.mu.RUnlock()\n\n    if !ok {\n        return nil, fmt.Errorf(\"unknown transport type: %s\", cfg.Type)\n    }\n\n    return factory(cfg)\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#23-stdio-transport-internaltransportstdiogo","title":"2.3 Stdio Transport (<code>internal/transport/stdio.go</code>)","text":"<pre><code>package transport\n\nimport (\n    \"context\"\n\n    \"github.com/modelcontextprotocol/go-sdk/mcp\"\n)\n\n// StdioTransport wraps the MCP SDK's stdio transport\ntype StdioTransport struct {\n    sdk *mcp.StdioTransport\n}\n\n// NewStdioTransport creates a stdio transport\nfunc NewStdioTransport(cfg Config) (Transport, error) {\n    return &amp;StdioTransport{\n        sdk: &amp;mcp.StdioTransport{},\n    }, nil\n}\n\nfunc (t *StdioTransport) Name() string { return \"stdio\" }\n\nfunc (t *StdioTransport) Serve(ctx context.Context, handler RequestHandler) error {\n    // Adapt to MCP SDK's transport interface\n    return t.sdk.Run(ctx, adaptHandler(handler))\n}\n\nfunc (t *StdioTransport) Close() error { return nil }\n\nfunc (t *StdioTransport) Info() Info {\n    return Info{\n        Name:      \"stdio\",\n        Listening: true,\n        Address:   \"stdin/stdout\",\n    }\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#24-sse-transport-internaltransportssego","title":"2.4 SSE Transport (<code>internal/transport/sse.go</code>)","text":"<pre><code>package transport\n\nimport (\n    \"context\"\n    \"encoding/json\"\n    \"fmt\"\n    \"net/http\"\n    \"sync\"\n    \"time\"\n)\n\n// SSETransport implements Server-Sent Events transport\ntype SSETransport struct {\n    cfg      HTTPConfig\n    server   *http.Server\n    handler  RequestHandler\n    mu       sync.RWMutex\n    clients  map[string]chan []byte\n}\n\n// NewSSETransport creates an SSE transport\nfunc NewSSETransport(cfg Config) (Transport, error) {\n    return &amp;SSETransport{\n        cfg:     cfg.HTTP,\n        clients: make(map[string]chan []byte),\n    }, nil\n}\n\nfunc (t *SSETransport) Name() string { return \"sse\" }\n\nfunc (t *SSETransport) Serve(ctx context.Context, handler RequestHandler) error {\n    t.handler = handler\n\n    mux := http.NewServeMux()\n    mux.HandleFunc(\"/mcp\", t.handleMCP)\n    mux.HandleFunc(\"/health\", t.handleHealth)\n    mux.HandleFunc(\"/ready\", t.handleReady)\n\n    addr := fmt.Sprintf(\"%s:%d\", t.cfg.Host, t.cfg.Port)\n    t.server = &amp;http.Server{\n        Addr:         addr,\n        Handler:      t.applyCORS(mux),\n        ReadTimeout:  t.cfg.Timeouts.Read,\n        WriteTimeout: t.cfg.Timeouts.Write,\n        IdleTimeout:  t.cfg.Timeouts.Idle,\n    }\n\n    // Start server in goroutine\n    errCh := make(chan error, 1)\n    go func() {\n        if t.cfg.TLS.Enabled {\n            errCh &lt;- t.server.ListenAndServeTLS(t.cfg.TLS.Cert, t.cfg.TLS.Key)\n        } else {\n            errCh &lt;- t.server.ListenAndServe()\n        }\n    }()\n\n    // Wait for context cancellation or error\n    select {\n    case &lt;-ctx.Done():\n        shutdownCtx, cancel := context.WithTimeout(context.Background(), 30*time.Second)\n        defer cancel()\n        return t.server.Shutdown(shutdownCtx)\n    case err := &lt;-errCh:\n        return err\n    }\n}\n\nfunc (t *SSETransport) handleMCP(w http.ResponseWriter, r *http.Request) {\n    if r.Method != http.MethodPost {\n        http.Error(w, \"Method not allowed\", http.StatusMethodNotAllowed)\n        return\n    }\n\n    // Set SSE headers\n    w.Header().Set(\"Content-Type\", \"text/event-stream\")\n    w.Header().Set(\"Cache-Control\", \"no-cache\")\n    w.Header().Set(\"Connection\", \"keep-alive\")\n\n    // Parse request\n    var req Request\n    if err := json.NewDecoder(r.Body).Decode(&amp;req); err != nil {\n        t.sendError(w, \"Invalid request\", http.StatusBadRequest)\n        return\n    }\n\n    // Handle request\n    resp, err := t.handler.HandleRequest(r.Context(), &amp;req)\n    if err != nil {\n        t.sendError(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    // Send response as SSE event\n    t.sendEvent(w, \"message\", resp)\n    t.sendEvent(w, \"done\", struct{}{})\n}\n\nfunc (t *SSETransport) sendEvent(w http.ResponseWriter, event string, data any) {\n    jsonData, _ := json.Marshal(data)\n    fmt.Fprintf(w, \"event: %s\\ndata: %s\\n\\n\", event, jsonData)\n    if f, ok := w.(http.Flusher); ok {\n        f.Flush()\n    }\n}\n\n// ... additional helper methods\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#25-server-modifications-internalserverservergo","title":"2.5 Server Modifications (<code>internal/server/server.go</code>)","text":"<pre><code>// Run now accepts our Transport interface\nfunc (s *Server) Run(ctx context.Context, t transport.Transport) error {\n    log.Printf(\"Starting server with %s transport\", t.Name())\n    return t.Serve(ctx, s)\n}\n\n// HandleRequest implements transport.RequestHandler\nfunc (s *Server) HandleRequest(ctx context.Context, req *transport.Request) (*transport.Response, error) {\n    // Delegate to MCP SDK's request handling\n    return s.mcp.HandleRequest(ctx, req)\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#verification-criteria_1","title":"Verification Criteria","text":"<ul> <li>[ ] <code>metatools stdio</code> works identically to Phase 1</li> <li>[ ] <code>metatools serve --port 8080</code> starts SSE server</li> <li>[ ] SSE endpoint accepts POST requests at <code>/mcp</code></li> <li>[ ] Health check endpoints work (<code>/health</code>, <code>/ready</code>)</li> <li>[ ] CORS headers applied correctly</li> <li>[ ] Graceful shutdown on SIGTERM</li> <li>[ ] TLS works when configured</li> <li>[ ] Integration tests for SSE transport</li> <li>[ ] Load test: 100 concurrent SSE connections</li> </ul>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#cli-changes","title":"CLI Changes","text":"<pre><code># New serve command\nmetatools serve [flags]\n\nFlags:\n  --port int          HTTP port (default 8080)\n  --host string       Bind address (default \"0.0.0.0\")\n  --tls               Enable TLS\n  --cert string       TLS certificate path\n  --key string        TLS key path\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#phase-3-tool-provider-registry","title":"Phase 3: Tool Provider Registry","text":"<p>Duration: ~1 week Priority: High (enables plug-and-play tools) Risk: Medium (refactors core registration logic) Depends on: Phase 1</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#objective_2","title":"Objective","text":"<p>Replace hardcoded tool registration with a registry pattern that allows dynamic tool registration.</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#directory-structure-changes_2","title":"Directory Structure Changes","text":"<pre><code>internal/\n\u251c\u2500\u2500 provider/\n\u2502   \u251c\u2500\u2500 provider.go      # NEW: ToolProvider interface\n\u2502   \u251c\u2500\u2500 registry.go      # NEW: Tool registry\n\u2502   \u251c\u2500\u2500 search.go        # NEW: search_tools provider\n\u2502   \u251c\u2500\u2500 describe.go      # NEW: describe_tool provider\n\u2502   \u251c\u2500\u2500 run.go           # NEW: run_tool provider\n\u2502   \u251c\u2500\u2500 chain.go         # NEW: run_chain provider\n\u2502   \u251c\u2500\u2500 namespaces.go    # NEW: list_namespaces provider\n\u2502   \u251c\u2500\u2500 examples.go      # NEW: list_tool_examples provider\n\u2502   \u2514\u2500\u2500 code.go          # NEW: execute_code provider (optional)\n\u251c\u2500\u2500 server/\n\u2502   \u2514\u2500\u2500 server.go        # MODIFIED: Use provider registry\n\u2514\u2500\u2500 ...\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#implementation-tasks_2","title":"Implementation Tasks","text":""},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#31-tool-provider-interface-internalproviderprovidergo","title":"3.1 Tool Provider Interface (<code>internal/provider/provider.go</code>)","text":"<pre><code>package provider\n\nimport (\n    \"context\"\n\n    \"github.com/modelcontextprotocol/go-sdk/mcp\"\n)\n\n// ToolProvider defines a pluggable MCP tool\ntype ToolProvider interface {\n    // Name returns the tool name (e.g., \"search_tools\")\n    Name() string\n\n    // Tool returns the MCP tool definition with JSON schema\n    Tool() *mcp.Tool\n\n    // Handle executes the tool with the given input\n    Handle(ctx context.Context, input map[string]any) (*mcp.CallToolResult, error)\n}\n\n// Option configures a tool provider\ntype Option func(ToolProvider)\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#32-tool-registry-internalproviderregistrygo","title":"3.2 Tool Registry (<code>internal/provider/registry.go</code>)","text":"<pre><code>package provider\n\nimport (\n    \"fmt\"\n    \"sync\"\n\n    \"github.com/modelcontextprotocol/go-sdk/mcp\"\n)\n\n// Registry manages registered tool providers\ntype Registry struct {\n    mu        sync.RWMutex\n    providers map[string]ToolProvider\n    order     []string // Maintains registration order\n}\n\n// NewRegistry creates a new tool provider registry\nfunc NewRegistry() *Registry {\n    return &amp;Registry{\n        providers: make(map[string]ToolProvider),\n        order:     make([]string, 0),\n    }\n}\n\n// Register adds a tool provider\nfunc (r *Registry) Register(p ToolProvider) error {\n    r.mu.Lock()\n    defer r.mu.Unlock()\n\n    name := p.Name()\n    if _, exists := r.providers[name]; exists {\n        return fmt.Errorf(\"provider already registered: %s\", name)\n    }\n\n    r.providers[name] = p\n    r.order = append(r.order, name)\n    return nil\n}\n\n// Get retrieves a provider by name\nfunc (r *Registry) Get(name string) (ToolProvider, bool) {\n    r.mu.RLock()\n    defer r.mu.RUnlock()\n    p, ok := r.providers[name]\n    return p, ok\n}\n\n// All returns all registered providers in registration order\nfunc (r *Registry) All() []ToolProvider {\n    r.mu.RLock()\n    defer r.mu.RUnlock()\n\n    result := make([]ToolProvider, 0, len(r.order))\n    for _, name := range r.order {\n        result = append(result, r.providers[name])\n    }\n    return result\n}\n\n// Tools returns MCP tool definitions for all providers\nfunc (r *Registry) Tools() []*mcp.Tool {\n    providers := r.All()\n    tools := make([]*mcp.Tool, 0, len(providers))\n    for _, p := range providers {\n        tools = append(tools, p.Tool())\n    }\n    return tools\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#33-example-provider-internalprovidersearchgo","title":"3.3 Example Provider (<code>internal/provider/search.go</code>)","text":"<pre><code>package provider\n\nimport (\n    \"context\"\n\n    \"github.com/jonwraymond/metatools-mcp/internal/handlers\"\n    \"github.com/modelcontextprotocol/go-sdk/mcp\"\n)\n\n// SearchProvider implements the search_tools tool\ntype SearchProvider struct {\n    handler *handlers.SearchHandler\n}\n\n// NewSearchProvider creates a search_tools provider\nfunc NewSearchProvider(h *handlers.SearchHandler) *SearchProvider {\n    return &amp;SearchProvider{handler: h}\n}\n\nfunc (p *SearchProvider) Name() string { return \"search_tools\" }\n\nfunc (p *SearchProvider) Tool() *mcp.Tool {\n    return &amp;mcp.Tool{\n        Name:        \"search_tools\",\n        Description: \"Search for tools by query string. Returns ranked list of matching tools.\",\n        InputSchema: mcp.ToolInputSchema{\n            Type: \"object\",\n            Properties: map[string]any{\n                \"query\": map[string]any{\n                    \"type\":        \"string\",\n                    \"description\": \"Search query to find relevant tools\",\n                },\n                \"limit\": map[string]any{\n                    \"type\":        \"integer\",\n                    \"description\": \"Maximum number of results (default 10)\",\n                    \"default\":     10,\n                },\n            },\n            Required: []string{\"query\"},\n        },\n    }\n}\n\nfunc (p *SearchProvider) Handle(ctx context.Context, input map[string]any) (*mcp.CallToolResult, error) {\n    query, _ := input[\"query\"].(string)\n    limit := 10\n    if l, ok := input[\"limit\"].(float64); ok {\n        limit = int(l)\n    }\n\n    return p.handler.Handle(ctx, query, limit)\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#34-server-integration","title":"3.4 Server Integration","text":"<pre><code>// internal/server/server.go\n\nfunc New(cfg config.Config, registry *provider.Registry) (*Server, error) {\n    // ... existing validation\n\n    mcpServer := mcp.NewServer(&amp;mcp.Implementation{\n        Name:    implementationName,\n        Version: implementationVersion,\n    }, &amp;mcp.ServerOptions{\n        PageSize: defaultPageSize,\n    })\n\n    srv := &amp;Server{\n        config:   cfg,\n        mcp:      mcpServer,\n        registry: registry,\n    }\n\n    // Register tools from provider registry\n    for _, p := range registry.All() {\n        srv.registerProvider(p)\n    }\n\n    return srv, nil\n}\n\nfunc (s *Server) registerProvider(p provider.ToolProvider) {\n    tool := p.Tool()\n    s.tools = append(s.tools, tool)\n\n    s.mcp.AddTool(tool, func(ctx context.Context, req *mcp.CallToolRequest) (*mcp.CallToolResult, error) {\n        return p.Handle(ctx, req.Params.Arguments)\n    })\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#verification-criteria_2","title":"Verification Criteria","text":"<ul> <li>[ ] All existing tools work via provider registry</li> <li>[ ] Provider registration order matches tool list order</li> <li>[ ] Custom providers can be registered programmatically</li> <li>[ ] Unit tests for registry (&gt;90% coverage)</li> <li>[ ] Benchmark: Registration of 100 providers &lt; 1ms</li> </ul>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#phase-4-backend-registry","title":"Phase 4: Backend Registry","text":"<p>Duration: ~2 weeks Priority: Medium (enables multi-source tool aggregation) Risk: Medium (new subsystem) Depends on: Phase 3</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#objective_3","title":"Objective","text":"<p>Implement a backend registry that aggregates tools from multiple sources (local, MCP servers, HTTP APIs).</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#directory-structure-changes_3","title":"Directory Structure Changes","text":"<pre><code>internal/\n\u251c\u2500\u2500 backend/\n\u2502   \u251c\u2500\u2500 backend.go       # NEW: Backend interface\n\u2502   \u251c\u2500\u2500 registry.go      # NEW: Backend registry\n\u2502   \u251c\u2500\u2500 local.go         # NEW: Local file backend\n\u2502   \u251c\u2500\u2500 mcp.go           # NEW: MCP subprocess backend\n\u2502   \u251c\u2500\u2500 http.go          # NEW: HTTP API backend\n\u2502   \u251c\u2500\u2500 aggregator.go    # NEW: Tool aggregation logic\n\u2502   \u2514\u2500\u2500 errors.go        # NEW: Backend-specific errors\n\u2514\u2500\u2500 ...\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#implementation-tasks_3","title":"Implementation Tasks","text":""},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#41-backend-interface-internalbackendbackendgo","title":"4.1 Backend Interface (<code>internal/backend/backend.go</code>)","text":"<pre><code>package backend\n\nimport (\n    \"context\"\n\n    \"github.com/jonwraymond/toolmodel\"\n)\n\n// Backend defines a source of tools\ntype Backend interface {\n    // Identity\n    Kind() string  // e.g., \"local\", \"mcp\", \"http\"\n    Name() string  // Instance name\n\n    // Lifecycle\n    Start(ctx context.Context) error\n    Stop() error\n\n    // Discovery\n    ListTools(ctx context.Context) ([]toolmodel.Tool, error)\n\n    // Execution\n    Execute(ctx context.Context, tool string, args map[string]any) (any, error)\n}\n\n// Configurable backends support dynamic configuration\ntype Configurable interface {\n    Configure(raw []byte) error\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#42-backend-registry-internalbackendregistrygo","title":"4.2 Backend Registry (<code>internal/backend/registry.go</code>)","text":"<pre><code>package backend\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"sync\"\n)\n\n// Registry manages backend instances\ntype Registry struct {\n    mu       sync.RWMutex\n    backends map[string]Backend\n    order    []string\n}\n\n// NewRegistry creates a backend registry\nfunc NewRegistry() *Registry {\n    return &amp;Registry{\n        backends: make(map[string]Backend),\n        order:    make([]string, 0),\n    }\n}\n\n// Register adds a backend\nfunc (r *Registry) Register(name string, b Backend) error {\n    r.mu.Lock()\n    defer r.mu.Unlock()\n\n    if _, exists := r.backends[name]; exists {\n        return fmt.Errorf(\"backend already registered: %s\", name)\n    }\n\n    r.backends[name] = b\n    r.order = append(r.order, name)\n    return nil\n}\n\n// StartAll starts all registered backends\nfunc (r *Registry) StartAll(ctx context.Context) error {\n    r.mu.RLock()\n    defer r.mu.RUnlock()\n\n    for name, b := range r.backends {\n        if err := b.Start(ctx); err != nil {\n            return fmt.Errorf(\"starting backend %s: %w\", name, err)\n        }\n    }\n    return nil\n}\n\n// StopAll stops all registered backends\nfunc (r *Registry) StopAll() error {\n    r.mu.RLock()\n    defer r.mu.RUnlock()\n\n    var errs []error\n    for name, b := range r.backends {\n        if err := b.Stop(); err != nil {\n            errs = append(errs, fmt.Errorf(\"stopping backend %s: %w\", name, err))\n        }\n    }\n\n    if len(errs) &gt; 0 {\n        return fmt.Errorf(\"errors stopping backends: %v\", errs)\n    }\n    return nil\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#43-mcp-backend-internalbackendmcpgo","title":"4.3 MCP Backend (<code>internal/backend/mcp.go</code>)","text":"<pre><code>package backend\n\nimport (\n    \"context\"\n    \"os/exec\"\n\n    \"github.com/modelcontextprotocol/go-sdk/mcp\"\n)\n\n// MCPBackend connects to an MCP subprocess\ntype MCPBackend struct {\n    name    string\n    command string\n    args    []string\n    env     map[string]string\n\n    cmd    *exec.Cmd\n    client *mcp.Client\n}\n\n// NewMCPBackend creates an MCP subprocess backend\nfunc NewMCPBackend(name, command string, args []string, env map[string]string) *MCPBackend {\n    return &amp;MCPBackend{\n        name:    name,\n        command: command,\n        args:    args,\n        env:     env,\n    }\n}\n\nfunc (b *MCPBackend) Kind() string { return \"mcp\" }\nfunc (b *MCPBackend) Name() string { return b.name }\n\nfunc (b *MCPBackend) Start(ctx context.Context) error {\n    // Start subprocess and establish MCP connection\n    // ... implementation\n}\n\nfunc (b *MCPBackend) ListTools(ctx context.Context) ([]toolmodel.Tool, error) {\n    resp, err := b.client.ListTools(ctx)\n    if err != nil {\n        return nil, err\n    }\n\n    // Convert MCP tools to toolmodel.Tool\n    tools := make([]toolmodel.Tool, 0, len(resp.Tools))\n    for _, t := range resp.Tools {\n        tools = append(tools, convertMCPTool(t, b.name))\n    }\n    return tools, nil\n}\n\nfunc (b *MCPBackend) Execute(ctx context.Context, tool string, args map[string]any) (any, error) {\n    return b.client.CallTool(ctx, tool, args)\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#verification-criteria_3","title":"Verification Criteria","text":"<ul> <li>[ ] Local backend loads tools from file paths</li> <li>[ ] MCP backend spawns subprocess and communicates via stdio</li> <li>[ ] HTTP backend calls remote API endpoints</li> <li>[ ] Tool aggregation merges tools from all backends</li> <li>[ ] Backend failures don't crash the server (graceful degradation)</li> <li>[ ] Integration tests for each backend type</li> <li>[ ] E2E test: GitHub MCP server integration</li> </ul>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#phase-5-middleware-chain","title":"Phase 5: Middleware Chain","text":"<p>Duration: ~2 weeks Priority: Low (nice-to-have for MVP) Risk: Low (additive feature) Depends on: Phase 3</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#objective_4","title":"Objective","text":"<p>Implement a middleware chain for cross-cutting concerns (logging, auth, rate limiting, metrics).</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#directory-structure-changes_4","title":"Directory Structure Changes","text":"<pre><code>internal/\n\u251c\u2500\u2500 middleware/\n\u2502   \u251c\u2500\u2500 middleware.go    # NEW: Middleware interface\n\u2502   \u251c\u2500\u2500 chain.go         # NEW: Middleware chain builder\n\u2502   \u251c\u2500\u2500 registry.go      # NEW: Middleware registry\n\u2502   \u251c\u2500\u2500 logging.go       # NEW: Logging middleware\n\u2502   \u251c\u2500\u2500 auth.go          # NEW: Auth middleware\n\u2502   \u251c\u2500\u2500 ratelimit.go     # NEW: Rate limiting middleware\n\u2502   \u251c\u2500\u2500 metrics.go       # NEW: Metrics middleware\n\u2502   \u251c\u2500\u2500 cache.go         # NEW: Caching middleware\n\u2502   \u2514\u2500\u2500 validation.go    # NEW: Input validation middleware\n\u2514\u2500\u2500 ...\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#implementation-tasks_4","title":"Implementation Tasks","text":""},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#51-middleware-interface-internalmiddlewaremiddlewarego","title":"5.1 Middleware Interface (<code>internal/middleware/middleware.go</code>)","text":"<pre><code>package middleware\n\nimport (\n    \"context\"\n\n    \"github.com/jonwraymond/metatools-mcp/internal/provider\"\n)\n\n// Middleware wraps a ToolProvider with additional behavior\ntype Middleware func(provider.ToolProvider) provider.ToolProvider\n\n// Factory creates a configured middleware instance\ntype Factory func(cfg Config) (Middleware, error)\n\n// Config holds middleware-specific configuration\ntype Config struct {\n    Name    string\n    Enabled bool\n    Raw     map[string]any\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#52-middleware-chain-internalmiddlewarechaingo","title":"5.2 Middleware Chain (<code>internal/middleware/chain.go</code>)","text":"<pre><code>package middleware\n\nimport (\n    \"github.com/jonwraymond/metatools-mcp/internal/provider\"\n)\n\n// Chain applies middleware to providers in order\nfunc Chain(middlewares []Middleware, p provider.ToolProvider) provider.ToolProvider {\n    if len(middlewares) == 0 {\n        return p\n    }\n\n    // Apply in reverse order so first middleware wraps outermost\n    wrapped := p\n    for i := len(middlewares) - 1; i &gt;= 0; i-- {\n        wrapped = middlewares[i](wrapped)\n    }\n    return wrapped\n}\n\n// ApplyToRegistry wraps all providers in a registry with middleware\nfunc ApplyToRegistry(registry *provider.Registry, middlewares []Middleware) {\n    for _, p := range registry.All() {\n        wrapped := Chain(middlewares, p)\n        // Replace in registry\n        // ...\n    }\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#53-logging-middleware-internalmiddlewarelogginggo","title":"5.3 Logging Middleware (<code>internal/middleware/logging.go</code>)","text":"<pre><code>package middleware\n\nimport (\n    \"context\"\n    \"log/slog\"\n    \"time\"\n\n    \"github.com/jonwraymond/metatools-mcp/internal/provider\"\n    \"github.com/modelcontextprotocol/go-sdk/mcp\"\n)\n\ntype loggingMiddleware struct {\n    next   provider.ToolProvider\n    logger *slog.Logger\n    level  slog.Level\n}\n\n// NewLoggingMiddleware creates a logging middleware\nfunc NewLoggingMiddleware(logger *slog.Logger, level slog.Level) Middleware {\n    return func(next provider.ToolProvider) provider.ToolProvider {\n        return &amp;loggingMiddleware{\n            next:   next,\n            logger: logger,\n            level:  level,\n        }\n    }\n}\n\nfunc (m *loggingMiddleware) Name() string        { return m.next.Name() }\nfunc (m *loggingMiddleware) Tool() *mcp.Tool     { return m.next.Tool() }\n\nfunc (m *loggingMiddleware) Handle(ctx context.Context, input map[string]any) (*mcp.CallToolResult, error) {\n    start := time.Now()\n\n    m.logger.Log(ctx, m.level, \"tool call started\",\n        \"tool\", m.next.Name(),\n        \"input\", input,\n    )\n\n    result, err := m.next.Handle(ctx, input)\n\n    m.logger.Log(ctx, m.level, \"tool call completed\",\n        \"tool\", m.next.Name(),\n        \"duration\", time.Since(start),\n        \"error\", err,\n    )\n\n    return result, err\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#verification-criteria_4","title":"Verification Criteria","text":"<ul> <li>[ ] Logging middleware logs all tool calls</li> <li>[ ] Auth middleware validates tokens when configured</li> <li>[ ] Rate limiting middleware enforces limits</li> <li>[ ] Metrics middleware exposes Prometheus metrics</li> <li>[ ] Middleware chain order matches config order</li> <li>[ ] Unit tests for each middleware type</li> <li>[ ] Integration test: Full middleware chain</li> </ul>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#summary-implementation-priority-matrix","title":"Summary: Implementation Priority Matrix","text":"Phase Priority Risk Duration MVP? Phase 1: CLI + Config Critical Low 2 weeks \u2713 Phase 2: Transport High Medium 2 weeks \u2713 Phase 3: Tool Provider Registry High Medium 1 week \u2713 Phase 4: Backend Registry Medium Medium 2 weeks Phase 5: Middleware Chain Low Low 2 weeks <p>MVP Timeline: ~5 weeks (Phases 1-3) Full Implementation: ~9 weeks (All phases)</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#appendix-architectural-decisions","title":"Appendix: Architectural Decisions","text":""},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#decision-1-koanf-over-viper","title":"Decision 1: Koanf over Viper","text":"<p>Decision: Use Koanf for configuration loading instead of Viper.</p> <p>Rationale: - Lighter dependency footprint - Modular provider architecture - Cleaner API for layered configuration - Better suited for our use case</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#decision-2-interface-based-transports-over-mcp-sdk-extension","title":"Decision 2: Interface-based Transports over MCP SDK Extension","text":"<p>Decision: Define our own Transport interface that wraps MCP SDK transports.</p> <p>Rationale: - Decouples from MCP SDK implementation details - Enables custom transports (Unix socket, gRPC) - Allows consistent lifecycle management - Facilitates testing with mock transports</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#decision-3-provider-pattern-over-direct-handler-registration","title":"Decision 3: Provider Pattern over Direct Handler Registration","text":"<p>Decision: Use ToolProvider interface instead of direct MCP tool registration.</p> <p>Rationale: - Enables middleware wrapping - Supports dynamic registration - Cleaner separation of concerns - Facilitates testing</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#decision-4-decorator-pattern-for-middleware","title":"Decision 4: Decorator Pattern for Middleware","text":"<p>Decision: Use decorator pattern (wrapping) for middleware chain.</p> <p>Rationale: - Matches go-chi's proven approach - Simple mental model - Easy to compose and test - Preserves ToolProvider interface</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/implementation-phases/#changelog","title":"Changelog","text":"Date Change 2026-01-27 Initial draft with 5 phases"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/","title":"Pluggable Architecture Proposal","text":"<p>Status: Draft Date: 2026-01-27 Author: Jon Raymond</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#executive-summary","title":"Executive Summary","text":"<p>This proposal outlines a pluggable, modular architecture for metatools-mcp that enables: - Multiple transport protocols (stdio, HTTP/SSE, WebSocket) - Plug-and-play tool providers - Configurable search strategies - Extensible backend registries - Cross-cutting middleware</p> <p>The design leverages Go's interface-based composition, build-tag gating, and configuration-driven initialization to create a flexible framework while maintaining the clean, canonical core.</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Motivation</li> <li>Current Architecture Analysis</li> <li>Proposed Architecture</li> <li>Extension Points</li> <li>Transport Layer</li> <li>Search Strategy</li> <li>Tool Provider Registry</li> <li>Backend Registry</li> <li>Middleware Chain</li> <li>Multi-Backend Architecture</li> <li>Configuration Design</li> <li>Implementation Approach</li> <li>End-to-End Examples</li> <li>Enterprise AI Assistant</li> <li>Local Development Setup</li> <li>Multi-LLM Tool Router</li> <li>Microservices Tool Mesh</li> <li>Request Flow Diagram</li> <li>Comparative Analysis</li> <li>References</li> <li>Architecture Validation</li> <li>Implementation Phases</li> </ol>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#motivation","title":"Motivation","text":""},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#goals","title":"Goals","text":"<ol> <li>Multi-transport support - Run as stdio MCP server (current) or HTTP/SSE server (high availability)</li> <li>Plug-and-play extensibility - Add new tools, backends, and search strategies without modifying core</li> <li>Configuration-driven - YAML/JSON config files with environment variable overrides</li> <li>Framework potential - Enable metatools-mcp as a reusable framework for building MCP servers</li> </ol>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#non-goals","title":"Non-Goals","text":"<ul> <li>Runtime plugin loading (Go's plugin package has platform limitations)</li> <li>Breaking changes to existing tool* library interfaces</li> <li>Over-engineering for hypothetical future requirements</li> </ul>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#current-architecture-analysis","title":"Current Architecture Analysis","text":""},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#strengths-85-pluggable","title":"Strengths (85% Pluggable)","text":"<p>The existing architecture demonstrates excellent patterns:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      MCP Server (SDK)                           \u2502\n\u2502           metatools-mcp/internal/server/server.go               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Adapter Layer                                 \u2502\n\u2502  - IndexAdapter (toolindex \u2192 handlers.Index)                    \u2502\n\u2502  - DocsAdapter (tooldocs \u2192 handlers.Store)                      \u2502\n\u2502  - RunnerAdapter (toolrun \u2192 handlers.Runner)                    \u2502\n\u2502  - ExecutorAdapter (toolcode \u2192 handlers.Executor)               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   Handlers Layer                                 \u2502\n\u2502  - SearchHandler, DescribeHandler, RunHandler, ChainHandler    \u2502\n\u2502  - CodeHandler (optional), ExamplesHandler, NamespacesHandler  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              Core Tool Libraries                                 \u2502\n\u2502  toolindex, tooldocs, toolrun, toolcode, toolruntime, toolsearch\u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>What works well: - Clean interface contracts (<code>handlers/interfaces.go</code>) - Adapter pattern prevents library leakage - Build-tag gating for optional features (<code>toolsearch</code>, <code>toolruntime</code>) - Configuration-driven bootstrap (<code>internal/config/env.go</code>) - Stateless handlers with dependency injection</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#gap-monolithic-tool-registration","title":"Gap: Monolithic Tool Registration","text":"<p>The primary gap is in <code>server.registerTools()</code> (~200 lines):</p> <pre><code>// Current: Hard-coded tool list\nfunc (s *Server) registerTools() {\n    s.addTool(\"search_tools\", ...)    // inline schema\n    s.addTool(\"describe_tool\", ...)   // inline schema\n    s.addTool(\"run_tool\", ...)        // inline schema\n    // ... 7 tools total\n}\n</code></pre> <p>This requires code changes to add new tools.</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#proposed-architecture","title":"Proposed Architecture","text":""},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#five-layer-design","title":"Five-Layer Design","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    METATOOLS-MCP FRAMEWORK                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                   \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502                 TRANSPORT LAYER                              \u2502 \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u2502 \u2502\n\u2502  \u2502  \u2502  stdio  \u2502  \u2502  SSE    \u2502  \u2502  HTTP   \u2502  \u2502  gRPC   \u2502        \u2502 \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518        \u2502 \u2502\n\u2502  \u2502       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2502 \u2502\n\u2502  \u2502                        \u2193                                     \u2502 \u2502\n\u2502  \u2502               transport.Transport interface                  \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                             \u2193                                    \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502                  MIDDLEWARE CHAIN                            \u2502 \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u2502 \u2502\n\u2502  \u2502  \u2502 Logging  \u2502\u2192\u2502  Auth    \u2502\u2192\u2502  Rate    \u2502\u2192\u2502  Cache   \u2502       \u2502 \u2502\n\u2502  \u2502  \u2502          \u2502 \u2502          \u2502 \u2502  Limit   \u2502 \u2502          \u2502       \u2502 \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                             \u2193                                    \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502               TOOL PROVIDER REGISTRY                         \u2502 \u2502\n\u2502  \u2502                                                               \u2502 \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u2502 \u2502\n\u2502  \u2502  \u2502 search_tools \u2502 \u2502 describe_    \u2502 \u2502 run_tool     \u2502         \u2502 \u2502\n\u2502  \u2502  \u2502              \u2502 \u2502 tool         \u2502 \u2502              \u2502         \u2502 \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502 \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u2502 \u2502\n\u2502  \u2502  \u2502 run_chain    \u2502 \u2502 execute_code \u2502 \u2502 [custom...]  \u2502         \u2502 \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                             \u2193                                    \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502              CORE SERVICES (Tool Libraries)                  \u2502 \u2502\n\u2502  \u2502                                                               \u2502 \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                     \u2502 \u2502\n\u2502  \u2502  \u2502   toolindex    \u2502  \u2502   tooldocs     \u2502                     \u2502 \u2502\n\u2502  \u2502  \u2502  (Registry)    \u2502  \u2502  (Disclosure)  \u2502                     \u2502 \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                     \u2502 \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                     \u2502 \u2502\n\u2502  \u2502  \u2502   toolrun      \u2502  \u2502   toolcode     \u2502                     \u2502 \u2502\n\u2502  \u2502  \u2502  (Execution)   \u2502  \u2502 (Orchestration)\u2502                     \u2502 \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                     \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                             \u2193                                    \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502               BACKEND REGISTRY                               \u2502 \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u2502 \u2502\n\u2502  \u2502  \u2502  local  \u2502  \u2502 openai  \u2502  \u2502  azure  \u2502  \u2502  mcp    \u2502        \u2502 \u2502\n\u2502  \u2502  \u2502handlers \u2502  \u2502   api   \u2502  \u2502   api   \u2502  \u2502 servers \u2502        \u2502 \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#core-interfaces","title":"Core Interfaces","text":"<pre><code>// Transport abstraction (enables stdio/SSE/HTTP)\ntype Transport interface {\n    Serve(ctx context.Context, handler RequestHandler) error\n}\n\n// Tool provider (enables plug-and-play tools)\ntype ToolProvider interface {\n    Name() string\n    Tool() *mcp.Tool\n    Handle(ctx context.Context, input []byte) (any, error)\n}\n\n// Middleware (enables cross-cutting concerns)\ntype Middleware func(ToolProvider) ToolProvider\n\n// Backend registry (enables tool sources)\ntype BackendRegistry interface {\n    Register(kind string, backend Backend)\n    Get(kind string) (Backend, bool)\n    List() []string\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#extension-points","title":"Extension Points","text":""},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#1-transport-layer","title":"1. Transport Layer","text":"<p>The transport layer abstracts how MCP clients connect to the server. This enables the same tool logic to be exposed via multiple protocols.</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#architecture-overview","title":"Architecture Overview","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         TRANSPORT LAYER                                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                               \u2502\n\u2502                              MCP CLIENTS                                      \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u2502\n\u2502   \u2502   Claude    \u2502  \u2502   Cursor    \u2502  \u2502  Web App    \u2502  \u2502   Custom    \u2502        \u2502\n\u2502   \u2502   Desktop   \u2502  \u2502    IDE      \u2502  \u2502  Frontend   \u2502  \u2502   Client    \u2502        \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2502\n\u2502          \u2502                \u2502                \u2502                \u2502                \u2502\n\u2502          \u2502 stdio          \u2502 stdio          \u2502 HTTP/SSE       \u2502 gRPC          \u2502\n\u2502          \u2502                \u2502                \u2502                \u2502                \u2502\n\u2502          \u25bc                \u25bc                \u25bc                \u25bc                \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                     TRANSPORT REGISTRY                               \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u2502   \u2502\n\u2502   \u2502   \u2502   STDIO   \u2502  \u2502    SSE    \u2502  \u2502   HTTP    \u2502  \u2502   gRPC    \u2502        \u2502   \u2502\n\u2502   \u2502   \u2502 Transport \u2502  \u2502 Transport \u2502  \u2502 Transport \u2502  \u2502 Transport \u2502        \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518        \u2502   \u2502\n\u2502   \u2502         \u2502              \u2502              \u2502              \u2502               \u2502   \u2502\n\u2502   \u2502         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518               \u2502   \u2502\n\u2502   \u2502                              \u2502                                        \u2502   \u2502\n\u2502   \u2502                              \u25bc                                        \u2502   \u2502\n\u2502   \u2502                    transport.Transport                                \u2502   \u2502\n\u2502   \u2502                       interface                                       \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                   \u2502                                          \u2502\n\u2502                                   \u25bc                                          \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    MCP REQUEST HANDLER                               \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   Unified handler processes all requests regardless of transport    \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#the-transport-interface","title":"The Transport Interface","text":"<pre><code>// Transport defines how MCP clients connect to the server\ntype Transport interface {\n    // Name returns the transport identifier (e.g., \"stdio\", \"sse\")\n    Name() string\n\n    // Serve starts the transport and blocks until ctx is cancelled\n    Serve(ctx context.Context, handler RequestHandler) error\n\n    // Close gracefully shuts down the transport\n    Close() error\n\n    // Info returns runtime information about the transport\n    Info() TransportInfo\n}\n\n// RequestHandler processes incoming MCP requests\ntype RequestHandler interface {\n    HandleRequest(ctx context.Context, req *mcp.Request) (*mcp.Response, error)\n}\n\n// TransportInfo provides runtime details\ntype TransportInfo struct {\n    Name      string            // Transport name\n    Listening bool              // Is it accepting connections?\n    Address   string            // Listening address (for network transports)\n    Metadata  map[string]string // Additional info\n}\n\n// TransportFactory creates configured transport instances\ntype TransportFactory func(cfg TransportConfig) (Transport, error)\n\n// TransportRegistry manages available transports\ntype TransportRegistry struct {\n    transports map[string]TransportFactory\n}\n\nfunc (r *TransportRegistry) Register(name string, factory TransportFactory) {\n    r.transports[name] = factory\n}\n\nfunc (r *TransportRegistry) Create(cfg TransportConfig) (Transport, error) {\n    factory, ok := r.transports[cfg.Type]\n    if !ok {\n        return nil, fmt.Errorf(\"unknown transport: %s\", cfg.Type)\n    }\n    return factory(cfg)\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#transport-types","title":"Transport Types","text":""},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#1-stdio-transport-current-default","title":"1. Stdio Transport (Current Default)","text":"<p>For MCP clients that spawn the server as a subprocess.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                          STDIO TRANSPORT                                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                               \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510               \u2502\n\u2502   \u2502      MCP Client       \u2502         \u2502    metatools-mcp      \u2502               \u2502\n\u2502   \u2502   (Claude, Cursor)    \u2502         \u2502       server          \u2502               \u2502\n\u2502   \u2502                       \u2502         \u2502                       \u2502               \u2502\n\u2502   \u2502   Spawns process \u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6\u2502   Started as child    \u2502               \u2502\n\u2502   \u2502                       \u2502         \u2502                       \u2502               \u2502\n\u2502   \u2502   stdin  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6\u2502   Reads JSON-RPC      \u2502               \u2502\n\u2502   \u2502                       \u2502         \u2502                       \u2502               \u2502\n\u2502   \u2502   stdout \u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502   Writes JSON-RPC     \u2502               \u2502\n\u2502   \u2502                       \u2502         \u2502                       \u2502               \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518               \u2502\n\u2502                                                                               \u2502\n\u2502   Characteristics:                                                           \u2502\n\u2502   - Single client per process                                               \u2502\n\u2502   - Process lifecycle tied to client                                        \u2502\n\u2502   - No network configuration needed                                         \u2502\n\u2502   - Ideal for desktop MCP clients                                           \u2502\n\u2502                                                                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Implementation:                                                             \u2502\n\u2502                                                                               \u2502\n\u2502  type StdioTransport struct {                                               \u2502\n\u2502      reader  io.Reader  // os.Stdin                                         \u2502\n\u2502      writer  io.Writer  // os.Stdout                                        \u2502\n\u2502      decoder *json.Decoder                                                  \u2502\n\u2502      encoder *json.Encoder                                                  \u2502\n\u2502  }                                                                           \u2502\n\u2502                                                                               \u2502\n\u2502  func (t *StdioTransport) Serve(ctx context.Context, h RequestHandler)      \u2502\n\u2502      error {                                                                \u2502\n\u2502      for {                                                                  \u2502\n\u2502          select {                                                           \u2502\n\u2502          case &lt;-ctx.Done():                                                 \u2502\n\u2502              return ctx.Err()                                               \u2502\n\u2502          default:                                                           \u2502\n\u2502              var req mcp.Request                                            \u2502\n\u2502              if err := t.decoder.Decode(&amp;req); err != nil {                 \u2502\n\u2502                  return err                                                 \u2502\n\u2502              }                                                              \u2502\n\u2502              resp, err := h.HandleRequest(ctx, &amp;req)                        \u2502\n\u2502              if err := t.encoder.Encode(resp); err != nil {                 \u2502\n\u2502                  return err                                                 \u2502\n\u2502              }                                                              \u2502\n\u2502          }                                                                  \u2502\n\u2502      }                                                                      \u2502\n\u2502  }                                                                           \u2502\n\u2502                                                                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Config:                                                                     \u2502\n\u2502    transport:                                                               \u2502\n\u2502      type: stdio                                                            \u2502\n\u2502      # No additional config needed                                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#2-sse-transport-server-sent-events","title":"2. SSE Transport (Server-Sent Events)","text":"<p>For web-based MCP clients using the Streamable HTTP protocol.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                           SSE TRANSPORT                                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                               \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510               \u2502\n\u2502   \u2502     Web Browser       \u2502         \u2502    metatools-mcp      \u2502               \u2502\n\u2502   \u2502    or HTTP Client     \u2502         \u2502       server          \u2502               \u2502\n\u2502   \u2502                       \u2502         \u2502                       \u2502               \u2502\n\u2502   \u2502   POST /mcp \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6\u2502   Handle request      \u2502               \u2502\n\u2502   \u2502   (JSON-RPC request)  \u2502         \u2502                       \u2502               \u2502\n\u2502   \u2502                       \u2502         \u2502                       \u2502               \u2502\n\u2502   \u2502   SSE stream \u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502   Stream response     \u2502               \u2502\n\u2502   \u2502   (chunked events)    \u2502         \u2502   via SSE             \u2502               \u2502\n\u2502   \u2502                       \u2502         \u2502                       \u2502               \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518               \u2502\n\u2502                                                                               \u2502\n\u2502   HTTP Endpoints:                                                            \u2502\n\u2502   - POST /mcp           \u2192 Submit MCP request, receive SSE stream            \u2502\n\u2502   - GET  /mcp/sse       \u2192 Establish SSE connection for server push          \u2502\n\u2502   - GET  /health        \u2192 Health check endpoint                              \u2502\n\u2502   - GET  /ready         \u2192 Readiness probe                                   \u2502\n\u2502                                                                               \u2502\n\u2502   Characteristics:                                                           \u2502\n\u2502   - Multiple concurrent clients                                             \u2502\n\u2502   - Stateless (each request independent)                                    \u2502\n\u2502   - Web-friendly (works through firewalls/proxies)                          \u2502\n\u2502   - Supports streaming responses                                            \u2502\n\u2502   - Can be load balanced                                                    \u2502\n\u2502                                                                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Request/Response Flow:                                                      \u2502\n\u2502                                                                               \u2502\n\u2502  Client                              Server                                  \u2502\n\u2502    \u2502                                   \u2502                                     \u2502\n\u2502    \u2502  POST /mcp                        \u2502                                     \u2502\n\u2502    \u2502  Content-Type: application/json   \u2502                                     \u2502\n\u2502    \u2502  Accept: text/event-stream        \u2502                                     \u2502\n\u2502    \u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6   \u2502                                     \u2502\n\u2502    \u2502                                   \u2502                                     \u2502\n\u2502    \u2502  HTTP/1.1 200 OK                  \u2502                                     \u2502\n\u2502    \u2502  Content-Type: text/event-stream  \u2502                                     \u2502\n\u2502    \u2502  \u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500   \u2502                                     \u2502\n\u2502    \u2502                                   \u2502                                     \u2502\n\u2502    \u2502  event: message                   \u2502                                     \u2502\n\u2502    \u2502  data: {\"jsonrpc\":\"2.0\",...}      \u2502                                     \u2502\n\u2502    \u2502  \u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500   \u2502                                     \u2502\n\u2502    \u2502                                   \u2502                                     \u2502\n\u2502    \u2502  event: message                   \u2502                                     \u2502\n\u2502    \u2502  data: {\"jsonrpc\":\"2.0\",...}      \u2502  (streaming)                       \u2502\n\u2502    \u2502  \u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500   \u2502                                     \u2502\n\u2502    \u2502                                   \u2502                                     \u2502\n\u2502    \u2502  event: done                      \u2502                                     \u2502\n\u2502    \u2502  data: {}                         \u2502                                     \u2502\n\u2502    \u2502  \u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500   \u2502                                     \u2502\n\u2502    \u2502                                   \u2502                                     \u2502\n\u2502                                                                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Config:                                                                     \u2502\n\u2502    transport:                                                               \u2502\n\u2502      type: sse                                                              \u2502\n\u2502      http:                                                                  \u2502\n\u2502        host: \"0.0.0.0\"                                                     \u2502\n\u2502        port: 8080                                                          \u2502\n\u2502        base_path: /mcp                                                     \u2502\n\u2502        cors:                                                               \u2502\n\u2502          enabled: true                                                     \u2502\n\u2502          origins: [\"https://app.example.com\"]                             \u2502\n\u2502        tls:                                                                \u2502\n\u2502          enabled: true                                                     \u2502\n\u2502          cert: /etc/ssl/cert.pem                                          \u2502\n\u2502          key: /etc/ssl/key.pem                                            \u2502\n\u2502        timeouts:                                                           \u2502\n\u2502          read: 30s                                                         \u2502\n\u2502          write: 60s                                                        \u2502\n\u2502          idle: 120s                                                        \u2502\n\u2502        keepalive: 30s                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#3-http-transport-rest-style","title":"3. HTTP Transport (REST-style)","text":"<p>For simple request/response without streaming.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                          HTTP TRANSPORT                                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                               \u2502\n\u2502   Endpoints:                                                                 \u2502\n\u2502                                                                               \u2502\n\u2502   POST /mcp/tools/list                                                       \u2502\n\u2502   \u251c\u2500 Request:  {}                                                            \u2502\n\u2502   \u2514\u2500 Response: { \"tools\": [...] }                                           \u2502\n\u2502                                                                               \u2502\n\u2502   POST /mcp/tools/call                                                       \u2502\n\u2502   \u251c\u2500 Request:  { \"name\": \"search_tools\", \"arguments\": {...} }               \u2502\n\u2502   \u2514\u2500 Response: { \"content\": [...] }                                         \u2502\n\u2502                                                                               \u2502\n\u2502   GET /mcp/tools/:name                                                       \u2502\n\u2502   \u2514\u2500 Response: { \"name\": \"...\", \"description\": \"...\", \"inputSchema\": {...}} \u2502\n\u2502                                                                               \u2502\n\u2502   Characteristics:                                                           \u2502\n\u2502   - Simple request/response                                                  \u2502\n\u2502   - No streaming support                                                    \u2502\n\u2502   - Easy to debug with curl                                                 \u2502\n\u2502   - Good for simple integrations                                            \u2502\n\u2502                                                                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Config:                                                                     \u2502\n\u2502    transport:                                                               \u2502\n\u2502      type: http                                                             \u2502\n\u2502      http:                                                                  \u2502\n\u2502        host: \"0.0.0.0\"                                                     \u2502\n\u2502        port: 8080                                                          \u2502\n\u2502        base_path: /mcp                                                     \u2502\n\u2502        # Same TLS/timeout options as SSE                                   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#4-websocket-transport","title":"4. WebSocket Transport","text":"<p>For bidirectional real-time communication.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        WEBSOCKET TRANSPORT                                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                               \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510               \u2502\n\u2502   \u2502       Client          \u2502         \u2502    metatools-mcp      \u2502               \u2502\n\u2502   \u2502                       \u2502         \u2502       server          \u2502               \u2502\n\u2502   \u2502                       \u2502         \u2502                       \u2502               \u2502\n\u2502   \u2502   WS Connect \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6\u2502   Accept connection   \u2502               \u2502\n\u2502   \u2502   ws://host/mcp/ws    \u2502         \u2502                       \u2502               \u2502\n\u2502   \u2502                       \u2502         \u2502                       \u2502               \u2502\n\u2502   \u2502   \u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6   \u2502               \u2502\n\u2502   \u2502      Bidirectional    \u2502         \u2502   Full duplex         \u2502               \u2502\n\u2502   \u2502      JSON-RPC         \u2502         \u2502   messaging           \u2502               \u2502\n\u2502   \u2502                       \u2502         \u2502                       \u2502               \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518               \u2502\n\u2502                                                                               \u2502\n\u2502   Characteristics:                                                           \u2502\n\u2502   - Full duplex communication                                               \u2502\n\u2502   - Server can push notifications                                           \u2502\n\u2502   - Lower latency than HTTP                                                 \u2502\n\u2502   - Persistent connection                                                   \u2502\n\u2502   - Good for real-time applications                                         \u2502\n\u2502                                                                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Config:                                                                     \u2502\n\u2502    transport:                                                               \u2502\n\u2502      type: websocket                                                        \u2502\n\u2502      websocket:                                                             \u2502\n\u2502        host: \"0.0.0.0\"                                                     \u2502\n\u2502        port: 8080                                                          \u2502\n\u2502        path: /mcp/ws                                                       \u2502\n\u2502        ping_interval: 30s                                                  \u2502\n\u2502        pong_timeout: 10s                                                   \u2502\n\u2502        max_message_size: 1MB                                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#5-grpc-transport","title":"5. gRPC Transport","text":"<p>For high-performance, strongly-typed RPC.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                          gRPC TRANSPORT                                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                               \u2502\n\u2502   Protocol Buffer Definition:                                                \u2502\n\u2502                                                                               \u2502\n\u2502   service MCPService {                                                       \u2502\n\u2502     rpc ListTools(ListToolsRequest) returns (ListToolsResponse);            \u2502\n\u2502     rpc CallTool(CallToolRequest) returns (CallToolResponse);               \u2502\n\u2502     rpc CallToolStream(CallToolRequest) returns (stream ToolEvent);         \u2502\n\u2502   }                                                                          \u2502\n\u2502                                                                               \u2502\n\u2502   Characteristics:                                                           \u2502\n\u2502   - High performance (binary protocol)                                       \u2502\n\u2502   - Strong typing via protobuf                                              \u2502\n\u2502   - Bidirectional streaming                                                 \u2502\n\u2502   - Built-in load balancing                                                 \u2502\n\u2502   - Good for service-to-service communication                               \u2502\n\u2502                                                                               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Config:                                                                     \u2502\n\u2502    transport:                                                               \u2502\n\u2502      type: grpc                                                             \u2502\n\u2502      grpc:                                                                  \u2502\n\u2502        host: \"0.0.0.0\"                                                     \u2502\n\u2502        port: 9090                                                          \u2502\n\u2502        tls:                                                                \u2502\n\u2502          enabled: true                                                     \u2502\n\u2502          cert: /etc/ssl/cert.pem                                          \u2502\n\u2502          key: /etc/ssl/key.pem                                            \u2502\n\u2502          client_ca: /etc/ssl/ca.pem  # For mTLS                           \u2502\n\u2502        reflection: true  # Enable gRPC reflection                          \u2502\n\u2502        max_recv_msg_size: 4MB                                              \u2502\n\u2502        max_send_msg_size: 4MB                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#multi-transport-support","title":"Multi-Transport Support","text":"<p>Run multiple transports simultaneously:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      MULTI-TRANSPORT ARCHITECTURE                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                               \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    METATOOLS-MCP SERVER                              \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                   \u2502   \u2502\n\u2502   \u2502   \u2502   STDIO     \u2502 \u2502    SSE      \u2502 \u2502    gRPC     \u2502                   \u2502   \u2502\n\u2502   \u2502   \u2502  Transport  \u2502 \u2502  Transport  \u2502 \u2502  Transport  \u2502                   \u2502   \u2502\n\u2502   \u2502   \u2502             \u2502 \u2502  :8080      \u2502 \u2502  :9090      \u2502                   \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518                   \u2502   \u2502\n\u2502   \u2502          \u2502               \u2502               \u2502                           \u2502   \u2502\n\u2502   \u2502          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                           \u2502   \u2502\n\u2502   \u2502                          \u2502                                            \u2502   \u2502\n\u2502   \u2502                          \u25bc                                            \u2502   \u2502\n\u2502   \u2502          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                           \u2502   \u2502\n\u2502   \u2502          \u2502     SHARED REQUEST HANDLER    \u2502                           \u2502   \u2502\n\u2502   \u2502          \u2502                               \u2502                           \u2502   \u2502\n\u2502   \u2502          \u2502   All transports share the    \u2502                           \u2502   \u2502\n\u2502   \u2502          \u2502   same middleware, tools,     \u2502                           \u2502   \u2502\n\u2502   \u2502          \u2502   and backend registries      \u2502                           \u2502   \u2502\n\u2502   \u2502          \u2502                               \u2502                           \u2502   \u2502\n\u2502   \u2502          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                           \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                               \u2502\n\u2502   Config:                                                                    \u2502\n\u2502     transports:                                                             \u2502\n\u2502       - type: stdio                                                         \u2502\n\u2502         enabled: true                                                       \u2502\n\u2502                                                                               \u2502\n\u2502       - type: sse                                                           \u2502\n\u2502         enabled: true                                                       \u2502\n\u2502         http:                                                               \u2502\n\u2502           port: 8080                                                        \u2502\n\u2502                                                                               \u2502\n\u2502       - type: grpc                                                          \u2502\n\u2502         enabled: true                                                       \u2502\n\u2502         grpc:                                                               \u2502\n\u2502           port: 9090                                                        \u2502\n\u2502                                                                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#implementing-custom-transports","title":"Implementing Custom Transports","text":"<pre><code>// Example: Unix socket transport for local high-performance IPC\ntype UnixSocketTransport struct {\n    path     string\n    listener net.Listener\n    handler  RequestHandler\n}\n\nfunc NewUnixSocketTransport(cfg TransportConfig) (Transport, error) {\n    return &amp;UnixSocketTransport{\n        path: cfg.UnixSocket.Path,\n    }, nil\n}\n\nfunc (t *UnixSocketTransport) Name() string {\n    return \"unix\"\n}\n\nfunc (t *UnixSocketTransport) Serve(ctx context.Context, h RequestHandler) error {\n    t.handler = h\n\n    var err error\n    t.listener, err = net.Listen(\"unix\", t.path)\n    if err != nil {\n        return err\n    }\n\n    go func() {\n        &lt;-ctx.Done()\n        t.listener.Close()\n    }()\n\n    for {\n        conn, err := t.listener.Accept()\n        if err != nil {\n            if ctx.Err() != nil {\n                return nil // Graceful shutdown\n            }\n            return err\n        }\n        go t.handleConnection(ctx, conn)\n    }\n}\n\nfunc (t *UnixSocketTransport) handleConnection(ctx context.Context, conn net.Conn) {\n    defer conn.Close()\n    decoder := json.NewDecoder(conn)\n    encoder := json.NewEncoder(conn)\n\n    for {\n        var req mcp.Request\n        if err := decoder.Decode(&amp;req); err != nil {\n            return\n        }\n        resp, _ := t.handler.HandleRequest(ctx, &amp;req)\n        if err := encoder.Encode(resp); err != nil {\n            return\n        }\n    }\n}\n\nfunc (t *UnixSocketTransport) Close() error {\n    if t.listener != nil {\n        return t.listener.Close()\n    }\n    return nil\n}\n\nfunc (t *UnixSocketTransport) Info() TransportInfo {\n    return TransportInfo{\n        Name:      \"unix\",\n        Listening: t.listener != nil,\n        Address:   t.path,\n    }\n}\n\n// Register the custom transport\nfunc init() {\n    transport.Register(\"unix\", NewUnixSocketTransport)\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#high-availability-configuration","title":"High Availability Configuration","text":"<p>For production deployments with HTTP/SSE transport:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    HIGH AVAILABILITY DEPLOYMENT                              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                               \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                       LOAD BALANCER                                  \u2502   \u2502\n\u2502   \u2502                    (nginx, HAProxy, ALB)                             \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   - TLS termination                                                  \u2502   \u2502\n\u2502   \u2502   - Health checks                                                    \u2502   \u2502\n\u2502   \u2502   - Round-robin / least-connections                                 \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                    \u2502                \u2502                \u2502                       \u2502\n\u2502                    \u25bc                \u25bc                \u25bc                       \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502\n\u2502   \u2502   metatools-mcp    \u2502 \u2502   metatools-mcp    \u2502 \u2502   metatools-mcp    \u2502     \u2502\n\u2502   \u2502    instance 1      \u2502 \u2502    instance 2      \u2502 \u2502    instance 3      \u2502     \u2502\n\u2502   \u2502                    \u2502 \u2502                    \u2502 \u2502                    \u2502     \u2502\n\u2502   \u2502  SSE :8080         \u2502 \u2502  SSE :8080         \u2502 \u2502  SSE :8080         \u2502     \u2502\n\u2502   \u2502  gRPC :9090        \u2502 \u2502  gRPC :9090        \u2502 \u2502  gRPC :9090        \u2502     \u2502\n\u2502   \u2502                    \u2502 \u2502                    \u2502 \u2502                    \u2502     \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502\n\u2502             \u2502                      \u2502                      \u2502                 \u2502\n\u2502             \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                 \u2502\n\u2502                                    \u2502                                         \u2502\n\u2502                                    \u25bc                                         \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                      SHARED STATE (Optional)                         \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   - Redis for rate limiting                                          \u2502   \u2502\n\u2502   \u2502   - Redis for caching                                                \u2502   \u2502\n\u2502   \u2502   - Shared tool registry (if dynamic)                               \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <pre><code># Kubernetes-ready configuration\ntransport:\n  type: sse\n  http:\n    host: \"0.0.0.0\"\n    port: 8080\n\n    # Health endpoints for k8s probes\n    health:\n      enabled: true\n      liveness_path: /healthz\n      readiness_path: /ready\n\n    # Graceful shutdown\n    shutdown:\n      timeout: 30s\n      drain_connections: true\n\n    # TLS (or terminate at ingress)\n    tls:\n      enabled: false  # Terminated at ingress\n\nmiddleware:\n  rate_limit:\n    enabled: true\n    storage: redis\n    redis:\n      address: redis:6379\n\n  cache:\n    enabled: true\n    backend: redis\n    redis:\n      address: redis:6379\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#cli-integration","title":"CLI Integration","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                          CLI SUBCOMMANDS                                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                               \u2502\n\u2502  metatools stdio                                                             \u2502\n\u2502  \u2514\u2500 Run as stdio server (default, for MCP clients)                          \u2502\n\u2502                                                                               \u2502\n\u2502  metatools serve                                                             \u2502\n\u2502  \u2514\u2500 Run as HTTP/SSE server                                                  \u2502\n\u2502  \u2514\u2500 Options:                                                                \u2502\n\u2502       --port 8080          HTTP port                                        \u2502\n\u2502       --grpc-port 9090     gRPC port (optional)                            \u2502\n\u2502       --tls                Enable TLS                                       \u2502\n\u2502       --cert FILE          TLS certificate                                  \u2502\n\u2502       --key FILE           TLS key                                          \u2502\n\u2502                                                                               \u2502\n\u2502  metatools serve --multi                                                     \u2502\n\u2502  \u2514\u2500 Run all enabled transports from config                                  \u2502\n\u2502                                                                               \u2502\n\u2502  metatools version                                                           \u2502\n\u2502  \u2514\u2500 Print version and exit                                                  \u2502\n\u2502                                                                               \u2502\n\u2502  metatools validate                                                          \u2502\n\u2502  \u2514\u2500 Validate configuration file                                             \u2502\n\u2502                                                                               \u2502\n\u2502  metatools tools list                                                        \u2502\n\u2502  \u2514\u2500 List all registered tools (from all backends)                          \u2502\n\u2502                                                                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#transport-configuration-summary","title":"Transport Configuration Summary","text":"<pre><code># Complete transport configuration example\ntransports:\n  # Stdio for MCP desktop clients\n  - type: stdio\n    enabled: true\n\n  # SSE for web clients\n  - type: sse\n    enabled: true\n    http:\n      host: \"0.0.0.0\"\n      port: 8080\n      base_path: /mcp\n      cors:\n        enabled: true\n        origins: [\"*\"]\n        methods: [\"GET\", \"POST\", \"OPTIONS\"]\n        headers: [\"Content-Type\", \"Authorization\"]\n      tls:\n        enabled: true\n        cert: /etc/ssl/certs/server.crt\n        key: /etc/ssl/private/server.key\n      timeouts:\n        read: 30s\n        write: 60s\n        idle: 120s\n      health:\n        enabled: true\n        liveness_path: /healthz\n        readiness_path: /ready\n\n  # WebSocket for real-time apps\n  - type: websocket\n    enabled: false\n    websocket:\n      host: \"0.0.0.0\"\n      port: 8081\n      path: /ws\n\n  # gRPC for service-to-service\n  - type: grpc\n    enabled: false\n    grpc:\n      host: \"0.0.0.0\"\n      port: 9090\n      reflection: true\n\n  # Unix socket for local IPC\n  - type: unix\n    enabled: false\n    unix:\n      path: /var/run/metatools.sock\n      permissions: \"0660\"\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#2-search-strategy","title":"2. Search Strategy","text":"<p>Already implemented via build tags + interface:</p> <pre><code>// toolindex.Searcher interface\ntype Searcher interface {\n    Search(query string, limit int) ([]Summary, error)\n}\n\n// Implementations:\n// - Default lexical (built into toolindex)\n// - BM25 (toolsearch package, requires build tag)\n// - Semantic/vector (future, could use embeddings)\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#3-tool-provider-registry","title":"3. Tool Provider Registry","text":"<p>New pattern to enable plug-and-play tools:</p> <pre><code>// ToolProvider interface\ntype ToolProvider interface {\n    Name() string\n    Tool() *mcp.Tool  // MCP tool definition with schema\n    Handle(ctx context.Context, input []byte) (any, error)\n}\n\n// Registry\ntype ToolRegistry struct {\n    providers map[string]ToolProvider\n}\n\nfunc (r *ToolRegistry) Register(p ToolProvider) {\n    r.providers[p.Name()] = p\n}\n\nfunc (r *ToolRegistry) All() []ToolProvider {\n    // Returns all registered providers\n}\n</code></pre> <p>Migration path: Convert existing handlers to ToolProvider implementations.</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#4-backend-registry","title":"4. Backend Registry","text":"<p>For tool execution sources (local, API, MCP servers):</p> <pre><code>// Backend interface (already in toolmodel conceptually)\ntype Backend interface {\n    Kind() string\n    Execute(ctx context.Context, tool string, args map[string]any) (any, error)\n}\n\n// Registry with configuration\ntype BackendRegistry struct {\n    backends map[string]Backend\n}\n\nfunc (r *BackendRegistry) RegisterFromConfig(cfg BackendConfig) error {\n    switch cfg.Kind {\n    case \"local\":\n        r.backends[\"local\"] = NewLocalBackend(cfg.Local)\n    case \"openai\":\n        r.backends[\"openai\"] = NewOpenAIBackend(cfg.OpenAI)\n    // ...\n    }\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#5-middleware-chain","title":"5. Middleware Chain","text":"<p>The middleware layer provides pluggable cross-cutting concerns using the decorator pattern.</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#architecture-overview_1","title":"Architecture Overview","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         MIDDLEWARE CHAIN                                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                               \u2502\n\u2502   Incoming Request                                                           \u2502\n\u2502         \u2502                                                                     \u2502\n\u2502         \u25bc                                                                     \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u2502\n\u2502   \u2502  Logging  \u2502 \u2192 \u2502   Auth    \u2502 \u2192 \u2502   Rate    \u2502 \u2192 \u2502  Caching  \u2502            \u2502\n\u2502   \u2502           \u2502   \u2502           \u2502   \u2502  Limiter  \u2502   \u2502           \u2502            \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518            \u2502\n\u2502         \u2502               \u2502               \u2502               \u2502                    \u2502\n\u2502         \u2502   on error:   \u2502   on error:   \u2502   on error:   \u2502                    \u2502\n\u2502         \u2502   log &amp; pass  \u2502   reject 401  \u2502   reject 429  \u2502                    \u2502\n\u2502         \u2502               \u2502               \u2502               \u2502                    \u2502\n\u2502         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                    \u2502\n\u2502                                         \u2502                                     \u2502\n\u2502                                         \u25bc                                     \u2502\n\u2502                               \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                              \u2502\n\u2502                               \u2502  Tool Handler \u2502                              \u2502\n\u2502                               \u2502   (actual)    \u2502                              \u2502\n\u2502                               \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                              \u2502\n\u2502                                         \u2502                                     \u2502\n\u2502                                         \u25bc                                     \u2502\n\u2502   Response flows back through chain (for metrics, logging, caching)         \u2502\n\u2502                                                                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#the-middleware-interface","title":"The Middleware Interface","text":"<pre><code>// Middleware wraps a ToolProvider with additional behavior\ntype Middleware func(ToolProvider) ToolProvider\n\n// MiddlewareFunc is a convenience type for stateless middleware\ntype MiddlewareFunc func(ctx context.Context, input []byte, next NextFunc) (any, error)\n\ntype NextFunc func(ctx context.Context, input []byte) (any, error)\n\n// MiddlewareRegistry manages available middleware\ntype MiddlewareRegistry struct {\n    available map[string]MiddlewareFactory\n    active    []Middleware\n}\n\n// MiddlewareFactory creates configured middleware instances\ntype MiddlewareFactory func(cfg MiddlewareConfig) (Middleware, error)\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#built-in-middleware","title":"Built-in Middleware","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        AVAILABLE MIDDLEWARE                                  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502 LOGGING                                                                  \u2502 \u2502\n\u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524 \u2502\n\u2502  \u2502 - Request/response logging                                              \u2502 \u2502\n\u2502  \u2502 - Configurable log levels (debug, info, warn, error)                   \u2502 \u2502\n\u2502  \u2502 - Structured JSON output                                                \u2502 \u2502\n\u2502  \u2502 - Request ID tracking                                                   \u2502 \u2502\n\u2502  \u2502 - Duration metrics                                                      \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502 AUTHENTICATION                                                           \u2502 \u2502\n\u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524 \u2502\n\u2502  \u2502 - Bearer token validation                                               \u2502 \u2502\n\u2502  \u2502 - API key authentication                                                \u2502 \u2502\n\u2502  \u2502 - OAuth2/OIDC integration                                               \u2502 \u2502\n\u2502  \u2502 - mTLS client certificates                                              \u2502 \u2502\n\u2502  \u2502 - Configurable bypass for specific tools                               \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502 RATE LIMITING                                                            \u2502 \u2502\n\u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524 \u2502\n\u2502  \u2502 - Per-client rate limits                                                \u2502 \u2502\n\u2502  \u2502 - Per-tool rate limits                                                  \u2502 \u2502\n\u2502  \u2502 - Token bucket algorithm                                                \u2502 \u2502\n\u2502  \u2502 - Sliding window counters                                               \u2502 \u2502\n\u2502  \u2502 - Redis-backed for distributed deployments                             \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502 CACHING                                                                  \u2502 \u2502\n\u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524 \u2502\n\u2502  \u2502 - Response caching for idempotent tools                                \u2502 \u2502\n\u2502  \u2502 - Configurable TTL per tool                                            \u2502 \u2502\n\u2502  \u2502 - Cache key customization                                               \u2502 \u2502\n\u2502  \u2502 - In-memory or Redis backend                                           \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502 METRICS                                                                  \u2502 \u2502\n\u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524 \u2502\n\u2502  \u2502 - Prometheus-compatible metrics                                         \u2502 \u2502\n\u2502  \u2502 - Request counts, latencies, error rates                               \u2502 \u2502\n\u2502  \u2502 - Per-tool and per-backend breakdowns                                  \u2502 \u2502\n\u2502  \u2502 - Custom metric labels                                                  \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502 TRACING                                                                  \u2502 \u2502\n\u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524 \u2502\n\u2502  \u2502 - OpenTelemetry integration                                             \u2502 \u2502\n\u2502  \u2502 - Distributed trace propagation                                         \u2502 \u2502\n\u2502  \u2502 - Span creation for each tool call                                     \u2502 \u2502\n\u2502  \u2502 - Backend call tracing                                                  \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502 VALIDATION                                                               \u2502 \u2502\n\u2502  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524 \u2502\n\u2502  \u2502 - JSON Schema validation on inputs                                      \u2502 \u2502\n\u2502  \u2502 - Output validation                                                     \u2502 \u2502\n\u2502  \u2502 - Custom validators per tool                                           \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#implementing-custom-middleware","title":"Implementing Custom Middleware","text":"<pre><code>// Example: Custom audit logging middleware\ntype AuditMiddleware struct {\n    logger AuditLogger\n    next   ToolProvider\n}\n\nfunc NewAuditMiddleware(logger AuditLogger) Middleware {\n    return func(next ToolProvider) ToolProvider {\n        return &amp;AuditMiddleware{\n            logger: logger,\n            next:   next,\n        }\n    }\n}\n\nfunc (m *AuditMiddleware) Name() string { return m.next.Name() }\nfunc (m *AuditMiddleware) Tool() *mcp.Tool { return m.next.Tool() }\n\nfunc (m *AuditMiddleware) Handle(ctx context.Context, input []byte) (any, error) {\n    // Pre-execution: Log the request\n    requestID := uuid.New().String()\n    user := auth.UserFromContext(ctx)\n\n    m.logger.LogRequest(AuditEntry{\n        RequestID: requestID,\n        User:      user,\n        Tool:      m.next.Name(),\n        Input:     input,\n        Timestamp: time.Now(),\n    })\n\n    // Execute the actual tool\n    result, err := m.next.Handle(ctx, input)\n\n    // Post-execution: Log the result\n    m.logger.LogResponse(AuditEntry{\n        RequestID: requestID,\n        User:      user,\n        Tool:      m.next.Name(),\n        Success:   err == nil,\n        Duration:  time.Since(start),\n        Timestamp: time.Now(),\n    })\n\n    return result, err\n}\n\n// Register custom middleware\nfunc init() {\n    middleware.Register(\"audit\", func(cfg MiddlewareConfig) (Middleware, error) {\n        logger := newAuditLogger(cfg)\n        return NewAuditMiddleware(logger), nil\n    })\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#configuration-driven-middleware","title":"Configuration-Driven Middleware","text":"<pre><code># metatools.yaml\nmiddleware:\n  # Order matters - first in config = first in chain\n  chain:\n    - logging\n    - auth\n    - rate_limit\n    - metrics\n    - audit  # Custom middleware\n\n  # Per-middleware configuration\n  logging:\n    enabled: true\n    level: info\n    format: json\n    include_request_body: false\n    include_response_body: false\n\n  auth:\n    enabled: true\n    type: bearer\n    token_validation:\n      issuer: https://auth.example.com\n      audience: metatools-api\n    bypass_tools:\n      - search_tools  # Allow anonymous search\n      - list_namespaces\n\n  rate_limit:\n    enabled: true\n    default:\n      requests_per_minute: 100\n      burst: 20\n    per_tool:\n      execute_code:\n        requests_per_minute: 10\n        burst: 2\n    storage: memory  # or redis\n\n  metrics:\n    enabled: true\n    endpoint: /metrics\n    labels:\n      environment: production\n      service: metatools\n\n  cache:\n    enabled: true\n    backend: memory  # or redis\n    default_ttl: 5m\n    per_tool:\n      describe_tool:\n        ttl: 1h\n      search_tools:\n        ttl: 30s\n\n  audit:\n    enabled: true\n    destination: file\n    path: /var/log/metatools/audit.log\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#middleware-chain-construction","title":"Middleware Chain Construction","text":"<pre><code>// Chain construction from config\nfunc BuildMiddlewareChain(cfg MiddlewareConfig) ([]Middleware, error) {\n    var chain []Middleware\n\n    for _, name := range cfg.Chain {\n        mwCfg, ok := cfg.Middlewares[name]\n        if !ok || !mwCfg.Enabled {\n            continue\n        }\n\n        // Look up factory in registry\n        factory, ok := middleware.Get(name)\n        if !ok {\n            return nil, fmt.Errorf(\"unknown middleware: %s\", name)\n        }\n\n        // Create middleware instance\n        mw, err := factory(mwCfg)\n        if err != nil {\n            return nil, fmt.Errorf(\"middleware %s: %w\", name, err)\n        }\n\n        chain = append(chain, mw)\n    }\n\n    return chain, nil\n}\n\n// Apply chain to all providers\nfunc ApplyToRegistry(registry *ToolRegistry, chain []Middleware) {\n    for name, provider := range registry.providers {\n        wrapped := provider\n        for i := len(chain) - 1; i &gt;= 0; i-- {\n            wrapped = chain[i](wrapped)\n        }\n        registry.providers[name] = wrapped\n    }\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#request-flow-through-middleware","title":"Request Flow Through Middleware","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    REQUEST FLOW EXAMPLE                                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                              \u2502\n\u2502   Client Request: run_tool(\"github/create_issue\", {...})                    \u2502\n\u2502                                                                              \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502   \u2502 1. LOGGING MIDDLEWARE                                                 \u2502  \u2502\n\u2502   \u2502    - Generate request ID: \"req-abc123\"                               \u2502  \u2502\n\u2502   \u2502    - Log: \"Incoming request for github/create_issue\"                 \u2502  \u2502\n\u2502   \u2502    - Start timer                                                      \u2502  \u2502\n\u2502   \u2502    \u2192 Pass to next                                                     \u2502  \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                              \u2502                                               \u2502\n\u2502                              \u25bc                                               \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502   \u2502 2. AUTH MIDDLEWARE                                                    \u2502  \u2502\n\u2502   \u2502    - Extract token from Authorization header                         \u2502  \u2502\n\u2502   \u2502    - Validate JWT signature                                          \u2502  \u2502\n\u2502   \u2502    - Check claims (issuer, audience, expiry)                        \u2502  \u2502\n\u2502   \u2502    - Inject user into context                                        \u2502  \u2502\n\u2502   \u2502    \u2192 Pass to next (or reject with 401)                               \u2502  \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                              \u2502                                               \u2502\n\u2502                              \u25bc                                               \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502   \u2502 3. RATE LIMIT MIDDLEWARE                                              \u2502  \u2502\n\u2502   \u2502    - Identify client (by user, IP, or API key)                       \u2502  \u2502\n\u2502   \u2502    - Check token bucket for \"github/create_issue\"                    \u2502  \u2502\n\u2502   \u2502    - Consume token                                                    \u2502  \u2502\n\u2502   \u2502    \u2192 Pass to next (or reject with 429)                               \u2502  \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                              \u2502                                               \u2502\n\u2502                              \u25bc                                               \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502   \u2502 4. METRICS MIDDLEWARE                                                 \u2502  \u2502\n\u2502   \u2502    - Increment request counter                                        \u2502  \u2502\n\u2502   \u2502    - Start latency timer                                              \u2502  \u2502\n\u2502   \u2502    \u2192 Pass to next                                                     \u2502  \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                              \u2502                                               \u2502\n\u2502                              \u25bc                                               \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502   \u2502 5. ACTUAL TOOL HANDLER                                                \u2502  \u2502\n\u2502   \u2502    - Route to GitHub backend                                         \u2502  \u2502\n\u2502   \u2502    - Execute create_issue                                            \u2502  \u2502\n\u2502   \u2502    - Return result                                                    \u2502  \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                              \u2502                                               \u2502\n\u2502                              \u25bc                                               \u2502\n\u2502   Response bubbles back through chain:                                      \u2502\n\u2502   - Metrics: Record latency, success/failure                                \u2502\n\u2502   - Rate limit: (no action on response)                                     \u2502\n\u2502   - Auth: (no action on response)                                           \u2502\n\u2502   - Logging: Log response, duration, status                                 \u2502\n\u2502                                                                              \u2502\n\u2502   Final Response \u2192 Client                                                   \u2502\n\u2502                                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#registering-custom-middleware","title":"Registering Custom Middleware","text":"<pre><code>// Register at init time (compile-time pluggability)\nfunc init() {\n    middleware.Register(\"my-custom\", NewMyCustomMiddleware)\n}\n\n// Or register at runtime (config-driven)\nfunc setupMiddleware(registry *MiddlewareRegistry) {\n    // Built-in middleware (always available)\n    registry.Register(\"logging\", NewLoggingMiddleware)\n    registry.Register(\"auth\", NewAuthMiddleware)\n    registry.Register(\"rate_limit\", NewRateLimitMiddleware)\n    registry.Register(\"metrics\", NewMetricsMiddleware)\n    registry.Register(\"cache\", NewCacheMiddleware)\n\n    // Custom middleware (loaded from config or plugins)\n    registry.Register(\"audit\", NewAuditMiddleware)\n    registry.Register(\"pii-filter\", NewPIIFilterMiddleware)\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#middleware-composition-patterns","title":"Middleware Composition Patterns","text":"<pre><code>// Conditional middleware (only apply to certain tools)\nfunc OnlyForTools(tools []string, mw Middleware) Middleware {\n    return func(next ToolProvider) ToolProvider {\n        if slices.Contains(tools, next.Name()) {\n            return mw(next)\n        }\n        return next\n    }\n}\n\n// Except middleware (skip for certain tools)\nfunc ExceptForTools(tools []string, mw Middleware) Middleware {\n    return func(next ToolProvider) ToolProvider {\n        if slices.Contains(tools, next.Name()) {\n            return next\n        }\n        return mw(next)\n    }\n}\n\n// Usage\nchain := []Middleware{\n    LoggingMiddleware,\n    ExceptForTools([]string{\"search_tools\"}, AuthMiddleware),\n    OnlyForTools([]string{\"execute_code\"}, StrictRateLimitMiddleware),\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#multi-backend-architecture","title":"Multi-Backend Architecture","text":"<p>The backend layer is the foundation for tool discovery and execution. It enables metatools-mcp to aggregate tools from multiple sources while presenting a unified interface to MCP clients.</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#architecture-overview_2","title":"Architecture Overview","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                           MCP CLIENT                                         \u2502\n\u2502                    (Claude, Cursor, Custom)                                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                  \u2502 MCP Protocol\n                                  \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         METATOOLS-MCP SERVER                                 \u2502\n\u2502                                                                               \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502                      UNIFIED TOOL INTERFACE                              \u2502 \u2502\n\u2502  \u2502                                                                           \u2502 \u2502\n\u2502  \u2502   search_tools    describe_tool    run_tool    run_chain    execute_code \u2502 \u2502\n\u2502  \u2502                                                                           \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                    \u2502                                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502                       BACKEND REGISTRY                                   \u2502 \u2502\n\u2502  \u2502                                                                           \u2502 \u2502\n\u2502  \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u2502 \u2502\n\u2502  \u2502   \u2502   LOCAL     \u2502 \u2502   OPENAI    \u2502 \u2502    MCP      \u2502 \u2502   CUSTOM    \u2502       \u2502 \u2502\n\u2502  \u2502   \u2502  Backend    \u2502 \u2502  Backend    \u2502 \u2502  Backend    \u2502 \u2502  Backend    \u2502       \u2502 \u2502\n\u2502  \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2502 \u2502\n\u2502  \u2502          \u2502               \u2502               \u2502               \u2502               \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n              \u2502               \u2502               \u2502               \u2502\n              \u25bc               \u25bc               \u25bc               \u25bc\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502  Local   \u2502   \u2502  OpenAI  \u2502   \u2502  Other   \u2502   \u2502  Custom  \u2502\n        \u2502  Files   \u2502   \u2502   API    \u2502   \u2502   MCP    \u2502   \u2502   API    \u2502\n        \u2502          \u2502   \u2502          \u2502   \u2502 Servers  \u2502   \u2502          \u2502\n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#the-backend-interface","title":"The Backend Interface","text":"<p>Each backend implements a common interface, allowing uniform handling regardless of the tool source:</p> <pre><code>// Backend defines a source of tools\ntype Backend interface {\n    // Identity\n    Kind() string                                    // e.g., \"local\", \"openai\", \"mcp\"\n    Name() string                                    // Instance name for disambiguation\n\n    // Configuration\n    Configure(raw []byte) error                      // Parse backend-specific config\n\n    // Discovery\n    ListTools(ctx context.Context) ([]toolmodel.Tool, error)\n\n    // Execution\n    Execute(ctx context.Context, tool string, args map[string]any) (any, error)\n\n    // Lifecycle\n    Start(ctx context.Context) error\n    Stop() error\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#backend-types","title":"Backend Types","text":""},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#1-local-backend","title":"1. Local Backend","text":"<p>Tools defined as files on disk (YAML, JSON, or Go handlers).</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   LOCAL BACKEND                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                       \u2502\n\u2502   ~/.config/metatools/tools/                         \u2502\n\u2502   \u251c\u2500\u2500 calculator.yaml      \u2192 Tool definition         \u2502\n\u2502   \u251c\u2500\u2500 file-ops.yaml        \u2192 Tool definition         \u2502\n\u2502   \u2514\u2500\u2500 custom/                                        \u2502\n\u2502       \u2514\u2500\u2500 my-tool.yaml     \u2192 Tool definition         \u2502\n\u2502                                                       \u2502\n\u2502   /usr/share/metatools/tools/                        \u2502\n\u2502   \u2514\u2500\u2500 system-tools.yaml    \u2192 System-wide tools       \u2502\n\u2502                                                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Config:                                             \u2502\n\u2502    paths:                                            \u2502\n\u2502      - ~/.config/metatools/tools                    \u2502\n\u2502      - /usr/share/metatools/tools                   \u2502\n\u2502    watch: true  # Hot reload on changes             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#2-api-backends-openai-azure-anthropic","title":"2. API Backends (OpenAI, Azure, Anthropic)","text":"<p>Tools exposed via LLM provider APIs.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   OPENAI BACKEND                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                       \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502   \u2502 metatools   \u2502 \u2500\u2500\u2500\u2500\u2500\u2500\u25b6\u2502  OpenAI API         \u2502    \u2502\n\u2502   \u2502   run_tool  \u2502        \u2502  /chat/completions  \u2502    \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2502  (function calling) \u2502    \u2502\n\u2502                          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Config:                                             \u2502\n\u2502    api_key: ${OPENAI_API_KEY}                       \u2502\n\u2502    organization: ${OPENAI_ORG}                      \u2502\n\u2502    models:                                           \u2502\n\u2502      - gpt-4                                        \u2502\n\u2502      - gpt-4-turbo                                  \u2502\n\u2502    timeout: 30s                                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#3-mcp-backend","title":"3. MCP Backend","text":"<p>Connect to other MCP servers as tool sources.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    MCP BACKEND                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                       \u2502\n\u2502   metatools-mcp                                      \u2502\n\u2502        \u2502                                             \u2502\n\u2502        \u2502 stdio                                       \u2502\n\u2502        \u25bc                                             \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                   \u2502\n\u2502   \u2502  GitHub     \u2502  \u2190 npx @modelcontextprotocol/     \u2502\n\u2502   \u2502  MCP Server \u2502       server-github               \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                   \u2502\n\u2502        \u2502                                             \u2502\n\u2502        \u25bc                                             \u2502\n\u2502   GitHub API tools:                                  \u2502\n\u2502   - create_issue                                    \u2502\n\u2502   - list_pull_requests                              \u2502\n\u2502   - search_code                                     \u2502\n\u2502                                                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Config:                                             \u2502\n\u2502    kind: mcp                                        \u2502\n\u2502    command: npx                                     \u2502\n\u2502    args:                                            \u2502\n\u2502      - \"-y\"                                         \u2502\n\u2502      - \"@modelcontextprotocol/server-github\"        \u2502\n\u2502    env:                                             \u2502\n\u2502      GITHUB_TOKEN: ${GITHUB_TOKEN}                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#4-http-backend","title":"4. HTTP Backend","text":"<p>Tools exposed via REST APIs.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   HTTP BACKEND                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                       \u2502\n\u2502   metatools-mcp                                      \u2502\n\u2502        \u2502                                             \u2502\n\u2502        \u2502 HTTPS                                       \u2502\n\u2502        \u25bc                                             \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                       \u2502\n\u2502   \u2502  Internal Tool Server   \u2502                       \u2502\n\u2502   \u2502  tools.company.internal \u2502                       \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u2502\n\u2502        \u2502                                             \u2502\n\u2502        \u25bc                                             \u2502\n\u2502   Endpoints:                                         \u2502\n\u2502   - POST /tools/list                                \u2502\n\u2502   - POST /tools/{name}/execute                      \u2502\n\u2502                                                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Config:                                             \u2502\n\u2502    base_url: https://tools.company.internal         \u2502\n\u2502    auth:                                            \u2502\n\u2502      type: oauth2                                   \u2502\n\u2502      client_id: ${OAUTH_CLIENT_ID}                  \u2502\n\u2502      client_secret: ${OAUTH_CLIENT_SECRET}          \u2502\n\u2502    headers:                                         \u2502\n\u2502      X-Custom-Header: value                         \u2502\n\u2502    timeout: 30s                                     \u2502\n\u2502    retry:                                           \u2502\n\u2502      max_attempts: 3                                \u2502\n\u2502      backoff: exponential                           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#5-custom-backend","title":"5. Custom Backend","text":"<p>For specialized integrations that don't fit standard patterns.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  CUSTOM BACKEND                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                       \u2502\n\u2502   Implement the Backend interface in Go:             \u2502\n\u2502                                                       \u2502\n\u2502   type MyCustomBackend struct {                     \u2502\n\u2502       // Your fields                                \u2502\n\u2502   }                                                  \u2502\n\u2502                                                       \u2502\n\u2502   func (b *MyCustomBackend) Kind() string {         \u2502\n\u2502       return \"my-custom\"                            \u2502\n\u2502   }                                                  \u2502\n\u2502                                                       \u2502\n\u2502   func (b *MyCustomBackend) Configure(raw []byte)   \u2502\n\u2502       error {                                       \u2502\n\u2502       // Parse your custom config                   \u2502\n\u2502       return yaml.Unmarshal(raw, &amp;b.config)         \u2502\n\u2502   }                                                  \u2502\n\u2502                                                       \u2502\n\u2502   func (b *MyCustomBackend) Execute(ctx, tool,      \u2502\n\u2502       args) (any, error) {                          \u2502\n\u2502       // Your execution logic                       \u2502\n\u2502   }                                                  \u2502\n\u2502                                                       \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Config (passed as raw bytes):                      \u2502\n\u2502    kind: custom                                     \u2502\n\u2502    handler: my-custom                               \u2502\n\u2502    config:                                          \u2502\n\u2502      whatever_you_need: value                       \u2502\n\u2502      nested:                                        \u2502\n\u2502        custom: structure                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#configuration-examples","title":"Configuration Examples","text":""},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#comprehensive-multi-backend-setup","title":"Comprehensive Multi-Backend Setup","text":"<pre><code># metatools.yaml\nbackends:\n  # Local file-based tools\n  local:\n    enabled: true\n    paths:\n      - ~/.config/metatools/tools\n      - /usr/share/metatools/tools\n    watch: true  # Hot reload\n\n  # OpenAI function calling\n  openai:\n    enabled: true\n    api_key: ${OPENAI_API_KEY}\n    organization: ${OPENAI_ORG}\n    models:\n      - gpt-4\n      - gpt-4-turbo\n    timeout: 30s\n\n  # Azure OpenAI\n  azure-openai:\n    enabled: true\n    kind: azure\n    config:\n      endpoint: https://my-resource.openai.azure.com\n      api_key: ${AZURE_OPENAI_KEY}\n      api_version: \"2024-02-15-preview\"\n      deployment: gpt-4\n\n  # GitHub MCP server\n  github:\n    enabled: true\n    kind: mcp\n    config:\n      command: npx\n      args: [\"-y\", \"@modelcontextprotocol/server-github\"]\n      env:\n        GITHUB_TOKEN: ${GITHUB_TOKEN}\n\n  # Filesystem MCP server\n  filesystem:\n    enabled: true\n    kind: mcp\n    config:\n      command: npx\n      args: [\"-y\", \"@modelcontextprotocol/server-filesystem\", \"/home/user/projects\"]\n\n  # Internal company tool server\n  internal-tools:\n    enabled: true\n    kind: http\n    config:\n      base_url: https://tools.internal.company.com/api/v1\n      auth:\n        type: oauth2\n        token_url: https://auth.company.com/oauth/token\n        client_id: ${INTERNAL_CLIENT_ID}\n        client_secret: ${INTERNAL_CLIENT_SECRET}\n        scopes: [\"tools:read\", \"tools:execute\"]\n      timeout: 60s\n\n  # LangChain tools\n  langchain:\n    enabled: false\n    kind: custom\n    config:\n      toolkit: serpapi\n      api_key: ${SERPAPI_KEY}\n\n  # Database tools\n  database:\n    enabled: true\n    kind: custom\n    config:\n      driver: postgres\n      connection_string: ${DATABASE_URL}\n      read_only: true\n      allowed_schemas: [\"public\", \"analytics\"]\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#tool-aggregation-flow","title":"Tool Aggregation Flow","text":"<p>When a client searches for or executes tools, metatools-mcp aggregates across all backends:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         TOOL SEARCH FLOW                                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                              \u2502\n\u2502   Client: search_tools(\"file operations\")                                   \u2502\n\u2502                           \u2502                                                  \u2502\n\u2502                           \u25bc                                                  \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                    BACKEND REGISTRY                                  \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u2502   \u2502\n\u2502   \u2502   \u2502  local  \u2502   \u2502 github  \u2502   \u2502  azure  \u2502   \u2502  http   \u2502            \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518            \u2502   \u2502\n\u2502   \u2502        \u2502             \u2502             \u2502             \u2502                  \u2502   \u2502\n\u2502   \u2502        \u25bc             \u25bc             \u25bc             \u25bc                  \u2502   \u2502\n\u2502   \u2502   ListTools()   ListTools()   ListTools()   ListTools()            \u2502   \u2502\n\u2502   \u2502        \u2502             \u2502             \u2502             \u2502                  \u2502   \u2502\n\u2502   \u2502        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                  \u2502   \u2502\n\u2502   \u2502                             \u2502                                        \u2502   \u2502\n\u2502   \u2502                             \u25bc                                        \u2502   \u2502\n\u2502   \u2502                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                              \u2502   \u2502\n\u2502   \u2502                    \u2502   AGGREGATOR    \u2502                              \u2502   \u2502\n\u2502   \u2502                    \u2502  - Merge tools  \u2502                              \u2502   \u2502\n\u2502   \u2502                    \u2502  - Deduplicate  \u2502                              \u2502   \u2502\n\u2502   \u2502                    \u2502  - Apply search \u2502                              \u2502   \u2502\n\u2502   \u2502                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                              \u2502   \u2502\n\u2502   \u2502                             \u2502                                        \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                 \u25bc                                            \u2502\n\u2502   Results:                                                                   \u2502\n\u2502   [                                                                          \u2502\n\u2502     { id: \"local/file-read\",      backend: \"local\",    score: 0.95 },       \u2502\n\u2502     { id: \"github/get-file\",      backend: \"github\",   score: 0.87 },       \u2502\n\u2502     { id: \"filesystem/read_file\", backend: \"mcp\",      score: 0.82 },       \u2502\n\u2502   ]                                                                          \u2502\n\u2502                                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#tool-execution-flow","title":"Tool Execution Flow","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        TOOL EXECUTION FLOW                                  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                              \u2502\n\u2502   Client: run_tool(\"github/create_issue\", { title: \"Bug\", body: \"...\" })   \u2502\n\u2502                           \u2502                                                  \u2502\n\u2502                           \u25bc                                                  \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                      TOOL ROUTER                                     \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   1. Parse tool ID: \"github/create_issue\"                           \u2502   \u2502\n\u2502   \u2502      \u2514\u2500 backend: \"github\"                                           \u2502   \u2502\n\u2502   \u2502      \u2514\u2500 tool: \"create_issue\"                                        \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   2. Lookup backend in registry                                     \u2502   \u2502\n\u2502   \u2502      \u2514\u2500 Found: GitHubMCPBackend                                     \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   3. Delegate execution                                              \u2502   \u2502\n\u2502   \u2502      \u2514\u2500 backend.Execute(ctx, \"create_issue\", args)                  \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                           \u2502                                                  \u2502\n\u2502                           \u25bc                                                  \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                   GITHUB MCP BACKEND                                 \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   1. Forward to MCP subprocess                                      \u2502   \u2502\n\u2502   \u2502      \u2514\u2500 npx @modelcontextprotocol/server-github                     \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   2. MCP call: tools/call { name: \"create_issue\", arguments: ... }  \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   3. Receive result                                                  \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                           \u2502                                                  \u2502\n\u2502                           \u25bc                                                  \u2502\n\u2502   Result:                                                                    \u2502\n\u2502   {                                                                          \u2502\n\u2502     result: { issue_number: 123, url: \"https://github.com/...\" },          \u2502\n\u2502     backend: { kind: \"mcp\", name: \"github\" },                              \u2502\n\u2502     duration_ms: 1250                                                       \u2502\n\u2502   }                                                                          \u2502\n\u2502                                                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#registration-patterns","title":"Registration Patterns","text":"<p>Backends can be registered via YAML configuration or programmatically:</p> <pre><code>// YAML-driven registration (config file)\nfunc (r *BackendRegistry) LoadFromConfig(cfg BackendsConfig) error {\n    for name, backendCfg := range cfg.Backends {\n        if !backendCfg.Enabled {\n            continue\n        }\n\n        // Create backend based on kind\n        backend, err := r.createBackend(backendCfg.Kind)\n        if err != nil {\n            return fmt.Errorf(\"backend %s: %w\", name, err)\n        }\n\n        // Configure with raw config (backend parses itself)\n        if err := backend.Configure(backendCfg.RawConfig); err != nil {\n            return fmt.Errorf(\"backend %s config: %w\", name, err)\n        }\n\n        r.backends[name] = backend\n    }\n    return nil\n}\n\n// Programmatic registration (code-driven)\nfunc main() {\n    registry := NewBackendRegistry()\n\n    // Register a custom backend programmatically\n    myBackend := &amp;MyCustomBackend{\n        // ... configuration\n    }\n    registry.Register(\"my-backend\", myBackend)\n\n    // Or use the builder pattern\n    registry.\n        WithLocal(\"~/.config/metatools/tools\").\n        WithOpenAI(os.Getenv(\"OPENAI_API_KEY\")).\n        WithMCP(\"github\", \"npx\", \"-y\", \"@modelcontextprotocol/server-github\")\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#hybrid-configuration","title":"Hybrid Configuration","text":"<p>For maximum flexibility, backends support both YAML and code:</p> <pre><code>// Backend interface with hybrid config support\ntype Backend interface {\n    Kind() string\n    Name() string\n\n    // Option 1: YAML-driven config\n    Configure(raw []byte) error\n\n    // Option 2: Programmatic config (for complex backends)\n    ConfigureWith(opts ...BackendOption) error\n\n    // Operations\n    ListTools(ctx context.Context) ([]toolmodel.Tool, error)\n    Execute(ctx context.Context, tool string, args map[string]any) (any, error)\n}\n\n// Usage: Some config in YAML, some in code\nfunc setupBackends(registry *BackendRegistry, cfg Config) error {\n    // Load standard backends from YAML\n    if err := registry.LoadFromConfig(cfg.Backends); err != nil {\n        return err\n    }\n\n    // Add a complex custom backend programmatically\n    customBackend := NewDatabaseBackend(\n        WithConnectionPool(pool),\n        WithQueryValidator(validator),\n        WithAuditLogger(auditLog),\n    )\n    registry.Register(\"database\", customBackend)\n\n    return nil\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#error-handling-across-backends","title":"Error Handling Across Backends","text":"<pre><code>// Backend errors include source information\ntype BackendError struct {\n    Backend   string    // Which backend failed\n    Operation string    // What operation failed\n    Tool      string    // Which tool (if applicable)\n    Cause     error     // Underlying error\n    Retryable bool      // Can this be retried?\n}\n\n// Aggregated errors for multi-backend operations\ntype AggregatedError struct {\n    Errors []BackendError\n}\n\nfunc (e *AggregatedError) Error() string {\n    // Format: \"3 backends failed: local: connection refused, openai: rate limited, ...\"\n}\n\n// Partial success handling\ntype AggregatedResult struct {\n    Tools   []toolmodel.Tool  // Successfully retrieved tools\n    Errors  []BackendError    // Backends that failed\n    Partial bool              // True if some backends failed\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#summary-what-this-enables","title":"Summary: What This Enables","text":"Capability Description Tool Aggregation Single search across all backends Unified Execution Consistent interface regardless of backend Hot Plugging Add/remove backends via config without code changes Custom Backends Write Go code for specialized integrations MCP Composition Chain multiple MCP servers together Hybrid Config YAML for standard backends, code for complex ones Graceful Degradation Continue working if some backends fail"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#configuration-design","title":"Configuration Design","text":""},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#recommended-koanf-cobra","title":"Recommended: Koanf + Cobra","text":"Component Library Rationale CLI framework Cobra Subcommands (<code>stdio</code>, <code>serve</code>, <code>version</code>) Config loading Koanf Lighter than Viper, modular providers"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#configuration-structure","title":"Configuration Structure","text":"<pre><code># metatools.yaml\nserver:\n  name: \"metatools-mcp\"\n  version: \"0.2.0\"\n\ntransport:\n  type: sse           # stdio | sse | http\n  http:\n    host: \"0.0.0.0\"\n    port: 8080\n    tls:\n      enabled: true\n      cert: /etc/ssl/cert.pem\n      key: /etc/ssl/key.pem\n    timeouts:\n      read: 30s\n      write: 30s\n      idle: 120s\n\nsearch:\n  strategy: bm25      # lexical | bm25 | semantic\n  bm25:\n    name_boost: 3\n    namespace_boost: 2\n    tags_boost: 2\n    max_docs: 0\n    max_doctext_len: 0\n\nexecution:\n  timeout: 10s\n  max_tool_calls: 64\n  max_chain_steps: 8\n\n# Tool providers (each gets own config section)\nproviders:\n  search_tools:\n    enabled: true\n  describe_tool:\n    enabled: true\n    default_level: summary\n  run_tool:\n    enabled: true\n  run_chain:\n    enabled: true\n  execute_code:\n    enabled: true      # Requires toolruntime build tag\n    sandbox: dev\n\n# Backend sources for tools\nbackends:\n  local:\n    enabled: true\n    paths:\n      - ~/.config/metatools/tools\n      - /usr/share/metatools/tools\n  openai:\n    enabled: false\n    api_key: ${OPENAI_API_KEY}\n  azure:\n    enabled: false\n    tenant_id: ${AZURE_TENANT_ID}\n\n# Middleware chain\nmiddleware:\n  logging:\n    enabled: true\n    level: info\n  auth:\n    enabled: false\n    type: bearer\n  rate_limit:\n    enabled: false\n    requests_per_minute: 100\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#configuration-precedence","title":"Configuration Precedence","text":"<pre><code>CLI flags &gt; Environment variables &gt; Config file &gt; Defaults\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#plugin-configuration-pattern","title":"Plugin Configuration Pattern","text":"<p>Plugins receive raw config and parse themselves:</p> <pre><code>type Plugin interface {\n    Name() string\n    Configure(raw []byte) error  // Plugin parses its own config\n    Start(ctx context.Context) error\n    Stop() error\n}\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#implementation-approach","title":"Implementation Approach","text":""},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#phase-1-cli-framework-cobra-koanf","title":"Phase 1: CLI Framework (Cobra + Koanf)","text":"<ol> <li>Add Cobra for subcommands (<code>metatools stdio</code>, <code>metatools serve</code>)</li> <li>Add Koanf for config file loading</li> <li>Maintain backward compatibility (env vars still work)</li> </ol>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#phase-2-transport-abstraction","title":"Phase 2: Transport Abstraction","text":"<ol> <li>Define <code>Transport</code> interface</li> <li>Extract current stdio logic into <code>StdioTransport</code></li> <li>Add <code>SSETransport</code> for HTTP/SSE mode</li> <li>Wire transport selection to config/CLI</li> </ol>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#phase-3-tool-provider-registry","title":"Phase 3: Tool Provider Registry","text":"<ol> <li>Define <code>ToolProvider</code> interface</li> <li>Convert existing handlers to providers</li> <li>Replace <code>registerTools()</code> with registry iteration</li> <li>Enable external provider registration</li> </ol>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#phase-4-backend-registry","title":"Phase 4: Backend Registry","text":"<ol> <li>Define <code>BackendRegistry</code> interface</li> <li>Implement config-driven backend loading</li> <li>Support local, API, and MCP server backends</li> </ol>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#phase-5-middleware-chain","title":"Phase 5: Middleware Chain","text":"<ol> <li>Define <code>Middleware</code> type</li> <li>Implement logging, auth, rate limiting</li> <li>Apply middleware via config</li> </ol>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#end-to-end-examples","title":"End-to-End Examples","text":"<p>This section demonstrates how the pluggable architecture works in practice with complete examples.</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#example-1-enterprise-ai-assistant","title":"Example 1: Enterprise AI Assistant","text":"<p>An internal AI assistant that aggregates tools from multiple sources.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    ENTERPRISE AI ASSISTANT                                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                               \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                      FRONTEND / CLIENTS                              \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u2502   \u2502\n\u2502   \u2502   \u2502  Slack    \u2502  \u2502  Teams    \u2502  \u2502   Web     \u2502  \u2502  VS Code  \u2502        \u2502   \u2502\n\u2502   \u2502   \u2502   Bot     \u2502  \u2502   Bot     \u2502  \u2502   App     \u2502  \u2502 Extension \u2502        \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518        \u2502   \u2502\n\u2502   \u2502         \u2502              \u2502              \u2502              \u2502               \u2502   \u2502\n\u2502   \u2502         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518               \u2502   \u2502\n\u2502   \u2502                              \u2502 HTTPS/SSE                             \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                  \u25bc                                           \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                      METATOOLS-MCP SERVER                            \u2502   \u2502\n\u2502   \u2502                         (HA Cluster)                                 \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   Transport: SSE on :8080                                           \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   Middleware Chain:                                                  \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502   \u2502\n\u2502   \u2502   \u2502  Log   \u2502\u2192\u2502 OAuth  \u2502\u2192\u2502 Rate   \u2502\u2192\u2502 Audit  \u2502\u2192\u2502 Cache  \u2502           \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   Tool Providers:                                                    \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510               \u2502   \u2502\n\u2502   \u2502   \u2502 search_tools \u2502 \u2502 describe    \u2502 \u2502 run_tool    \u2502               \u2502   \u2502\n\u2502   \u2502   \u2502              \u2502 \u2502 _tool       \u2502 \u2502             \u2502               \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518               \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   Backends:                                                          \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u2502   \u2502\n\u2502   \u2502   \u2502  Jira    \u2502 \u2502Confluence\u2502 \u2502  GitHub  \u2502 \u2502 Internal \u2502              \u2502   \u2502\n\u2502   \u2502   \u2502   MCP    \u2502 \u2502   MCP    \u2502 \u2502   MCP    \u2502 \u2502   API    \u2502              \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518              \u2502   \u2502\n\u2502   \u2502        \u2502            \u2502            \u2502            \u2502                     \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502            \u25bc            \u25bc            \u25bc            \u25bc                         \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u2502\n\u2502   \u2502    Jira      \u2502 \u2502  Confluence  \u2502 \u2502    GitHub    \u2502 \u2502   Company    \u2502       \u2502\n\u2502   \u2502    Cloud     \u2502 \u2502    Cloud     \u2502 \u2502              \u2502 \u2502     API      \u2502       \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2502\n\u2502                                                                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Configuration:</p> <pre><code># metatools-enterprise.yaml\nserver:\n  name: \"enterprise-ai-assistant\"\n  version: \"1.0.0\"\n\ntransport:\n  type: sse\n  http:\n    host: \"0.0.0.0\"\n    port: 8080\n    tls:\n      enabled: true\n      cert: /etc/ssl/certs/server.crt\n      key: /etc/ssl/private/server.key\n    cors:\n      enabled: true\n      origins:\n        - \"https://chat.company.com\"\n        - \"https://slack-bot.company.internal\"\n    health:\n      enabled: true\n\nmiddleware:\n  chain: [logging, auth, rate_limit, audit, cache]\n\n  logging:\n    enabled: true\n    level: info\n    format: json\n\n  auth:\n    enabled: true\n    type: oauth2\n    issuer: https://auth.company.com\n    audience: metatools-api\n    jwks_uri: https://auth.company.com/.well-known/jwks.json\n\n  rate_limit:\n    enabled: true\n    storage: redis\n    redis:\n      address: redis.company.internal:6379\n    default:\n      requests_per_minute: 60\n    per_user: true\n\n  audit:\n    enabled: true\n    destination: elasticsearch\n    elasticsearch:\n      addresses: [\"https://es.company.internal:9200\"]\n      index: metatools-audit\n\n  cache:\n    enabled: true\n    backend: redis\n    redis:\n      address: redis.company.internal:6379\n    per_tool:\n      search_tools:\n        ttl: 1m\n      describe_tool:\n        ttl: 10m\n\nbackends:\n  jira:\n    enabled: true\n    kind: mcp\n    config:\n      command: npx\n      args: [\"-y\", \"@anthropic/mcp-server-jira\"]\n      env:\n        JIRA_URL: https://company.atlassian.net\n        JIRA_EMAIL: ${JIRA_EMAIL}\n        JIRA_API_TOKEN: ${JIRA_API_TOKEN}\n\n  confluence:\n    enabled: true\n    kind: mcp\n    config:\n      command: npx\n      args: [\"-y\", \"@anthropic/mcp-server-confluence\"]\n      env:\n        CONFLUENCE_URL: https://company.atlassian.net/wiki\n        CONFLUENCE_EMAIL: ${CONFLUENCE_EMAIL}\n        CONFLUENCE_API_TOKEN: ${CONFLUENCE_API_TOKEN}\n\n  github:\n    enabled: true\n    kind: mcp\n    config:\n      command: npx\n      args: [\"-y\", \"@modelcontextprotocol/server-github\"]\n      env:\n        GITHUB_TOKEN: ${GITHUB_TOKEN}\n\n  internal-api:\n    enabled: true\n    kind: http\n    config:\n      base_url: https://api.company.internal/tools/v1\n      auth:\n        type: oauth2\n        token_url: https://auth.company.com/oauth/token\n        client_id: ${INTERNAL_CLIENT_ID}\n        client_secret: ${INTERNAL_CLIENT_SECRET}\n        scopes: [\"tools:read\", \"tools:execute\"]\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#example-2-local-development-setup","title":"Example 2: Local Development Setup","text":"<p>A developer workstation with file system access and code execution.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    LOCAL DEVELOPMENT SETUP                                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                               \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                       DEVELOPER MACHINE                              \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                             \u2502   \u2502\n\u2502   \u2502   \u2502   Claude Desktop  \u2502 \u2190\u2500\u2500 stdio \u2500\u2500\u2510                               \u2502   \u2502\n\u2502   \u2502   \u2502   or Cursor IDE   \u2502             \u2502                               \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518             \u2502                               \u2502   \u2502\n\u2502   \u2502                                      \u2502                               \u2502   \u2502\n\u2502   \u2502                                      \u25bc                               \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502   \u2502\n\u2502   \u2502   \u2502              METATOOLS-MCP (stdio mode)                      \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502                                                               \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   Build: go build -tags \"toolsearch,toolruntime\"            \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502                                                               \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   Features:                                                  \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   - BM25 search (toolsearch tag)                            \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   - Code execution (toolruntime tag)                        \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502                                                               \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   Backends:                                                  \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u2502   Local    \u2502 \u2502 Filesystem \u2502 \u2502   Git      \u2502              \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u2502   Tools    \u2502 \u2502    MCP     \u2502 \u2502   MCP      \u2502              \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502         \u2502              \u2502              \u2502                      \u2502   \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502   \u2502\n\u2502   \u2502             \u2502              \u2502              \u2502                          \u2502   \u2502\n\u2502   \u2502             \u25bc              \u25bc              \u25bc                          \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                  \u2502   \u2502\n\u2502   \u2502   \u2502 ~/.config/ \u2502   \u2502 ~/Projects \u2502   \u2502 .git repos \u2502                  \u2502   \u2502\n\u2502   \u2502   \u2502 metatools/ \u2502   \u2502            \u2502   \u2502            \u2502                  \u2502   \u2502\n\u2502   \u2502   \u2502 tools/     \u2502   \u2502            \u2502   \u2502            \u2502                  \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                  \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Configuration:</p> <pre><code># ~/.config/metatools/config.yaml\nserver:\n  name: \"dev-metatools\"\n  version: \"local\"\n\ntransport:\n  type: stdio\n\nsearch:\n  strategy: bm25\n  bm25:\n    name_boost: 3\n    namespace_boost: 2\n\nexecution:\n  timeout: 30s\n  max_tool_calls: 100\n\nmiddleware:\n  chain: [logging]\n  logging:\n    enabled: true\n    level: debug\n    output: /tmp/metatools.log\n\nbackends:\n  local:\n    enabled: true\n    paths:\n      - ~/.config/metatools/tools\n    watch: true\n\n  filesystem:\n    enabled: true\n    kind: mcp\n    config:\n      command: npx\n      args:\n        - \"-y\"\n        - \"@modelcontextprotocol/server-filesystem\"\n        - \"~/Projects\"\n        - \"~/Documents\"\n\n  git:\n    enabled: true\n    kind: mcp\n    config:\n      command: npx\n      args: [\"-y\", \"@modelcontextprotocol/server-git\"]\n</code></pre> <p>Custom Local Tool Definition:</p> <pre><code># ~/.config/metatools/tools/project-tools.yaml\ntools:\n  - name: run_tests\n    namespace: dev\n    description: Run project tests with optional coverage\n    inputSchema:\n      type: object\n      properties:\n        path:\n          type: string\n          description: Project path\n        coverage:\n          type: boolean\n          default: false\n      required: [path]\n\n    backend:\n      kind: local\n      handler: run_tests\n\n  - name: lint_code\n    namespace: dev\n    description: Run linter on project\n    inputSchema:\n      type: object\n      properties:\n        path:\n          type: string\n        fix:\n          type: boolean\n          default: false\n      required: [path]\n\n    backend:\n      kind: local\n      handler: lint_code\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#example-3-multi-llm-tool-router","title":"Example 3: Multi-LLM Tool Router","text":"<p>A gateway that routes tool calls to different LLM providers.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      MULTI-LLM TOOL ROUTER                                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                               \u2502\n\u2502                         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                                  \u2502\n\u2502                         \u2502   Application   \u2502                                  \u2502\n\u2502                         \u2502   (Your App)    \u2502                                  \u2502\n\u2502                         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                                  \u2502\n\u2502                                  \u2502 MCP                                       \u2502\n\u2502                                  \u25bc                                           \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                      METATOOLS-MCP ROUTER                            \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502   \u2502\n\u2502   \u2502   \u2502                    TOOL AGGREGATOR                           \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502                                                               \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   All tools from all backends visible as one unified set    \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502                                                               \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   search_tools(\"weather\") \u2192                                  \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   [                                                          \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502     { id: \"openai/get_weather\", backend: \"openai\" },        \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502     { id: \"anthropic/weather_lookup\", backend: \"anthropic\" },\u2502   \u2502   \u2502\n\u2502   \u2502   \u2502     { id: \"local/weather_api\", backend: \"local\" }           \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   ]                                                          \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502                                                               \u2502   \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502   \u2502\n\u2502   \u2502                              \u2502                                        \u2502   \u2502\n\u2502   \u2502                              \u25bc                                        \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502   \u2502\n\u2502   \u2502   \u2502                    SMART ROUTER                              \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502                                                               \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   Routes based on:                                           \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   - Tool prefix (openai/*, anthropic/*, local/*)            \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   - Cost optimization                                        \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   - Latency requirements                                     \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502   - Fallback on failure                                     \u2502   \u2502   \u2502\n\u2502   \u2502   \u2502                                                               \u2502   \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502   \u2502\n\u2502   \u2502                              \u2502                                        \u2502   \u2502\n\u2502   \u2502          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                   \u2502   \u2502\n\u2502   \u2502          \u2502                   \u2502                   \u2502                   \u2502   \u2502\n\u2502   \u2502          \u25bc                   \u25bc                   \u25bc                   \u2502   \u2502\n\u2502   \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u2502   \u2502\n\u2502   \u2502   \u2502   OpenAI   \u2502     \u2502 Anthropic  \u2502     \u2502   Local    \u2502              \u2502   \u2502\n\u2502   \u2502   \u2502  Backend   \u2502     \u2502  Backend   \u2502     \u2502  Backend   \u2502              \u2502   \u2502\n\u2502   \u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2502   \u2502\n\u2502   \u2502         \u2502                   \u2502                 \u2502                      \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502             \u2502                   \u2502                 \u2502                          \u2502\n\u2502             \u25bc                   \u25bc                 \u25bc                          \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u2502\n\u2502   \u2502    OpenAI API    \u2502 \u2502  Anthropic API   \u2502 \u2502   Local Tools    \u2502            \u2502\n\u2502   \u2502                  \u2502 \u2502                  \u2502 \u2502                  \u2502            \u2502\n\u2502   \u2502  - GPT-4 tools   \u2502 \u2502  - Claude tools  \u2502 \u2502  - Custom tools  \u2502            \u2502\n\u2502   \u2502  - DALL-E        \u2502 \u2502  - Computer use  \u2502 \u2502  - File ops      \u2502            \u2502\n\u2502   \u2502  - Whisper       \u2502 \u2502                  \u2502 \u2502  - Scripts       \u2502            \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2502\n\u2502                                                                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Configuration:</p> <pre><code># multi-llm-router.yaml\nserver:\n  name: \"llm-tool-router\"\n  version: \"1.0.0\"\n\ntransport:\n  type: sse\n  http:\n    port: 8080\n\nmiddleware:\n  chain: [logging, metrics, cost_tracking]\n\n  cost_tracking:\n    enabled: true\n    storage: postgres\n    postgres:\n      connection_string: ${DATABASE_URL}\n\nbackends:\n  openai:\n    enabled: true\n    kind: openai\n    config:\n      api_key: ${OPENAI_API_KEY}\n      organization: ${OPENAI_ORG}\n      models:\n        - gpt-4\n        - gpt-4-turbo\n        - dall-e-3\n      default_model: gpt-4-turbo\n      timeout: 60s\n\n  anthropic:\n    enabled: true\n    kind: anthropic\n    config:\n      api_key: ${ANTHROPIC_API_KEY}\n      models:\n        - claude-3-opus\n        - claude-3-sonnet\n      default_model: claude-3-sonnet\n      timeout: 60s\n\n  local:\n    enabled: true\n    paths:\n      - /opt/metatools/tools\n\nrouting:\n  # Route by prefix\n  prefix_routing:\n    \"openai/*\": openai\n    \"anthropic/*\": anthropic\n    \"local/*\": local\n\n  # Fallback chain\n  fallback:\n    - openai\n    - anthropic\n    - local\n\n  # Cost optimization\n  cost_aware:\n    enabled: true\n    prefer_cheaper: true\n    budget_per_hour: 10.00\n    currency: USD\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#example-4-microservices-tool-mesh","title":"Example 4: Microservices Tool Mesh","text":"<p>A distributed architecture where each service exposes tools via MCP.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     MICROSERVICES TOOL MESH                                  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                               \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                        API GATEWAY                                   \u2502   \u2502\n\u2502   \u2502                    (Kong / Envoy / etc)                             \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                \u2502                                             \u2502\n\u2502                                \u25bc                                             \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                   METATOOLS-MCP AGGREGATOR                           \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   Transport: gRPC (internal), SSE (external)                        \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   Service Discovery: Kubernetes / Consul                            \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502   Aggregates tools from all registered MCP services                 \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                \u2502                                             \u2502\n\u2502         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                     \u2502\n\u2502         \u2502                      \u2502                      \u2502                     \u2502\n\u2502         \u25bc                      \u25bc                      \u25bc                     \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510               \u2502\n\u2502   \u2502  Orders    \u2502        \u2502  Users     \u2502        \u2502  Inventory \u2502               \u2502\n\u2502   \u2502  Service   \u2502        \u2502  Service   \u2502        \u2502  Service   \u2502               \u2502\n\u2502   \u2502            \u2502        \u2502            \u2502        \u2502            \u2502               \u2502\n\u2502   \u2502  MCP Tools:\u2502        \u2502  MCP Tools:\u2502        \u2502  MCP Tools:\u2502               \u2502\n\u2502   \u2502  - create  \u2502        \u2502  - lookup  \u2502        \u2502  - check   \u2502               \u2502\n\u2502   \u2502    _order  \u2502        \u2502    _user   \u2502        \u2502    _stock  \u2502               \u2502\n\u2502   \u2502  - cancel  \u2502        \u2502  - update  \u2502        \u2502  - reserve \u2502               \u2502\n\u2502   \u2502    _order  \u2502        \u2502    _prefs  \u2502        \u2502    _item   \u2502               \u2502\n\u2502   \u2502  - track   \u2502        \u2502  - auth    \u2502        \u2502  - release \u2502               \u2502\n\u2502   \u2502    _order  \u2502        \u2502            \u2502        \u2502    _item   \u2502               \u2502\n\u2502   \u2502            \u2502        \u2502            \u2502        \u2502            \u2502               \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518               \u2502\n\u2502         \u2502                      \u2502                      \u2502                     \u2502\n\u2502         \u25bc                      \u25bc                      \u25bc                     \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510               \u2502\n\u2502   \u2502 Orders DB  \u2502        \u2502 Users DB   \u2502        \u2502Inventory DB\u2502               \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518               \u2502\n\u2502                                                                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Aggregator Configuration:</p> <pre><code># aggregator.yaml\nserver:\n  name: \"tool-mesh-aggregator\"\n  version: \"1.0.0\"\n\ntransports:\n  - type: sse\n    enabled: true\n    http:\n      port: 8080\n      # External-facing\n\n  - type: grpc\n    enabled: true\n    grpc:\n      port: 9090\n      # Internal service mesh\n\nservice_discovery:\n  type: kubernetes\n  kubernetes:\n    namespace: production\n    label_selector: \"mcp.enabled=true\"\n    port_name: mcp-grpc\n\nbackends:\n  # Auto-discovered from Kubernetes\n  auto_discover:\n    enabled: true\n    refresh_interval: 30s\n\n  # Or explicit configuration\n  orders:\n    enabled: true\n    kind: grpc\n    config:\n      address: orders-service.production.svc:9090\n      tls:\n        enabled: true\n        ca_cert: /etc/ssl/ca.crt\n\n  users:\n    enabled: true\n    kind: grpc\n    config:\n      address: users-service.production.svc:9090\n\n  inventory:\n    enabled: true\n    kind: grpc\n    config:\n      address: inventory-service.production.svc:9090\n</code></pre> <p>Service Configuration (e.g., Orders Service):</p> <pre><code># orders-service/mcp-config.yaml\nserver:\n  name: \"orders-service-mcp\"\n  version: \"2.1.0\"\n\ntransport:\n  type: grpc\n  grpc:\n    port: 9090\n\nproviders:\n  create_order:\n    enabled: true\n  cancel_order:\n    enabled: true\n  track_order:\n    enabled: true\n\nbackends:\n  local:\n    enabled: true\n    # Orders service tools implemented in Go\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#example-5-request-flow-diagram","title":"Example 5: Request Flow Diagram","text":"<p>A complete request flow through all layers:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    COMPLETE REQUEST FLOW                                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                                               \u2502\n\u2502   1. CLIENT REQUEST                                                          \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502  POST /mcp HTTP/1.1                                                  \u2502   \u2502\n\u2502   \u2502  Content-Type: application/json                                      \u2502   \u2502\n\u2502   \u2502  Authorization: Bearer eyJhbGc...                                   \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502  {                                                                   \u2502   \u2502\n\u2502   \u2502    \"jsonrpc\": \"2.0\",                                                \u2502   \u2502\n\u2502   \u2502    \"method\": \"tools/call\",                                          \u2502   \u2502\n\u2502   \u2502    \"params\": {                                                      \u2502   \u2502\n\u2502   \u2502      \"name\": \"github/create_issue\",                                 \u2502   \u2502\n\u2502   \u2502      \"arguments\": {                                                 \u2502   \u2502\n\u2502   \u2502        \"repo\": \"company/project\",                                   \u2502   \u2502\n\u2502   \u2502        \"title\": \"Bug: Login fails\",                                 \u2502   \u2502\n\u2502   \u2502        \"body\": \"Steps to reproduce...\"                              \u2502   \u2502\n\u2502   \u2502      }                                                              \u2502   \u2502\n\u2502   \u2502    },                                                               \u2502   \u2502\n\u2502   \u2502    \"id\": \"req-123\"                                                  \u2502   \u2502\n\u2502   \u2502  }                                                                   \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                     \u2502                                        \u2502\n\u2502                                     \u25bc                                        \u2502\n\u2502   2. TRANSPORT LAYER (SSE)                                                   \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502  - Accept HTTP connection                                           \u2502   \u2502\n\u2502   \u2502  - Parse JSON-RPC request                                           \u2502   \u2502\n\u2502   \u2502  - Create context with request ID                                   \u2502   \u2502\n\u2502   \u2502  - Pass to handler chain                                            \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                     \u2502                                        \u2502\n\u2502                                     \u25bc                                        \u2502\n\u2502   3. MIDDLEWARE CHAIN                                                        \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502   \u2502\n\u2502   \u2502  \u2502 LOGGING                                                       \u2502   \u2502   \u2502\n\u2502   \u2502  \u2502 - Log: \"Incoming request req-123 for github/create_issue\"    \u2502   \u2502   \u2502\n\u2502   \u2502  \u2502 - Start timer                                                 \u2502   \u2502   \u2502\n\u2502   \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502   \u2502\n\u2502   \u2502                              \u2502                                        \u2502   \u2502\n\u2502   \u2502                              \u25bc                                        \u2502   \u2502\n\u2502   \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502   \u2502\n\u2502   \u2502  \u2502 AUTH                                                          \u2502   \u2502   \u2502\n\u2502   \u2502  \u2502 - Validate JWT token                                          \u2502   \u2502   \u2502\n\u2502   \u2502  \u2502 - Extract user: \"alice@company.com\"                          \u2502   \u2502   \u2502\n\u2502   \u2502  \u2502 - Inject user into context                                    \u2502   \u2502   \u2502\n\u2502   \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502   \u2502\n\u2502   \u2502                              \u2502                                        \u2502   \u2502\n\u2502   \u2502                              \u25bc                                        \u2502   \u2502\n\u2502   \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502   \u2502\n\u2502   \u2502  \u2502 RATE LIMIT                                                    \u2502   \u2502   \u2502\n\u2502   \u2502  \u2502 - Check: alice@company.com has 45/60 requests remaining      \u2502   \u2502   \u2502\n\u2502   \u2502  \u2502 - Consume 1 token                                             \u2502   \u2502   \u2502\n\u2502   \u2502  \u2502 - Pass through                                                \u2502   \u2502   \u2502\n\u2502   \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502   \u2502\n\u2502   \u2502                              \u2502                                        \u2502   \u2502\n\u2502   \u2502                              \u25bc                                        \u2502   \u2502\n\u2502   \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502   \u2502\n\u2502   \u2502  \u2502 AUDIT                                                         \u2502   \u2502   \u2502\n\u2502   \u2502  \u2502 - Log to audit trail:                                        \u2502   \u2502   \u2502\n\u2502   \u2502  \u2502   { user: \"alice\", tool: \"github/create_issue\", time: ... }  \u2502   \u2502   \u2502\n\u2502   \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                     \u2502                                        \u2502\n\u2502                                     \u25bc                                        \u2502\n\u2502   4. TOOL ROUTER                                                             \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502  - Parse tool ID: \"github/create_issue\"                             \u2502   \u2502\n\u2502   \u2502  - Extract backend: \"github\"                                         \u2502   \u2502\n\u2502   \u2502  - Extract tool name: \"create_issue\"                                \u2502   \u2502\n\u2502   \u2502  - Lookup backend in registry                                        \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                     \u2502                                        \u2502\n\u2502                                     \u25bc                                        \u2502\n\u2502   5. BACKEND (GitHub MCP)                                                    \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502  - Backend type: MCP subprocess                                      \u2502   \u2502\n\u2502   \u2502  - Command: npx @modelcontextprotocol/server-github                 \u2502   \u2502\n\u2502   \u2502  - Forward MCP call to subprocess                                    \u2502   \u2502\n\u2502   \u2502  - Wait for response                                                 \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                     \u2502                                        \u2502\n\u2502                                     \u25bc                                        \u2502\n\u2502   6. EXTERNAL SERVICE (GitHub API)                                           \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502  - GitHub MCP server calls GitHub API                               \u2502   \u2502\n\u2502   \u2502  - POST https://api.github.com/repos/company/project/issues        \u2502   \u2502\n\u2502   \u2502  - Response: { \"number\": 456, \"url\": \"...\" }                        \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                     \u2502                                        \u2502\n\u2502                                     \u25bc                                        \u2502\n\u2502   7. RESPONSE FLOW (reverse through middleware)                              \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502  - Audit: Log success                                                \u2502   \u2502\n\u2502   \u2502  - Rate limit: (no action)                                          \u2502   \u2502\n\u2502   \u2502  - Auth: (no action)                                                \u2502   \u2502\n\u2502   \u2502  - Logging: Log \"Completed req-123 in 1.2s, status: success\"        \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                     \u2502                                        \u2502\n\u2502                                     \u25bc                                        \u2502\n\u2502   8. CLIENT RESPONSE                                                         \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502   \u2502  HTTP/1.1 200 OK                                                     \u2502   \u2502\n\u2502   \u2502  Content-Type: text/event-stream                                    \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502  event: message                                                      \u2502   \u2502\n\u2502   \u2502  data: {                                                             \u2502   \u2502\n\u2502   \u2502    \"jsonrpc\": \"2.0\",                                                \u2502   \u2502\n\u2502   \u2502    \"result\": {                                                      \u2502   \u2502\n\u2502   \u2502      \"content\": [{                                                  \u2502   \u2502\n\u2502   \u2502        \"type\": \"text\",                                              \u2502   \u2502\n\u2502   \u2502        \"text\": \"Created issue #456\"                                 \u2502   \u2502\n\u2502   \u2502      }],                                                            \u2502   \u2502\n\u2502   \u2502      \"metadata\": {                                                  \u2502   \u2502\n\u2502   \u2502        \"issue_number\": 456,                                         \u2502   \u2502\n\u2502   \u2502        \"url\": \"https://github.com/company/project/issues/456\"      \u2502   \u2502\n\u2502   \u2502      }                                                              \u2502   \u2502\n\u2502   \u2502    },                                                               \u2502   \u2502\n\u2502   \u2502    \"id\": \"req-123\"                                                  \u2502   \u2502\n\u2502   \u2502  }                                                                   \u2502   \u2502\n\u2502   \u2502                                                                       \u2502   \u2502\n\u2502   \u2502  event: done                                                         \u2502   \u2502\n\u2502   \u2502  data: {}                                                            \u2502   \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#comparative-analysis","title":"Comparative Analysis","text":""},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#your-tool-libraries-vs-industry-patterns","title":"Your Tool Libraries vs. Industry Patterns","text":"Your Pattern Industry Standard Alignment toolindex.Searcher interface Register-on-init pattern Excellent Build-tag gating HashiCorp conditional compilation Same approach Adapter layer Clean Architecture boundaries Textbook Progressive disclosure Apple API design principles Ahead of most"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#comparison-with-other-go-mcp-servers","title":"Comparison with Other Go MCP Servers","text":"Project Transport Plugin System Your Advantage Official go-sdk stdio, SSE None Your tool* libraries mark3labs/mcp-go stdio, SSE Basic Your progressive disclosure viant/mcp stdio None Your modular architecture metatools-mcp stdio (SSE planned) Build-tag + interfaces Full stack orchestration <p>Unique value: No other Go MCP server has layered tool libraries with progressive disclosure, BM25 search, and code execution.</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#references","title":"References","text":""},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#go-plugin-patterns","title":"Go Plugin Patterns","text":"<ul> <li>HashiCorp go-plugin - RPC-based plugin system</li> <li>Register-on-Init Pattern</li> <li>Interface Extension Pattern</li> <li>Clean Architecture with Plugins</li> </ul>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#mcp-implementations","title":"MCP Implementations","text":"<ul> <li>Official MCP Go SDK</li> <li>mark3labs/mcp-go</li> <li>viant/mcp</li> </ul>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#configuration-libraries","title":"Configuration Libraries","text":"<ul> <li>Koanf - Lighter Viper alternative</li> <li>Cobra - CLI framework</li> <li>Dependency Injection Patterns</li> </ul>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#api-design","title":"API Design","text":"<ul> <li>Progressive Disclosure</li> <li>Apple WWDC22: API Design</li> </ul>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#architecture-validation","title":"Architecture Validation","text":"<p>This section documents validation of the proposed architecture against industry best practices and real-world implementations, gathered from multiple research sources (Exa, Firecrawl, GitHub, Context7).</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#plugin-architecture-validation","title":"Plugin Architecture Validation \u2713","text":"<p>Sources: cekrem.github.io, blog.devcoffee.me, skoredin.pro, caffeinatedcoder.medium.com, reintech.io</p> <p>Our proposed architecture aligns with established Go plugin patterns:</p> Pattern Our Implementation Industry Validation Dependency Inversion ToolProvider interface abstracts concrete implementations \"High-level modules depend only on abstractions (interfaces)\" - Clean Architecture Interface-Driven Design <code>handlers/interfaces.go</code> defines stable contracts \"Define stable, simple core interfaces\" - Go best practices Plugin Registry ToolProviderRegistry with Register/Get methods \"Central hub for registering plugins with unique names\" - Plugin Registry pattern Plugin Factories Factory functions for backend creation \"A function that returns a new instance of a plugin\" - Factory pattern Graceful Shutdown Context-based cancellation propagation \"Critical feature for supporting context cancellation\" - Production patterns <p>RPC-Based Plugin Pattern (HashiCorp): Our Backend interface supports both in-process and RPC-based plugins, aligning with the industry-recommended approach for fault tolerance.</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#middleware-chain-validation","title":"Middleware Chain Validation \u2713","text":"<p>Sources: go-chi/chi (21.7k\u2b50), grpc-ecosystem/go-grpc-middleware (6.7k\u2b50)</p> <p>The chi router's <code>chain.go</code> demonstrates the exact pattern we're proposing:</p> <pre><code>// From go-chi/chi - validates our decorator pattern\nfunc chain(middlewares []func(http.Handler) http.Handler, endpoint http.Handler) http.Handler {\n    if len(middlewares) == 0 {\n        return endpoint\n    }\n    h := middlewares[len(middlewares)-1](endpoint)\n    for i := len(middlewares) - 2; i &gt;= 0; i-- {\n        h = middlewares[i](h)\n    }\n    return h\n}\n</code></pre> <p>grpc-ecosystem interceptor categories match our proposed middleware types: - <code>auth/</code> \u2192 Our Auth middleware - <code>logging/</code> \u2192 Our Logging middleware - <code>ratelimit/</code> \u2192 Our RateLimit middleware - <code>recovery/</code> \u2192 Our Recovery/error handling - <code>retry/</code> \u2192 Our Circuit breaker patterns - <code>timeout/</code> \u2192 Our Timeout middleware</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#transport-layer-validation","title":"Transport Layer Validation \u2713","text":"<p>Sources: FreeCodeCamp, go-zero.dev, goa.design, Centrifugo</p> <p>SSE Implementation Requirements (validated): <pre><code>// Required headers for SSE - confirmed across all sources\nw.Header().Set(\"Content-Type\", \"text/event-stream\")\nw.Header().Set(\"Cache-Control\", \"no-cache\")\nw.Header().Set(\"Connection\", \"keep-alive\")\n</code></pre></p> <p>Multi-Transport Architecture Patterns: | Transport | Use Case | Our Support | |-----------|----------|-------------| | HTTP/REST | Request-response APIs | \u2713 Proposed | | SSE | Server-to-client streaming | \u2713 Proposed | | WebSocket | Bidirectional real-time | \u2713 Proposed | | gRPC | High-performance RPC | \u2713 Proposed | | stdio | Local MCP clients | \u2713 Current |</p> <p>Centrifugo WebSocket Scaling Patterns: Validates our approach of using shared state (Redis) for HA deployments with multiple transport instances.</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#mcp-server-ecosystem-validation","title":"MCP Server Ecosystem Validation \u2713","text":"<p>Sources: viant/mcp, mcp-golang, go-mcp (Reddit), bytesizego.com, dev.to</p> <p>Active Go MCP implementations confirm the viability of our approach:</p> Project Stars Approach Notes viant/mcp Active Interface-based Validates our pattern mcp-golang Active Framework approach Similar extensibility goals mark3labs/mcp-go Popular Simple MCP Basic implementation <p>Key insight: No existing Go MCP server offers the combination of: - Multi-transport support (stdio + HTTP/SSE) - Pluggable tool providers - Configurable search strategies - Multi-backend aggregation - Middleware chain</p> <p>This confirms metatools-mcp's unique positioning in the ecosystem.</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#configuration-library-validation","title":"Configuration Library Validation \u2713","text":"<p>Sources: Context7 library research, GitHub documentation</p> Library Reputation Code Snippets Recommendation Koanf High 23 \u2713 \"Cleaner, lighter alternative to Viper\" Cobra High 1,126+ \u2713 \"Powerful CLI with subcommands\" <p>This validates our choice of Koanf + Cobra over Viper for configuration management.</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#validation-summary","title":"Validation Summary","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  ARCHITECTURE VALIDATION MATRIX                  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Component              \u2502 Pattern Validated  \u2502 Source Quality    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Plugin Registry        \u2502 \u2713 Industry standard\u2502 High (multiple)   \u2502\n\u2502 Middleware Chain       \u2502 \u2713 go-chi pattern   \u2502 High (21.7k\u2b50)    \u2502\n\u2502 Transport Abstraction  \u2502 \u2713 Multi-impl refs  \u2502 High (docs + OSS) \u2502\n\u2502 SSE Implementation     \u2502 \u2713 Standard headers \u2502 High (RFC 6455)   \u2502\n\u2502 Backend Interface      \u2502 \u2713 DIP/Clean Arch   \u2502 High (canonical)  \u2502\n\u2502 Config Framework       \u2502 \u2713 Koanf + Cobra    \u2502 High (Context7)   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Conclusion: The proposed architecture follows established best practices and patterns validated across multiple high-quality sources. The design is sustainable, maintainable, and aligned with the Go ecosystem's conventions.</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#implementation-phases","title":"Implementation Phases","text":"<p>A detailed phased implementation plan has been created to break this proposal into manageable chunks. See implementation-phases.md for:</p> <ul> <li>Phase 1: CLI Framework &amp; Configuration (~2 weeks) - Cobra + Koanf foundation</li> <li>Phase 2: Transport Layer Abstraction (~2 weeks) - Stdio + SSE transports</li> <li>Phase 3: Tool Provider Registry (~1 week) - Plug-and-play tool registration</li> <li>Phase 4: Backend Registry (~2 weeks) - Multi-source tool aggregation</li> <li>Phase 5: Middleware Chain (~2 weeks) - Cross-cutting concerns</li> </ul> <p>MVP (Phases 1-3): ~5 weeks Full Implementation: ~9 weeks</p> <p>Each phase includes: - Detailed directory structure changes - Interface definitions with Go code - Implementation tasks with code examples - Verification criteria checklist - Migration notes for backward compatibility</p>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#open-questions","title":"Open Questions","text":"<ol> <li>ToolProvider interface - Does the proposed interface feel right for plug-and-play tools?</li> <li>Middleware chain - Useful now, or defer until needed?</li> <li>Backend configuration - YAML-driven or code-only for now?</li> <li>Semantic search - Priority for vector/embedding-based search strategy?</li> </ol>"},{"location":"library-docs-from-repos/metatools-mcp/proposals/pluggable-architecture/#changelog","title":"Changelog","text":"Date Change 2026-01-27 Initial draft 2026-01-27 Added Multi-Backend Architecture section with diagrams 2026-01-27 Expanded Middleware Chain section with pluggable design 2026-01-27 Added comprehensive Transport Layer section with all protocols 2026-01-27 Added End-to-End Examples section with 5 real-world scenarios 2026-01-27 Added Architecture Validation section with industry pattern verification 2026-01-27 Created detailed Implementation Phases document (see implementation-phases.md)"}]}